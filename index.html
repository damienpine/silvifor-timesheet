
<html>

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

<style>

.the-datepicker{
   z-index: 9999;
}
.the-datepicker__container .the-datepicker__main {
  border-top-left-radius: 0;
}
.the-datepicker__container.the-datepicker__container--over .the-datepicker__main {
  border-top-left-radius: 0.3em;
  border-bottom-left-radius: 0;
}
.the-datepicker__container.the-datepicker__container--left .the-datepicker__main {
  border-top-left-radius: 0.3em;
  border-top-right-radius: 0;
}
.the-datepicker__container.the-datepicker__container--over.the-datepicker__container--left .the-datepicker__main {
  border-bottom-left-radius: 0.3em;
  border-top-right-radius: 0.3em;
  border-bottom-right-radius: 0;
}
.the-datepicker__main {
  background-color: #fff;
  border: 1px solid #ccc;
  border-radius: 0.3em;
  padding: 0.4em;
  font-family: Arial, Helvetica, sans-serif;
  line-height: 1em;
  box-sizing: border-box;
  overflow: hidden;
  
}
.the-datepicker__main .the-datepicker__body {
  margin-top: 1em;
}
.the-datepicker__main th.the-datepicker__week-day {
  width: 2.1em;
  min-width: 2.1em;
  max-width: 2.1em;
  padding: 0.5em 0;
  text-align: center;
  font-weight: normal;
  text-transform: uppercase;
  color: #666;
  font-size: 0.85em;
}
.the-datepicker__main a.the-datepicker__button {
  display: block;
  width: 2.1em;
  min-width: 2.1em;
  max-width: 2.1em;
  padding: 0.6em 0;
  text-decoration: none;
  text-align: center;
  color: #007eff;
  border-radius: 0.3em;
}
.the-datepicker__main a.the-datepicker__button:hover {
  background-color: #d1e8ff;
  text-decoration: none;
}
.the-datepicker__main .the-datepicker__title {
  display: inline-block;
  width: 70%;
}
.the-datepicker__main .the-datepicker__title-content {
  display: inline-block;
  padding: 0.5em;
}
.the-datepicker__main .the-datepicker__control {
  display: inline-block;
  width: 30%;
  text-align: right;
}
.the-datepicker__main .the-datepicker__reset,
.the-datepicker__main .the-datepicker__close {
  display: inline-block;
  font-weight: bold;
}
.the-datepicker__main .the-datepicker__navigation {
  margin-top: 0.3em;
}
.the-datepicker__main .the-datepicker__go {
  display: inline-block;
  width: 15%;
}
.the-datepicker__main .the-datepicker__go a.the-datepicker__button {
  display: inline-block;
  font-weight: bold;
}
.the-datepicker__main .the-datepicker__go-next {
  text-align: right;
}
.the-datepicker__main .the-datepicker__state {
  display: inline-block;
  width: 70%;
}
.the-datepicker__main .the-datepicker__month {
  display: inline-block;
  width: 62%;
  text-align: center;
}
.the-datepicker__main .the-datepicker__year {
  display: inline-block;
  width: 38%;
  text-align: center;
}
.the-datepicker__main .the-datepicker__month-year {
  text-align: center;
}
.the-datepicker__main select.the-datepicker__select {
  font-size: 0.9em;
  margin: 0;
  padding: 0;
}
.the-datepicker__main table.the-datepicker__calendar {
  display: table;
  border-collapse: collapse;
}
.the-datepicker__main table.the-datepicker__calendar thead {
  display: table-header-group;
}
.the-datepicker__main table.the-datepicker__calendar tbody {
  display: table-row-group;
}
.the-datepicker__main table.the-datepicker__calendar tr {
  display: table-row;
}
.the-datepicker__main table.the-datepicker__calendar tr td,
.the-datepicker__main table.the-datepicker__calendar tr th {
  display: table-cell;
}
.the-datepicker__main td.the-datepicker__cell {
  padding: 0;
}
.the-datepicker__main td.the-datepicker__cell a.the-datepicker__button {
  padding: 0.1em;
}
.the-datepicker__main td.the-datepicker__cell a.the-datepicker__button .the-datepicker__day-content {
  display: block;
  padding: 0.6em 0;
}
.the-datepicker__main td.the-datepicker__day a.the-datepicker__button .the-datepicker__day-content {
  text-align: center;
  border-radius: 0.3em;
}
.the-datepicker__main td.the-datepicker__day a.the-datepicker__button:hover {
  background-color: transparent;
}
.the-datepicker__main td.the-datepicker__day a.the-datepicker__button:hover .the-datepicker__day-content {
  background-color: #d1e8ff;
}
.the-datepicker__main td.the-datepicker__day--highlighted a.the-datepicker__button .the-datepicker__day-content {
  background-color: #d1e8ff;
}
.the-datepicker__main td.the-datepicker__day--outside a.the-datepicker__button {
  color: #8ac4ff;
}
.the-datepicker__main td.the-datepicker__day--unavailable a.the-datepicker__button {
  color: #aaa;
}
.the-datepicker__main td.the-datepicker__day--unavailable a.the-datepicker__button:hover .the-datepicker__day-content {
  background-color: transparent;
}
.the-datepicker__main td.the-datepicker__day--selected a.the-datepicker__button,
.the-datepicker__main td.the-datepicker__day--selected.the-datepicker__day--highlighted a.the-datepicker__button {
  color: #fff;
}
.the-datepicker__main td.the-datepicker__day--selected a.the-datepicker__button .the-datepicker__day-content,
.the-datepicker__main td.the-datepicker__day--selected.the-datepicker__day--highlighted a.the-datepicker__button .the-datepicker__day-content {
  background-color: #007eff;
}
.the-datepicker__main td.the-datepicker__day--selected a.the-datepicker__button:hover .the-datepicker__day-content,
.the-datepicker__main td.the-datepicker__day--selected.the-datepicker__day--highlighted a.the-datepicker__button:hover .the-datepicker__day-content {
  background-color: #007eff;
}
.the-datepicker__main .the-datepicker__day--weekend,
.the-datepicker__main .the-datepicker__week-day--weekend,
.the-datepicker__main td.the-datepicker__day--today {
  font-weight: bold;
}
.the-datepicker__main .the-datepicker__animated {
  animation-duration: 0.1s;
  animation-fill-mode: both;
}
.the-datepicker__deselect-button {
  text-decoration: none;
  color: #007eff;
  font-weight: bold;
}
.the-datepicker__deselect-button:hover {
  text-decoration: none;
}
.the-datepicker__fade-out-left {
  animation-name: the-datepicker-fade-out-left;
}
.the-datepicker__fade-out-right {
  animation-name: the-datepicker-fade-out-right;
}
.the-datepicker__fade-in-left {
  animation-name: the-datepicker-fade-in-left;
}
.the-datepicker__fade-in-right {
  animation-name: the-datepicker-fade-in-right;
}
@-moz-keyframes the-datepicker-fade-out-left {
  from {
    transform: translate3d(0, 0, 0);
  }
  to {
    transform: translate3d(-100%, 0, 0);
  }
}
@-webkit-keyframes the-datepicker-fade-out-left {
  from {
    transform: translate3d(0, 0, 0);
  }
  to {
    transform: translate3d(-100%, 0, 0);
  }
}
@-o-keyframes the-datepicker-fade-out-left {
  from {
    transform: translate3d(0, 0, 0);
  }
  to {
    transform: translate3d(-100%, 0, 0);
  }
}
@keyframes the-datepicker-fade-out-left {
  from {
    transform: translate3d(0, 0, 0);
  }
  to {
    transform: translate3d(-100%, 0, 0);
  }
}
@-moz-keyframes the-datepicker-fade-out-right {
  from {
    transform: translate3d(0, 0, 0);
  }
  to {
    transform: translate3d(100%, 0, 0);
  }
}
@-webkit-keyframes the-datepicker-fade-out-right {
  from {
    transform: translate3d(0, 0, 0);
  }
  to {
    transform: translate3d(100%, 0, 0);
  }
}
@-o-keyframes the-datepicker-fade-out-right {
  from {
    transform: translate3d(0, 0, 0);
  }
  to {
    transform: translate3d(100%, 0, 0);
  }
}
@keyframes the-datepicker-fade-out-right {
  from {
    transform: translate3d(0, 0, 0);
  }
  to {
    transform: translate3d(100%, 0, 0);
  }
}
@-moz-keyframes the-datepicker-fade-in-left {
  from {
    transform: translate3d(-100%, 0, 0);
  }
  to {
    transform: translate3d(0, 0, 0);
  }
}
@-webkit-keyframes the-datepicker-fade-in-left {
  from {
    transform: translate3d(-100%, 0, 0);
  }
  to {
    transform: translate3d(0, 0, 0);
  }
}
@-o-keyframes the-datepicker-fade-in-left {
  from {
    transform: translate3d(-100%, 0, 0);
  }
  to {
    transform: translate3d(0, 0, 0);
  }
}
@keyframes the-datepicker-fade-in-left {
  from {
    transform: translate3d(-100%, 0, 0);
  }
  to {
    transform: translate3d(0, 0, 0);
  }
}
@-moz-keyframes the-datepicker-fade-in-right {
  from {
    transform: translate3d(100%, 0, 0);
  }
  to {
    transform: translate3d(0, 0, 0);
  }
}
@-webkit-keyframes the-datepicker-fade-in-right {
  from {
    transform: translate3d(100%, 0, 0);
  }
  to {
    transform: translate3d(0, 0, 0);
  }
}
@-o-keyframes the-datepicker-fade-in-right {
  from {
    transform: translate3d(100%, 0, 0);
  }
  to {
    transform: translate3d(0, 0, 0);
  }
}
@keyframes the-datepicker-fade-in-right {
  from {
    transform: translate3d(100%, 0, 0);
  }
  to {
    transform: translate3d(0, 0, 0);
  }
}



body{
  background-image: url('IMG_1546.jpg');
  background-position:  100%
  background-repeat: no-repeat;

  background-color: Gainsboro; /*rgb(225, 225, 225);*/
  
  
}

* {
  box-sizing: border-box;
}
/*#empTable
thead,
tbody {
  display: block;
}*/

thead {
  text-align: left;
  background-color: rgb(100,150,100);
  opacity: 1;
  box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2), 0 6px 20px 0 rgba(0,0,0,0.19);)
}

#empTable tbody {
  background: rgb(220, 220, 220);
  overflow-y: scroll;
  height: 300px;
}

#empTable thead th,
#empTable tbody td {
  width: 100px;
  minimum-width: 100px;
  maximum-width: 100px;
  padding:2px;

}


#empTable thead tr th:first-child,
tbody tr td:first-child {
 
  width: 200px;
  minimum-width: 200px;
  maximum-width: 200px;
 
  font-weight: normal;
}


#myInput {
  
  background-position: 10px 10px;
  background-repeat: no-repeat;
  width: 100%;
  font-size: 16px;
  padding: 12px 20px 12px 40px;
  border: 1px solid #ddd;
  margin-bottom: 12px;
}

#empTable {
  border-collapse: collapse;
  width: 100%;
  border: 1px solid #ddd;
  font-size: 12px;
  box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2), 0 6px 20px 0 rgba(0,0,0,0.19);)
}

#empTable th, #empTable td {
  
  text-align: left;
  padding: 2px;
 
}

#empTable th, {
  text-align: left;
  padding: 2px;
  background-color: rgb(150,200,120);
}


#empTable tr.header, #empTable tr:hover {
  /*background-color: #f0f0f0;*/
}

#empTable th:first-child,
tr td:first-child {
  width: 200px;
  
  word-break: break-all;
}

th.sticky {
  position: -webkit-sticky; /* Safari */
  position: sticky;
  top: 0;
  left: 0;
  z-index: 8;
  background-color: rgb(100,150,100);
  border: 1px solid black;
}

th.sticky2{
  position: -webkit-sticky; /* Safari */
  position: sticky;
  top: 0;
  z-index: 7;
  background-color: rgb(100,150,100);
  border: 1px solid black;
}


td.sticky {
  position: -webkit-sticky; /* Safari */
  position: sticky;
  left: 0;
  /*background-color: rgb(100,150,100);*/
  border: 1px solid black;
}

td.sticky1 {
  position: -webkit-sticky; /* Safari */
  position: sticky;
  left: 1;
  /*background-color: rgb(100,150,100);*/
  border: 1px solid black;
}


/* Zebra stripe */
      #BlockTable tbody tr:nth-child(odd) {
        background: lightblue;
        /*opacity: 0.8;*/
 
      }

      /* Zebra stripe */
      #BlockTable tr:nth-child(even) {
        background: rgb(150,200,120);
        /*opacity: .8;*/
      }

#BlockTable th{
  opacity: 1;
  width: 100%
}

      #blockcont{
        height: 210px;
        width: auto;
        overflow-y: auto;
        overflow-x: auto;
        white-space: nowrap;
        /*background-image: linear-gradient(rgba(0,0,0,0.2), white, rgba(0,0,0,0.2));*/
        box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2), 0 6px 20px 0 rgba(0,0,0,0.19);)
       
      }


input, textarea{
height: 40px;
width: 5%
word-wrap: auto;
padding: 2px 2px;
margin: 2px 2px;
box-sizing: border-box;
}

textarea {

display: block;

}

#DeleteSel {
    width: 75px;  height: 20px; border-radius: 12px;
}

input[type="checkbox"]{
height: 30px;
width: 30px;
float: center;


}

input, label{
display:block;

}


#RK {display:block}

input{
box-shadow: inset 10 10 10px grey;
}

button {
  //background-color: #4CAF50; /* Green */
  border: 1px solid black;
  color: black;
  padding: 12px 2px;
  text-align: center;
  text-decoration: none;
  display: inline-block;
  border-radius: 12px;
  font-size: 12px;
  box-shadow: inset 0 0 10px grey;
}

.inputbutton {
  //background-color: #4CAF50; /* Green */
  border: 1px solid black;
  color: black;
  padding: 12px 2px;
  text-align: center;
  text-decoration: none;
  display: inline;
  border-radius: 12px;
  font-size: 12px;
  box-shadow: inset 0 0 10px grey;
}

input[type="radio"]{
height: 40px;
width: 40px;
}

fieldset{
width:100%;
box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2), 0 4px 8px 0 rgba(0,0,0,0.19);)
}

select {
size: 3;
height: 40px;
width: fit-content();
padding: 2px;
margin: 2px 0;
box-sizing: border-box;
}

#Date{
size: 3;
height: 40px;
width: fit-content();
text-align: left;
padding: 2px 2px;
margin: 2px 2px;
box-sizing: border-box;
background-color: white;
border: 1px solid black;
}

input[type="date"] { 
     vertical-align: middle;
}

#cont{
height: 400px;
width: auto;
overflow-y: auto;
overflow-x: auto;
white-space: nowrap;
padding: 5px 5px;
margin: 2px 2px;
box-sizing: border-box;
box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2), 0 6px 20px 0 rgba(0,0,0,0.19);)
}

.label{
height: auto;
width: auto;
//overflow: auto;
overflow-x: auto;
white-space: nowrap;
padding: 5px 5px;
margin: 5px 5 px;
box-sizing: border-box;

}

input:read-only{
  background-color: rgb(220,220,220);
}

#Start, #End{
  background-color: white;
  border: 1px solid black;
}

#lblCheck2{
display: inline;
font-size: 0.7em;
}

<!--
table{
height: fit-contents;
width: 100%
overflow: auto;
overflow-x: auto;
white-space: nowrap;
padding: 2px;
margin: 2px 0;
box-sizing: border-box;
}

-->

.newspaper {
  width: 5%;
  column-rule-style: solid;
  column-rule-color: black;
  column-rule-width: 1px;
  column-count: 23;
}

.full {
  height: 40px;
  width: 100px;
  word-wrap: auto;
  padding: 2px;
  margin: 2px 0;
  box-sizing: border-box;
}


table, th, td {
  width: 60px;
  /*minimum-width: 60px;*/
  /*maximum-width: 60px;*/
  border: 1px solid black;
  border-collapse: collapse;
}



</style>


<head>

<title>Silvifor Timesheet 2021</title>
<!--
<script src="localforage/dist/localforage.js"></script>
<script>localforage.getItem('something', myCallback);</script>
-->
<script type="text/javascript" src="https://www.dropbox.com/static/api/2/dropins.js" id="dropboxjs" data-app-key="xr5ciml86zk7q9p"></script>
<!--
<script src="dist/the-datepicker.min.js"></script>
-->
<!--
<link rel="stylesheet" href="dist/the-datepicker.css">
-->
<!--
<script type="text/javascript" src="index.js"></script>
-->
<!--
<link rel="stylesheet" href="style.css">
-->
<!--
<script type="text/javascript" src="papaparse.min.js"></script>

<script type="text/javascript" src="localforage.min.js"></script>

<script src="tasks.js"></script>

<script src="employees.js"></script>

<script src="clients.js"></script>

<script src= "leads.js"></script>

<script src="requestkeys.js"></script>

-->
<script type="text/javascript" src="scripts.js"></script>






<script>


</script>

<script type="text/javascript">
    
</script>


</head>

<h2>Silvifor Timesheet 2021</h2>
<!--
<a href="#" id="open" >Open in safari</a>
-->
<fieldset >
<legend>Browse for Files</legend>

<div style="float:left">
<label for="checkHide">Click to show/hide</label>
<input type='checkbox' id= 'checkHide' onclick='hideThis()'></input>
</div>

<div id='divFiles' style= 'float:left'>
<div class="label" style="float:left">
<label for="SelectLead">Select Leads</label>
<input type='file' accept='text/plain' id= 'SelectLead' onchange='openLeadFile(event)'></input>
</div>

<div class="label" style="float:left">
<label for="SelectClient">Select Clients</label>
<input type='file' accept='text/plain' id= 'SelectClient' onchange='openClientFile(event)'></input>
</div>

<div class="label" style="float:left">
<label for="SelectBlock">Select Blocks</label>
<input type='file' accept='text/plain' id= 'SelectBlock' onchange='openFile(event)'></input>
</div>

<div class="label" style="float:left">
<label for="SelectTask">Select Tasks</label>
<input type='file' accept='text/plain' id= 'SelectTask' onchange='openTaskFile(event)'></input>
<!-- from original with image display
<br>
<img id='output'>
-->
</div>

<div class="label" style="float:left">
<label for="SelectName">Select Names</label>
<input type='file' accept='text/plain' id= 'SelectName' onchange='openNameFile(event)'></input>
</div>

<div class="label" style="float:left">
<label for="SelectRK">Select RKs</label>
<input type='file' accept='text/plain' id= 'SelectRK' onchange='openRKFile(event)'></input>
</div>
</div>


</fieldset>


<!--
<body>
-->



<!--
<p>Fill in form fields</p>
-->
<!--
<form method="post" action="mailto:youremail@youremail.com" >
-->
<fieldset>
<legend>Enter Crew Lead and Pay Period</legend>

<div class="label" style="float:left;">
<label for="Lead">Crew Lead</label>
<select type="text" id="Lead" value= " " size="12" onchange = "addtocrew()">

</select>

</div>

<div class="label" style="float:left;" onclick= "getenddate()">
<label for="Start">Pay Period Start</label>
<input type="text" id="Start" readonly= true onclick= "getenddate()"></input>
</div>


<div class="label" style="float:left;" onclick= "getstartdate()">

<label for="End">Pay Period End</label>
<input type="text" id="End" readonly= true onclick= "getstartdate()">
</input>
</div>

<div class="label" style="float:left;">
<label for="SaveLead" style= "visibility:hidden" >Save Lead</label>
<button id= "SaveLead" style= "background-color: rgb(200,255,200)" onclick="savelead()">Save Lead
</button>
</div>


<div class="label" style="float:left;">
<label for="ClearLead" style= "visibility:hidden" >Clear Lead</label>
<button id= "ClearLead" style= "background-color: rgb(255,200,200)" onclick="clearlead()")>Clear Lead
</button>
</div>

 <br style="clear:both;">

</fieldset>


<fieldset id="Daily">


<legend>Enter Daily Data</legend>

<div class="label" style="float:left;">
<label for="Date">Date</label>
<input type="text" id="Date" readonly= true ></input>
</div>


<div class="label" style="float:left;">
<label for="Trucks"># of Trucks</label>
<input type="number" id="Trucks" size="6"/>
</div>

<div class="label"style="float:left;">
<label for="KmS">Start Km</label>
<input type="number" id="KmS" onblur= "calculateKm()" />
</div>

<div class="label" style="float:left;">
<label for="KmE">End Km</label>
<input type="number" id="KmE" size="12" onblur= "calculateKm()" />
</div>

<div class="label" style="float:left;">
<label for="KmD">Daily Km</label>
<input type="number" id="KmD" size="6"/>
</div>


<br style="clear:both;">

<div class="label" style="float:left;">
<label for= "Csearch">Search/Add Client</label>
<input type="text" id="Csearch" name="Csearch" style="margin: 1px; width: 165px;" onchange="addClients()" placeholder="filter client list.." >
</div>

<div class="label" style="float:left;">
<label for="Client">Client</label>
<select type="text" id="Client" value= " ">
</select>
</div>






<br style="clear:both;">

<div id="blockcont" style="float:left;">


<table id="BlockTable">
</table>

</div>

<br style="clear:both;">

<div class="label" style="float:left;">
<label for= "Tsearch">Search/Add Task</label>
<input type="text" id="Tsearch" name="Tsearch" style="margin: 1px; width: 165px;" onchange="addtasks()" placeholder="filter task list.." >
</div>

<div class="label" style="float:left;">
<label for="Task">Task</label>
<select type="text" id="Task" value= " "  onchange="proArray()" >
</select>

</div>

<div class="label" style="float:left;">
<div class="label" style="float:left;">
<div class="label" style="float:left;">
<label for="Hourly">Hourly</label>
<input type="radio" id="Hourly" name="PayType" checked= "true" value= "Hourly" onclick="proArray()"/>
</div>

<div class="label" style="float:left;">
<label for="PieceRate">Piece Rate</label>
<input type="radio" id="PieceRate" name="PayType" onclick="proArray()" value= "PieceRate"/>
</div>
</div>

<div class="label" style="float:left;">
<div class="label" style="float:left;">
<label for="Coop">Co-op</label>
<input type="radio" id="Coop" name="PayType1" checked= "true" value= "Coop"/>
</div>

<div class="label" style="float:left;">
<label for="Individual">Individual</label>
<input type="radio" id="Individual" name="PayType1" value= "Individual"/>
</div>
</div>
</div>



<br style="clear:both;">

<div class="label" style="float:left;">
<label for= "Nsearch">Search/Add Name</label>
<input type="text" id="Nsearch" name="Nsearch" style="margin: 1px; width: 165px;" onchange="addnames()" placeholder="filter name list.." >
</div>

<div class="label" style="float:left;">
<label for="Name">Name</label>

<select type="text" id="Name" value= " " onchange="proArray()" multiple>
</select>

</div>

<div class="label" style="float:left;">
<label for="Hours">Hours</label>
<input type="number" id="Hours" /> 
</div>

<div class="label" style="float:left;">
<label for="OT1">OT1</label>
<input type="number" id="OT1" value= "" />
</div>

<div class="label" style="float:left;">
<label for="OT2">OT2</label>
<input type="number" id="OT2" value= ""/>
</div>

<br style="clear:both;">

<span id="CrewList"></span>

<br style="clear:both;">

<div class="label">
<label for="Comments">Comments</label>
<input type="text" id="Comments" value= " " size="100%" />
</div>

<div class="label" style="float:left;">
<label for="SaveTask" style= "visibility:hidden" >Save Client/Task</label>
<button id= "SaveTask" style= "background-color: rgb(200,255,200)" onclick="savetask()">Save Client/Task
</button>
</div>

<script>

</script>
<!--
<div class="label" style="float:left;">
<label for="SaveCrew">Save Crew</label>
<button id= "SaveCrew" style= "background-color: lime" onclick="saveCrew()">Save Crew
</button>
</div>

<script>
function saveCrew(){

localStorage.removeItem("myCrew")

}
</script>
-->
<div class="label" style="float:left;">
<label for="ClearTask" style= "visibility:hidden" >Clear Client/Task</label>
<button id= "ClearTask" style= "background-color: rgb(255,200,200)" onclick="cleartask()")>Clear Client/Task
</button>
</div>

<div class="label" style="float:left;">
<label for="SaveCrew" style= "visibility:hidden" >Save Crew</label>
<button id= "SaveCrew" style= "background-color: rgb(200,255,200)" onclick="saveCrew()">Save Crew
</button>
</div>

<div class="label" style="float:left;">
<label for="ClearCrew" style= "visibility:hidden" >Clear Crew</label>
<button id= "ClearCrew" style= "background-color: rgb(255,200,200)" onclick="clearCrew()")>Clear Crew
</button>
</div>

<div class="label" style="float:left;">
<label for="SaveBlock" style= "visibility:hidden" >Save Block</label>
<button id= "SaveBlock" style= "background-color: rgb(200,255,200)" onclick="saveBlock()">Save Block
</button>
</div>

<div class="label" style="float:left;">
<label for="ClearBlock" style= "visibility:hidden" >Clear Block</label>
<button id= "ClearBlock" style= "background-color: rgb(255,200,200)" onclick="clearBlock()")>Clear Block
</button>
</div>
					
</fieldset>

<fieldset id="details">
<legend>Task Details</legend>

<div class="label">
Ha Piecework:</label>
</div>
<div id= "divProRate" ></div>
<!--
<div class="label" style="float:left;">

<label for="HaRate">$/Ha</label>
<input type="number" ""

<br0.01" id="HaRate" value= " " size="12" maxlength="36"/>
</div>
--> 
<br style="clear:both;">


<div class= "label">
Planting/Coning:
</div>

<div class="label" style="float:left;">
<label for= "RKsearch">Search/Add RKs</label>
<input type="text" id="RKsearch" name="RKsearch" style="margin: 1px; width: 165px;" onchange="addRKs()" placeholder="filter request keys.." >
</div>


<div class="label" style="float:left;">
<label for="RK">Request Key</label>
<select type="text" id="RK" value= " " onchange="setTimeout(makeArrays(),3000)" multiple>

</select>
</div>

<div class="label" style="float:left;">
<label for="Trees">Trees</label>
<input type="number" id="Trees" readonly="true" onclick="createBlockArray()" value= " " />
</div>
<div id= "divTrees" ></div>

<div class="label" style="float:left;">
<label for="Fert">Fert</label>
<input type="number" id="Fert" onclick="createBlockArray()" value= " " readonly="true" />
</div>
<div id= "divFert"></div>

<div class="label" style="float:left;">
<label for="Cones">Cones</label>
<input type="number" id="Cones" onclick="createBlockArray()" value= " " readonly="true" />
</div>
<div id= "divCones"></div>

<div class="label" style="float:left;">
<label for="$_Unit">$/Unit</label>
<input type="number" id="$_Unit" onclick="createBlockArray()" readonly="true" value= " " ></input>
 <!--step= "0.005"--> 
</div>
<div id= "div$_Unit"></div>


</fieldset>




<body> 
<!--onload="createTable()"-->
<p>

<div class="label" style="float:left;">
<button type="button" class="inputbutton" style= "background-color: rgb(200,255,200)" id="addRow" value= "Add Row" onclick="addRow()" onmouseout="settabledata()">Input Data to Table</button>
</div>


<div class="label" style="float:left;">
<button id= "CalcPro" style= "background-color: lightblue" onclick= "calculateprorate()">Calculate ProRate</button>
</div>

<div class="label" style="float:left;">
<button id= "CalcPlant"style= "background-color: lightblue" onclick= "calculateplanting()">Calculate Planting</button>
</div>

<div class="label" style="float:left;">
<button id= "SumTab" style= "background-color: lightblue" onclick= "sumtable()">Summarize Table</button>
</div>

<div class="label" style="float:left;">
<button id= "RemDup" style= "background-color: lightblue" onclick= "removeduplicates()">Remove Duplicates</button>
</div>

<div class="label" style="float:left;">
<button id= "Colour" style= "background-color: rgb(255,200,200)" onclick= "colourtable()">Colour Table</button>
</div>

<br style="clear:both;">

<div class="label" style="float:left;">
<input type="text" id="myInput1" onkeyup="multiFilter()" placeholder="Search for dates.." title="Type in a date" ></input>
</div>

<div class="label" style="float:left;">
<input type="text" id="myInput2" onkeyup="multiFilter()" placeholder="Search for clients.." title="Type in a client" ></input>
</div>

<div class="label" style="float:left;">
<input type="text" id="myInput3" onkeyup="multiFilter()" placeholder="Search for blocks.." title="Type in a block" ></input>
</div>

<div class="label" style="float:left;">
<input type="text" id="myInput4" onkeyup="multiFilter()" placeholder="Search for tasks.." title="Type in a task" ></input>
</div>

<div class="label" style="float:left;">
<input type="text" id="myInput5" onkeyup="multiFilter()" placeholder="Search for names.." title="Type in a name" ></input>
</div>
 

    </p>

<br style="clear:both;">

<div id="cont" ></div>   <!-- the container to add the table  -->

</body>





<fieldset id="submit">
<legend>Submit data</legend>
<!--
<div class="label" style="float:left;">
<button onclick= "gettabledata()" > Get Table Data</button>
</div>

<div class="label" style="float:left;">
<button id="SaveTable" style="background-color: rgb(200,255,200)" onclick="settabledata()">Save Table</button>
</div>
-->
<div class="label" style="float:left;">
<button id="SaveMainTable" style="background-color: rgb(200,255,200)" onclick="settabledata()">Save Table</button>
</div>

<div class="label" style="float:left;">
<button id="GetJSON" style="background-color: rgb(200,255,200)" onclick="gettabledata()">Get Saved Table</button>
</div>




<div class="label" style="float:left;">
<button id="ClearTable" style="background-color: rgb(255,200,200)" onclick="cleartabledata()">Clear Table</button>
</div>



<!--

</form>

-->

<div class="label" style="float:left;">
<button class="inputbutton">
<a onclick= "downloaddata()" href= '#' download= 'filename' target="_blank" id="link" >Download CSV File</a>
</button>
</div>

<div class="label" style="float:left;">
<a href= '#' style= "display:none" class="dropbox-saver">Save to Dropbox</a>
</div>
<br style="clear:both;">

<div class="label" style="float:left;">
<label for="disk_c">Local Storage usage :</label>
<meter id="disk_c" value= checkStorage() >2 out of 10</meter>
</div>

<script>
//Datepicker

var TheDatepicker;!function(t){var f=function(){};t.CannotParseDateException=f;var l=(i.prototype.createDate=function(){if(null===this.day||null===this.month||null===this.year)throw new f;var t=new Date(this.year,this.month-1,this.day);if(isNaN(t.getTime()))throw new f;for(;t.getDate()!==this.day||t.getMonth()!==this.month-1||t.getFullYear()!==this.year;){if(!(28<this.day))throw new f;this.day--,t=new Date(this.year,this.month-1,this.day)}return t},i);function i(){this.day=null,this.month=null,this.year=null}var n=(s.prototype.t=function(t,i){if(null===i)return null;for(var n=!1,s="",h=0;h<t.length;h++){var r,u=t.substring(h,h+1);n?(s+=u,n=!1):u!==this.i?s+=null===(r=this.s(u))?u:r.call(this,i):n=!0}return s},s.prototype.h=function(t,i){if(""===i)return null;for(var n=new l,s=!1,h=0,r=0;r<t.length;r++){var u=t.substring(r,r+1);if(s)s=!1;else{if(u===this.i){s=!0;continue}var e=this.u(u);if(null!==e){try{h+=e.call(this,i.substring(h),n)}catch(t){if(!(t instanceof f))throw t;if(" "!==i.substring(h,h+1))throw t;h++,r--;continue}continue}}var o=i.substring(h,h+1);if(o===u)h++;else{if(" "===u)continue;if(" "!==o)throw new f;h++,r--}}return n.createDate()},s.prototype.s=function(t){switch(t){case"j":return this.o;case"d":return this.l;case"D":return this.v;case"l":return this.p;case"n":return this.D;case"m":return this.m;case"F":return this.k;case"M":return this.T;case"Y":return this.M;case"y":return this.g;default:return null}},s.prototype.o=function(t){return t.getDate()+""},s.prototype.l=function(t){return("0"+t.getDate()).slice(-2)},s.prototype.v=function(t){return this.I.translator.translateDayOfWeek(t.getDay())},s.prototype.p=function(t){return this.I.translator.translateDayOfWeekFull(t.getDay())},s.prototype.D=function(t){return t.getMonth()+1+""},s.prototype.m=function(t){return("0"+(t.getMonth()+1)).slice(-2)},s.prototype.k=function(t){return this.I.translator.translateMonth(t.getMonth())},s.prototype.T=function(t){return this.I.translator.translateMonthShort(t.getMonth())},s.prototype.M=function(t){return t.getFullYear()+""},s.prototype.g=function(t){var i=t.getFullYear()+"";return i.substring(i.length-2)},s.prototype.u=function(t){switch(t){case"j":case"d":return this.N;case"D":return this.R;case"l":return this.C;case"n":case"m":return this.A;case"F":return this.F;case"M":return this.S;case"Y":return this.j;case"y":return this.H;default:return null}},s.prototype.N=function(t,i){for(var n=0;"0"===t.substring(0,1);)t=t.substring(1),n++;var s=t.substring(0,2);if(!/[12][0-9]|3[01]/.test(s)&&(s=s.substring(0,1),!/[1-9]/.test(s)))throw new f;return i.day=parseInt(s,10),n+s.length},s.prototype.R=function(t){var i=this;return this.J(t,function(t){return i.I.translator.translateDayOfWeek(t)})},s.prototype.C=function(t){var i=this;return this.J(t,function(t){return i.I.translator.translateDayOfWeekFull(t)})},s.prototype.J=function(t,i){for(var n=0,s=0;s<7;s++){var h=i(s),n=Math.max(n,h.length);if(t.substring(0,h.length).toLowerCase()===h.toLowerCase())return h.length}for(var r=0;/[a-zA-Z]/.test(t.substring(0,1))&&(t=t.substring(1),++r!==n););return r},s.prototype.A=function(t,i){for(var n=0;"0"===t.substring(0,1);)t=t.substring(1),n++;var s=t.substring(0,2);if("10"!==s&&"11"!==s&&"12"!==s&&(s=s.substring(0,1),!/[1-9]/.test(s)))throw new f;return i.month=parseInt(s,10),n+s.length},s.prototype.F=function(t,i){var n=this;return this.O(t,i,function(t){return n.I.translator.translateMonth(t)})},s.prototype.S=function(t,i){var n=this;return this.O(t,i,function(t){return n.I.translator.translateMonthShort(t)})},s.prototype.O=function(t,i,n){for(var s=1;s<=12;s++){var h=n(s-1);if(t.substring(0,h.length).toLowerCase()===h.toLowerCase())return i.month=s,h.length}throw new f},s.prototype.j=function(t,i){var n=!1;"-"===t.substring(0,1)&&(n=!0,t=t.substring(1));for(var s=0;/[0-9]/.test(t.substring(s,s+1));)s++;if(0===s)throw new f;var h=parseInt(t.substring(0,s),10);return n&&(h=-h),i.year=h,s+(n?1:0)},s.prototype.H=function(t,i){var n=t.substring(0,2);if(!/[0-9]{2}/.test(n))throw new f;var s=this.I.getToday().getFullYear()+"",h=s.substring(0,s.length-2);return i.year=parseInt(h+n,10),2},s);function s(t){this.I=t,this.i="\\"}t.L=n}(TheDatepicker=TheDatepicker||{}),function(h){var k,t;(t=k=k||{})[t.Untouched=0]="Untouched",t[t.Waiting=1]="Waiting",t[t.Ready=2]="Ready",t[t.Initialized=3]="Initialized",t[t.Destroyed=4]="Destroyed";var i=(r.prototype.render=function(){var i=this;switch(this.P){case k.Destroyed:return;case k.Initialized:return void this.W.U();case k.Ready:return this.Y(),this.P=k.Initialized,void this.render();case k.Waiting:return this.G(),this.options.isHiddenOnBlur()?void(this.W._()||this.B()):void this.open();case k.Untouched:if(this.Z(),this.G(),this.W.$(null)||this.B(),null!==this.input&&this.options.isHiddenOnBlur())return this.input===this.q.activeElement?(this.P=k.Ready,this.render(),void this.open()):(this.K=h.X.V(this.input,h.tt.Focus,function(t){i.open(t)}),void(this.P=k.Waiting));this.P=k.Ready,this.render()}},r.prototype.open=function(t){return void 0===t&&(t=null),this.P===k.Untouched&&this.render(),this.P===k.Waiting&&(this.P=k.Ready,this.render(),r.it=!0),!!r.nt(t,this)&&(null!==this.input&&this.input.focus(),!0)},r.prototype.isOpened=function(){return this.W.st()},r.prototype.close=function(t){return void 0===t&&(t=null),!this.W.st()||!!r.nt(t,null)&&(null!==this.input&&this.input.blur(),!0)},r.prototype.reset=function(t){return void 0===t&&(t=null),this.W.ht(t)},r.prototype.destroy=function(){if(this.P!==k.Destroyed){for(var t=0;t<this.rt.length;t++)this.rt[t]();this.rt=[],this.ut?this.container.innerHTML="":this.container.parentNode.removeChild(this.container),delete this.container.datepicker,null!==this.input&&(delete this.input.datepicker,this.et(),this.input=null),null!==this.ot&&(this.ot.parentNode.removeChild(this.ot),this.ot=null),this.P=k.Destroyed}},r.prototype.selectDate=function(t,i,n){return void 0===i&&(i=!0),void 0===n&&(n=null),this.W.ft(n,h.X.lt("Date",t,this.options),!!i)},r.prototype.getSelectedDate=function(){return null!==this.W.at?new Date(this.W.at.getTime()):null},r.prototype.getSelectedDateFormatted=function(){return this.ct.t(this.options.getInputFormat(),this.W.at)},r.prototype.getCurrentMonth=function(){return new Date(this.W.vt().getTime())},r.prototype.goToMonth=function(t,i){return void 0===i&&(i=null),this.W.dt(i,h.X.lt("Month",t,this.options))},r.prototype.parseRawInput=function(){return this.wt?this.ct.h(this.options.getInputFormat(),this.input.value):null},r.prototype.pt=function(t){if(void 0===t&&(t=null),!this.wt)return!1;try{var i=this.parseRawInput();return null!==i?this.W.yt(t,i):this.W.Dt(t)}catch(t){if(!(t instanceof h.CannotParseDateException))throw t;return!1}},r.prototype.B=function(){var t;this.wt&&this.input!==this.q.activeElement&&(this.input.value=this.ct.t(this.options.getInputFormat(),this.W.at)||"",null!==this.ot&&(t=this.options.isDeselectButtonShown()&&""!==this.input.value,this.ot.style.visibility=t?"visible":"hidden"))},r.onDatepickerReady=function(t,i){if(void 0===i&&(i=null),!h.X.bt(t))throw new Error("Element was expected to be an HTMLElement.");i=h.X.kt("Callback",i);var n=null,s=null;return"undefined"!=typeof Promise&&(n=new Promise(function(t){s=t})),void 0!==t.datepicker&&t.datepicker instanceof r?(t.datepicker.Tt(i,t),null!==s&&s(t.datepicker)):r.Mt.push({promiseResolve:s,element:t,callback:i}),n},r.prototype.gt=function(){var t=this.q.createElement("div");return t.className=this.options.Et("container"),t.style.position="absolute",t.style.zIndex="99",t},r.prototype.G=function(){var i=this;if(!this.wt||!this.options.isDeselectButtonShown()||null!==this.ot)return null;var t=this.q.createElement("span");t.style.position="absolute";var n=this.q.createElement("a");n.innerHTML=this.options.getDeselectHtml(),n.style.position="relative",n.style.left="-0.8em",n.href="#",n.onclick=function(t){t=t||window.event,h.X.It(t),i.W.Dt(t)},t.className=this.options.Et("deselect"),n.className=this.options.Et("deselect-button"),t.appendChild(n),this.input.parentNode.insertBefore(t,this.input.nextSibling),this.ot=t},r.prototype.Z=function(){if(this.wt)try{var t=this.parseRawInput();null!==t&&this.options.setInitialDate(t)}catch(t){if(!(t instanceof h.CannotParseDateException))throw t}},r.prototype.Y=function(){var t,i=this;function n(t){r.nt(t,i),r.it=!0}r.Nt||(t=function(t){r.it?r.it=!1:r.nt(t,null)},h.X.V(this.q,h.tt.MouseDown,t),h.X.V(this.q,h.tt.FocusIn,t),h.X.V(this.q,h.tt.KeyDown,function(t){null!==r.Rt&&r.Rt.xt(t)}),r.Nt=!0),this.et(),this.rt.push(h.X.V(this.container,h.tt.MouseDown,n)),this.rt.push(h.X.V(this.container,h.tt.FocusIn,n)),null!==this.ot&&(this.rt.push(h.X.V(this.ot,h.tt.MouseDown,n)),this.rt.push(h.X.V(this.ot,h.tt.FocusIn,n))),null!==this.input&&(this.rt.push(h.X.V(this.input,h.tt.MouseDown,n)),this.rt.push(h.X.V(this.input,h.tt.Focus,n)),this.rt.push(h.X.V(this.input,h.tt.Blur,function(){i.B()})),this.rt.push(h.X.V(this.input,h.tt.KeyDown,function(t){h.X.Ct(t)})),this.rt.push(h.X.V(this.input,h.tt.KeyUp,function(t){i.pt(t)})))},r.prototype.et=function(){null!==this.K&&(this.K(),this.K=null)},r.prototype.At=function(t){for(var i=r.Mt.length-1;0<=i;i--){var n=r.Mt[i];n.element===t&&(this.Tt(n.callback,t),null!==n.promiseResolve&&n.promiseResolve(this),r.Mt.splice(i,1))}},r.prototype.Tt=function(t,i){null!==t&&t.call(i,this,i)},r.prototype.Ft=function(){if(!this.ut&&this.P!==k.Destroyed){var t=window.pageYOffset||this.q.documentElement.scrollTop,i=window.pageXOffset||this.q.documentElement.scrollLeft,n=null,s=null;window.visualViewport&&(n=window.visualViewport.height,s=window.visualViewport.width);for(var h=t+(n||window.innerHeight||Math.max(this.q.documentElement.clientHeight,this.q.body.clientHeight)||0),r=i+(s||window.innerWidth||Math.max(this.q.documentElement.clientWidth,this.q.body.clientWidth)||0),u=0,e=0,o=this.input;null!==o&&!isNaN(o.offsetLeft)&&!isNaN(o.offsetTop);)u+=o.offsetTop-(o.scrollTop||0),e+=o.offsetLeft-(o.scrollLeft||0),o=o.offsetParent;var f=null;this.options.isPositionFixingEnabled()&&0<this.container.childNodes.length&&((f=this.container.childNodes[0]).style.position="",f.style.top="",f.style.left="");var l,a,c=this.input.offsetWidth,v=this.input.offsetHeight,d=u+v,w=e+c,p=this.container.offsetHeight,y=this.container.offsetWidth,D="",b=p<u-t&&h-d<p,m=y-c<e-i&&r-w<y-c;b&&(D+=" "+this.options.Et("container--over")),m&&(D+=" "+this.options.Et("container--left")),this.container.className=this.options.Et("container")+D,null!==f&&(b||m)&&(b&&(l=v+p,f.style.top="-"+l+"px"),m&&(a=y-c,f.style.left="-"+a+"px"),f.style.position="absolute")}},r.nt=function(t,i){var n=null!==i?i.W:null,s=r.Rt;return!(s!==n&&(null!==s&&!s.St(t,!1)||r.Rt===s&&(null===n?r.Rt=null:!n.St(t,!0)||(r.Rt!==s||(i.Ft(),r.Rt=n),0))))},r.Mt=[],r.Nt=!1,r.Rt=null,r.it=!1,r);function r(t,i,n){if(void 0===i&&(i=null),void 0===n&&(n=null),this.P=k.Untouched,this.K=null,this.rt=[],(this.ot=null)!==t&&!h.X.bt(t))throw new Error("Input was expected to be null or an HTMLElement.");if(null!==i&&!h.X.bt(i))throw new Error("Container was expected to be null or an HTMLElement.");if(null===t&&null===i)throw new Error("At least one of input or container is mandatory.");if(null!==n&&!(n instanceof h.Options))throw new Error("Options was expected to be an instance of Options");this.q=document,this.options=null!==n?n.clone():new h.Options;var s="There is already a datepicker present on ";if(this.ut=null!==i,null===i)i=this.gt(),null!==t&&t.parentNode.insertBefore(i,t.nextSibling);else if(void 0!==i.datepicker)throw new Error(s+"container.");if(null!==t){if(void 0!==t.datepicker)throw new Error(s+"input.");t.datepicker=this}this.wt=null!==t&&("undefined"==typeof HTMLInputElement||t instanceof HTMLInputElement)&&"text"===t.type,this.wt&&(t.autocomplete="off"),(i.datepicker=this).input=t,this.container=i,this.ct=new h.L(this.options),this.W=new h.jt(this.options,this),this.At(t),this.At(i)}h.Datepicker=i,h.onDatepickerReady=i.onDatepickerReady}(TheDatepicker=TheDatepicker||{}),function(i){var t=(n.prototype.getDate=function(){return new Date(this.year,this.month-1,this.dayNumber,0,0,0,0)},n.prototype.getFormatted=function(){return this.year+"-"+("0"+this.month).slice(-2)+"-"+("0"+this.dayNumber).slice(-2)},n.prototype.isEqualToDate=function(t){return null!==t&&this.dayNumber===t.getDate()&&this.month===t.getMonth()+1&&this.year===t.getFullYear()},n.prototype.isEqualToDay=function(t){return null!==t&&this.dayNumber===t.dayNumber&&this.month===t.month&&this.year===t.year},n);function n(t){this.isToday=!1,this.isPast=!1,this.isAvailable=!0,this.isInValidity=!0,this.isVisible=!0,this.isInCurrentMonth=!0,this.isSelected=!1,this.isHighlighted=!1,this.isFocused=!1,this.dayNumber=t.getDate(),this.month=t.getMonth()+1,this.year=t.getFullYear(),this.dayOfWeek=t.getDay(),this.isWeekend=this.dayOfWeek===i.DayOfWeek.Saturday||this.dayOfWeek===i.DayOfWeek.Sunday}i.Day=t}(TheDatepicker=TheDatepicker||{}),function(f){var t,i,n,r,s;(t=f.DayOfWeek||(f.DayOfWeek={})) [t.Sunday=7]="Sunday",t[t.Monday=0]="Monday",t[t.Tuesday=2]="Tuesday",t[t.Wednesday=3]="Wednesday",t[t.Thursday=4]="Thursday",t[t.Friday=5]="Friday",t[t.Saturday=6]="Saturday",(i=f.Month||(f.Month={}))[i.January=0]="January",i[i.February=1]="February",i[i.March=2]="March",i[i.April=3]="April",i[i.May=4]="May",i[i.June=5]="June",i[i.July=6]="July",i[i.August=7]="August",i[i.September=8]="September",i[i.October=9]="October",i[i.November=10]="November",i[i.December=11]="December",(n=f.Ht||(f.Ht={}))[n.Enter=13]="Enter",n[n.Space=32]="Space",n[n.Left=37]="Left",n[n.Up=38]="Up",n[n.Right=39]="Right",n[n.Down=40]="Down",(s=r=f.tt||(f.tt={})).MouseDown="mousedown",s.Focus="focus",s.FocusIn="focusin",s.Blur="blur",s.KeyDown="keydown",s.KeyUp="keyup",s.TouchStart="touchstart",s.TouchMove="touchmove",s.AnimationEnd="animationend";var h=(l.Jt=function(t){return null===t?null:(t.setHours(0),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0),t)},l.lt=function(t,i,n){if(!i)return null;if(i instanceof f.Day)return i.getDate();if("string"==typeof i){if("today"===i||"now"===i)return n.getToday();if("tomorrow"===i){var s=n.getToday();return s.setDate(s.getDate()+1),s}if("yesterday"===i){var h=n.getToday();return h.setDate(h.getDate()-1),h}var r=i.match(/^\s*([+-]?)\s*([0-9]+)\s*(day|month|year)s?\s*$/i);if(null!==r){var u=n.getToday(),e=parseInt(r[2],10)*("-"===r[1]?-1:1);switch(r[3].toLowerCase()){case"day":case"days":u.setDate(u.getDate()+e);break;case"month":case"months":u.setMonth(u.getMonth()+e);break;case"year":case"years":u.setFullYear(u.getFullYear()+e)}return u}var o=l.Jt(new Date(i));if(!isNaN(o.getTime()))return o}else if(l.Ot(i)&&(o=l.Jt(new Date(i.getTime())),!isNaN(o.getTime())))return o;throw new Error(t+" was expected to be a valid Date string or valid Date or Day or null.")},l.bt=function(t){return"object"==typeof t&&1===t.nodeType&&"object"==typeof t.style&&"object"==typeof t.ownerDocument},l.Ot=function(t){return"object"==typeof t&&"[object Date]"===Object.prototype.toString.call(t)&&!isNaN(t.getTime())},l.Lt=function(t,i){for(var n=0;n<t.length;n++)if(t[n]===i)return!0;return!1},l.V=function(i,t,n){if(i.addEventListener)return i.addEventListener(t,n),function(){i.removeEventListener(t,n)};var s="on"+t,h=i[s]||null;return i[s]=function(t){t=t||window.event,null!==h&&h.call(i,t),n(t)},function(){i[s]=h}},l.It=function(t){t.preventDefault?t.preventDefault():t.returnValue=!1},l.Ct=function(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0},l.Pt=function(t,i,n){if(void 0===n&&(n=!1),!n&&!i)return"";if("string"!=typeof i||n&&""===i)throw new Error(t+" was expected to be a"+(n?" non empty":"")+" string.");return i},l.Ut=function(t,i,n,s){if(void 0===n&&(n=null),void 0===s&&(s=null),"number"!=typeof(i="string"==typeof i?parseInt(i):i)||isNaN(i)||null!==n&&i<n||null!==s&&s<i)throw new Error(t+" was expected to be a valid number"+(null!==n?" from "+n:"")+(null!==s?" to "+s:"")+".");return i},l.kt=function(t,i,n){if(void 0===n&&(n=!0),n&&!i)return null;if("function"!=typeof i)throw new Error(t+" was expected to be a function"+(n?" or null":"")+".");return i},l.Wt=function(t,i){if(window.console){for(var n=0;n<l.Yt.length;n++)if(t===l.Yt[0])return;window.console.warn("TheDatepicker: "+t+"() is deprecated, use "+i+"()"),l.Yt.push(t)}},l.zt=function(i,n){var s=null,h=null;l.V(i,r.TouchStart,function(t){s=t.touches[0].clientX,h=i.offsetWidth/5}),l.V(i,r.TouchMove,function(t){var i;null!==s&&(i=t.touches[0].clientX-s,Math.abs(i)>h&&(n(t,0<i),s=null))})},l.Gt=function(){var t;return null===l._t&&(t=document.createElement("div"),l._t=""===t.style.animationName),l._t},l.Yt=[],l._t=null,l);function l(){}f.X=h}(TheDatepicker=TheDatepicker||{}),function(h){var t=(i.prototype.Bt=function(t){var i=this.q.createElement("div");return this.Zt(i,t),i},i.prototype.$t=function(i){var t=this.q.createElement("a");return this.Zt(t,"button"),t.href="#",t.onclick=function(t){t=t||window.event,h.X.It(t),i(t)},t.onkeydown=function(t){t=t||window.event,h.X.Lt([h.Ht.Enter,h.Ht.Space],t.keyCode)&&(h.X.It(t),i(t))},t},i.prototype.qt=function(){return this.q.createElement("span")},i.prototype.Kt=function(t,i,n){var s=this.q.createElement("table");return this.Zt(s,t),s.appendChild(i),s.appendChild(n),s},i.prototype.Qt=function(t,i){var n=this.q.createElement("thead");this.Zt(n,t);for(var s=this.q.createElement("tr"),h=0;h<i.length;h++)s.appendChild(i[h]);return n.appendChild(s),n},i.prototype.Vt=function(t){var i=this.q.createElement("th");return i.scope="col",this.Zt(i,t),i},i.prototype.Xt=function(t,i){var n=this.q.createElement("tbody");this.Zt(n,t);for(var s=0;s<i.length;s++)n.appendChild(i[s]);return n},i.prototype.ti=function(t,i){for(var n=this.q.createElement("tr"),s=0;s<i.length;s++)n.appendChild(i[s]);return n},i.prototype.ii=function(){return this.q.createElement("td")},i.prototype.ni=function(t,i){var n=this.q.createElement("select");this.Zt(n,"select");for(var s=0;s<t.length;s++)n.appendChild(this.si(t[s].value,t[s].label));return n.onchange=function(t){i(t||window.event,n.value)},n.onkeydown=function(t){t=t||window.event,h.X.Ct(t)},n},i.prototype.si=function(t,i){var n=this.q.createElement("option");return n.value=t,n.innerText=i,n},i.prototype.Zt=function(t,i){i=this.I.Et(i),""!==t.className&&(i=" "+i),t.className+=i},i.prototype.hi=function(t,i){i&&t.appendChild(i)},i);function i(t){this.I=t,this.q=document}h.ri=t}(TheDatepicker=TheDatepicker||{}),function(h){var i,t;(t=i=h.ui||(h.ui={})).BeforeSelect="beforeSelect",t.Select="select",t.BeforeOpenAndClose="beforeOpenAndClose",t.OpenAndClose="openAndClose",t.BeforeMonthChange="beforeMonthChange",t.MonthChange="monthChange",t.Focus="focus",t.BeforeFocus="beforeFocus";var n=function(){};h.AvailableDateNotFoundException=n;var s=(r.prototype.clone=function(){var t=new r(this.translator);return t.ei=this.ei,t.oi=this.oi,t.fi=this.fi,t.li=this.li,t.ai=this.ai,t.ci=this.ci,t.vi=this.vi,t.di=this.di,t.wi=this.wi,t.pi=this.pi,t.yi=this.yi,t.Di=this.Di,t.bi=this.bi,t.mi=this.mi,t.ki=this.ki.slice(0),t.Ti=this.Ti.slice(0),t.Mi=this.Mi,t.gi=this.gi,t.Ei=this.Ei,t.Ii=this.Ii,t.Ni=this.Ni,t.Ri=this.Ri,t.xi=this.xi,t.Ci=this.Ci,t.Ai=this.Ai,t.Fi=this.Fi,t.Si=this.Si,t.ji=this.ji,t.Hi=this.Hi,t.Ji=this.Ji,t.Oi=this.Oi,t.Li=this.Li,t.Pi=this.Pi,t.Ui=this.Ui,t.Wi=this.Wi,t.Yi=this.Yi,t.zi=this.zi,t.Gi=this.Gi,t._i=this._i,t.Bi=this.Bi,t.Zi.beforeSelect=this.Zi.beforeSelect.slice(0),t.Zi.select=this.Zi.select.slice(0),t.Zi.beforeOpenAndClose=this.Zi.beforeOpenAndClose.slice(0),t.Zi.openAndClose=this.Zi.openAndClose.slice(0),t.Zi.beforeMonthChange=this.Zi.beforeMonthChange.slice(0),t.Zi.monthChange=this.Zi.monthChange.slice(0),t.Zi.beforeFocus=this.Zi.beforeFocus.slice(0),t.Zi.focus=this.Zi.focus.slice(0),t},r.prototype.setHideOnBlur=function(t){this.ei=!!t},r.prototype.setHideOnSelect=function(t){this.oi=!!t},r.prototype.setMinDate=function(t){var i=h.X.lt("Min date",t,this);this.$i(i,this.li),this.fi=i},r.prototype.setMaxDate=function(t){var i=h.X.lt("Max date",t,this);this.$i(this.fi,i),this.li=i},r.prototype.setInitialMonth=function(t){this.ci=h.X.lt("Initial month",t,this)},r.prototype.setInitialDate=function(t){this.ai=h.X.lt("Initial date",t,this)},r.prototype.setInitialDatePriority=function(t){this.vi=!!t},r.prototype.setFirstDayOfWeek=function(t){this.di=h.X.Ut("First day of week",t,0,6)},r.prototype.setDateAvailabilityResolver=function(t){this.wi=h.X.kt("Resolver",t)},r.prototype.setCellContentResolver=function(t){this.pi=h.X.kt("Resolver",t)},r.prototype.setCellContentStructureResolver=function(t,i){void 0===i&&(i=null),t=h.X.kt("Resolver (init)",t),i=h.X.kt("Resolver (update)",i),this.yi=null===t?null:{init:t,update:i}},r.prototype.setHeaderStructureResolver=function(t){this.Di=h.X.kt("Resolver",t)},r.prototype.setFooterStructureResolver=function(t){this.bi=h.X.kt("Resolver",t)},r.prototype.setCellClassesResolver=function(t){h.X.Wt("setCellClassesResolver","addCellClassesResolver"),this.mi=h.X.kt("Resolver",t)},r.prototype.addCellClassesResolver=function(t){this.ki.push(h.X.kt("Resolver",t,!1))},r.prototype.removeCellClassesResolver=function(t){if(void 0===t&&(t=null),null===(t=h.X.kt("Resolver",t)))this.ki=[];else{for(var i=[],n=0;n<this.ki.length;n++)this.ki[n]!==t&&i.push(this.ki[n]);this.ki=i}},r.prototype.addDayModifier=function(t){this.Ti.push(h.X.kt("Modifier",t,!1))},r.prototype.removeDayModifier=function(t){if(void 0===t&&(t=null),null===(t=h.X.kt("Modifier",t)))this.Ti=[];else{for(var i=[],n=0;n<this.Ti.length;n++)this.Ti[n]!==t&&i.push(this.Ti[n]);this.Ti=i}},r.prototype.setInputFormat=function(t){this.Mi=h.X.Pt("Input format",t,!0)},r.prototype.setDaysOutOfMonthVisible=function(t){this.gi=!!t},r.prototype.setFixedRowsCount=function(t){this.Ei=!!t},r.prototype.setToggleSelection=function(t){this.Ii=!!t},r.prototype.setShowDeselectButton=function(t){this.Ri=!!t},r.prototype.setAllowEmpty=function(t){this.Ni=!!t},r.prototype.setShowResetButton=function(t){this.xi=!!t},r.prototype.setMonthAsDropdown=function(t){this.Ci=!!t},r.prototype.setYearAsDropdown=function(t){this.Ai=!!t},r.prototype.setMonthAndYearSeparated=function(t){this.Fi=!!t},r.prototype.setMonthShort=function(t){this.Si=!!t},r.prototype.setChangeMonthOnSwipe=function(t){this.ji=!!t},r.prototype.setAnimateMonthChange=function(t){this.Hi=!!t},r.prototype.setClassesPrefix=function(t){this.Ji=h.X.Pt("Prefix",t)},r.prototype.setShowCloseButton=function(t){this.Oi=!!t},r.prototype.setTitle=function(t){this.Li=h.X.Pt("Title",t)},r.prototype.setDropdownItemsLimit=function(t){this.Pi=h.X.Ut("Items limit",t,1)},r.prototype.setHideDropdownWithOneItem=function(t){this.Ui=!!t},r.prototype.setGoBackHtml=function(t){this.Wi=h.X.Pt("Html",t)},r.prototype.setGoForwardHtml=function(t){this.Yi=h.X.Pt("Html",t)},r.prototype.setCloseHtml=function(t){this.zi=h.X.Pt("Html",t)},r.prototype.setResetHtml=function(t){this.Gi=h.X.Pt("Html",t)},r.prototype.setDeselectHtml=function(t){this._i=h.X.Pt("Html",t)},r.prototype.setPositionFixing=function(t){this.Bi=!!t},r.prototype.setToday=function(t){this.qi=h.X.lt("Today",t,this)},r.prototype.onBeforeSelect=function(t){this.Ki(i.BeforeSelect,t)},r.prototype.offBeforeSelect=function(t){void 0===t&&(t=null),this.Qi(i.BeforeSelect,t)},r.prototype.onSelect=function(t){this.Ki(i.Select,t)},r.prototype.offSelect=function(t){void 0===t&&(t=null),this.Qi(i.Select,t)},r.prototype.onBeforeOpenAndClose=function(t){this.Ki(i.BeforeOpenAndClose,t)},r.prototype.offBeforeOpenAndClose=function(t){void 0===t&&(t=null),this.Qi(i.BeforeOpenAndClose,t)},r.prototype.onOpenAndClose=function(t){this.Ki(i.OpenAndClose,t)},r.prototype.offOpenAndClose=function(t){void 0===t&&(t=null),this.Qi(i.OpenAndClose,t)},r.prototype.onBeforeMonthChange=function(t){this.Ki(i.BeforeMonthChange,t)},r.prototype.offBeforeMonthChange=function(t){void 0===t&&(t=null),this.Qi(i.BeforeMonthChange,t)},r.prototype.onMonthChange=function(t){this.Ki(i.MonthChange,t)},r.prototype.offMonthChange=function(t){void 0===t&&(t=null),this.Qi(i.MonthChange,t)},r.prototype.onBeforeFocus=function(t){this.Ki(i.BeforeFocus,t)},r.prototype.offBeforeFocus=function(t){void 0===t&&(t=null),this.Qi(i.BeforeFocus,t)},r.prototype.onFocus=function(t){this.Ki(i.Focus,t)},r.prototype.offFocus=function(t){void 0===t&&(t=null),this.Qi(i.Focus,t)},r.prototype.getInitialMonth=function(){var t=this.vi?this.ai:this.ci,i=this.vi?this.ci:this.ai,n=null!==t?new Date(t.getTime()):null!==i?new Date(i.getTime()):this.getToday();return n.setDate(1),this.correctMonth(n)},r.prototype.isMonthInValidity=function(t){return null===this.Vi(t)},r.prototype.correctMonth=function(t){var i=this.Vi(t);return null!==i?i:t},r.prototype.getInitialDate=function(){return this.findPossibleAvailableDate(this.ai)},r.prototype.findPossibleAvailableDate=function(t){if(this.isAllowedEmpty())return null!==t&&this.isDateInValidity(t)&&this.isDateAvailable(t)?new Date(t.getTime()):null;if(t=null!==t?new Date(t.getTime()):this.getToday(),null!==(t=this.findNearestAvailableDate(t)))return t;throw new n},r.prototype.findNearestAvailableDate=function(t){if(t=this.Xi(t),this.isDateAvailable(t))return t;var i=this.tn().getTime(),n=this.in().getTime(),s=1e3,h=t,r=new Date(t.getTime());do{if(null!==h)if(h.setDate(h.getDate()+1),h.getTime()>n)h=null;else if(this.isDateAvailable(h))return h;if(null!==r)if(r.setDate(r.getDate()-1),r.getTime()<i)r=null;else if(this.isDateAvailable(r))return r;s--}while((null!==h||null!==r)&&0<s);return null},r.prototype.isDateInValidity=function(t){return null===this.nn(t)},r.prototype.Xi=function(t){var i=this.nn(t);return null!==i?i:t},r.prototype.getFirstDayOfWeek=function(){return this.di},r.prototype.areDaysOutOfMonthVisible=function(){return this.gi},r.prototype.hasFixedRowsCount=function(){return this.Ei},r.prototype.hasToggleSelection=function(){return this.Ni&&this.Ii},r.prototype.isAllowedEmpty=function(){return this.Ni},r.prototype.isDeselectButtonShown=function(){return this.Ni&&this.Ri},r.prototype.isResetButtonShown=function(){return this.xi},r.prototype.isMonthAsDropdown=function(){return this.Ci},r.prototype.isYearAsDropdown=function(){return this.Ai},r.prototype.isMonthAndYearSeparated=function(){return this.Fi},r.prototype.isMonthShort=function(){return this.Si},r.prototype.sn=function(){return this.ji},r.prototype.isMonthChangeAnimated=function(){return this.Hi},r.prototype.getClassesPrefix=function(){return this.Ji},r.prototype.isCloseButtonShown=function(){return this.ei&&this.Oi},r.prototype.getTitle=function(){return this.Li},r.prototype.getMinDate=function(){return null!==this.fi?new Date(this.fi.getTime()):null},r.prototype.getMaxDate=function(){return null!==this.li?new Date(this.li.getTime()):null},r.prototype.tn=function(){var t=this.getMinDate();return null===t?new Date(-271821,4,1):t},r.prototype.in=function(){var t=this.getMaxDate();return null===t?new Date(275760,7,31):t},r.prototype.getMinMonth=function(){if(null===this.fi)return null;var t=new Date(this.fi.getTime());return t.setDate(1),t},r.prototype.getMaxMonth=function(){if(null===this.li)return null;var t=new Date(this.li.getTime());return t.setDate(1),t},r.prototype.hn=function(){var t=this.getMinMonth();return null===t&&(t=this.tn()),t},r.prototype.rn=function(){var t=this.getMaxMonth();return null===t&&(t=this.in()).setDate(1),t},r.prototype.isDropdownWithOneItemHidden=function(){return this.Ui},r.prototype.getDropdownItemsLimit=function(){return this.Pi},r.prototype.isDateAvailable=function(t){return null===this.wi||!!this.wi(new Date(t.getTime()))},r.prototype.getCellContent=function(t){return null!==this.pi?this.pi(t):t.dayNumber+""},r.prototype.Et=function(t){return this.Ji+t},r.prototype.un=function(){return null!==this.yi?this.yi.init():this.q.createElement("span")},r.prototype.en=function(t,i){null!==this.yi?this.yi.update(t,i):t.innerText=this.getCellContent(i)},r.prototype.on=function(){return null!==this.Di?this.Di():null},r.prototype.fn=function(){return null!==this.bi?this.bi():null},r.prototype.getCellClasses=function(t){var i=[];null!==this.mi&&("string"==typeof(n=this.mi(t))?i.push(n):"object"==typeof n&&n.constructor===Array&&(i=i.concat(n)));for(var n,s=this.ki.slice(0),h=0;h<s.length;h++)"string"==typeof(n=s[h](t))?i.push(n):"object"==typeof n&&n.constructor===Array&&(i=i.concat(n));return i},r.prototype.modifyDay=function(t){for(var i=this.Ti.slice(0),n=0;n<i.length;n++)i[n](t)},r.prototype.getGoBackHtml=function(){return this.Wi},r.prototype.getGoForwardHtml=function(){return this.Yi},r.prototype.getCloseHtml=function(){return this.zi},r.prototype.getResetHtml=function(){return this.Gi},r.prototype.getDeselectHtml=function(){return this._i},r.prototype.isHiddenOnBlur=function(){return this.ei},r.prototype.isHiddenOnSelect=function(){return this.ei&&this.oi},r.prototype.getInputFormat=function(){return this.Mi},r.prototype.isPositionFixingEnabled=function(){return this.ei&&this.Bi},r.prototype.getToday=function(){return null!==this.qi?new Date(this.qi.getTime()):h.X.Jt(new Date)},r.prototype.getDateAvailabilityResolver=function(){return this.wi},r.prototype.getCellContentResolver=function(){return this.pi},r.prototype.getCellContentStructureResolver=function(){return this.yi},r.prototype.getHeaderStructureResolver=function(){return this.Di},r.prototype.getFooterStructureResolver=function(){return this.bi},r.prototype.getCellClassesResolvers=function(){return this.ki},r.prototype.getDayModifiers=function(){return this.Ti},r.prototype.getBeforeSelectListeners=function(){return this.Zi.beforeSelect},r.prototype.getSelectListeners=function(){return this.Zi.select},r.prototype.getBeforeOpenAndCloseListeners=function(){return this.Zi.beforeOpenAndClose},r.prototype.getOpenAndCloseListeners=function(){return this.Zi.openAndClose},r.prototype.getBeforeMonthChangeListeners=function(){return this.Zi.beforeMonthChange},r.prototype.getMonthChangeListeners=function(){return this.Zi.monthChange},r.prototype.getBeforeFocusListeners=function(){return this.Zi.beforeFocus},r.prototype.getFocusListeners=function(){return this.Zi.focus},r.prototype.$i=function(t,i){if(null!==t&&null!==i&&t.getTime()>i.getTime())throw new Error("Min date cannot be higher then max date.")},r.prototype.Vi=function(t){var i=this.hn();if(t.getTime()<i.getTime())return i;var n=this.rn();return t.getTime()>n.getTime()?n:null},r.prototype.nn=function(t){var i=this.tn();if(t.getTime()<i.getTime())return i;var n=this.in();return t.getTime()>n.getTime()?n:null},r.prototype.Ki=function(t,i){this.Zi[t].push(h.X.kt("Event listener",i,!1))},r.prototype.Qi=function(t,i){if(null===(i=h.X.kt("Event listener",i)))this.Zi[t]=[];else{for(var n=[],s=0;s<this.Zi[t].length;s++)this.Zi[t][s]!==i&&n.push(this.Zi[t][s]);this.Zi[t]=n}},r.prototype.ln=function(t,i){for(var n=this.Zi[t].slice(0),s=0;s<n.length;s++)if(!1===i(n[s]))return!1;return!0},r);function r(t){void 0===t&&(t=null),this.ei=!0,this.oi=!0,this.fi=null,this.li=null,this.ai=null,this.ci=null,this.vi=!0,this.di=h.DayOfWeek.Monday,this.wi=null,this.pi=null,this.yi=null,this.Di=null,this.bi=null,this.mi=null,this.ki=[],this.Ti=[],this.Mi="Y-m-d",this.gi=!1,this.Ei=!1,this.Ii=!1,this.Ni=!0,this.Ri=!0,this.xi=!1,this.Ci=!0,this.Ai=!0,this.Fi=!0,this.Si=!1,this.ji=!0,this.Hi=!0,this.Ji="the-datepicker__",this.Oi=!0,this.Li="",this.Pi=200,this.Ui=!0,this.Wi="&lt;",this.Yi="&gt;",this.zi="&times;",this.Gi="&olarr;",this._i="&times;",this.Bi=!0,this.qi=null,this.Zi={beforeSelect:[],select:[],beforeOpenAndClose:[],openAndClose:[],beforeMonthChange:[],monthChange:[],beforeFocus:[],focus:[]},this.translator=null!==t?t:new h.Translator,this.q=document}h.Options=s}(TheDatepicker=TheDatepicker||{}),function(o){var t=(i.prototype.U=function(t){if(null===this.an){if(this.cn&&this.I.isHiddenOnBlur()&&!t.st())return;this.vn.innerHTML="",this.vn.appendChild(this.dn(t))}this.wn(t),this.pn(t),this.yn(t),this.Dn(t),this.bn(t),this.mn(t),this.kn(t),this.Tn(t),this.Mn(t),this.gn(t),this.En(t)},i.prototype.dn=function(t){var i=this.In.Bt("main");return this.In.hi(i,this.I.on()),i.appendChild(this.Nn(t)),i.appendChild(this.Rn(t)),this.In.hi(i,this.I.fn()),this.an=i},i.prototype.wn=function(t){this.an.style.display=this.cn&&!t.st()&&this.I.isHiddenOnBlur()?"none":""},i.prototype.Rn=function(n){var s=this,t=this.In.Bt("body");return this.I.sn()&&o.X.zt(t,function(t,i){s.xn(n,t,!i)}),t.appendChild(this.Cn(n)),this.An=t},i.prototype.Nn=function(t){var i=this.In.Bt("header"),n=this.In.Bt("top");i.appendChild(n),n.appendChild(this.Fn(t));var s=this.In.Bt("control");n.appendChild(s),s.appendChild(this.Sn(t)),s.appendChild(this.jn(t));var h=this.In.Bt("navigation");i.appendChild(h),h.appendChild(this.Hn(t));var r=this.In.Bt("state");return h.appendChild(r),this.I.isMonthAndYearSeparated()?(r.appendChild(this.Jn(t)),r.appendChild(this.On(t))):r.appendChild(this.Ln(t)),h.appendChild(this.Pn(t)),this.Un=s,i},i.prototype.pn=function(t){var i=""!==this.I.getTitle()||this.I.isResetButtonShown()||this.cn&&this.I.isCloseButtonShown();this.Un.style.display=i?"":"none",this.Wn.style.display=i?"":"none"},i.prototype.Fn=function(t){var i=this.In.Bt("title"),n=this.In.qt();return i.appendChild(n),this.In.Zt(n,"title-content"),this.Wn=i,this.Yn=n,i},i.prototype.yn=function(t){var i=this.I.getTitle();this.Yn.style.display=""!==i?"":"none",this.Yn.innerText=i},i.prototype.Sn=function(i){var t=this.In.Bt("reset"),n=this.In.$t(function(t){i.ht(t)});n.innerHTML=this.I.getResetHtml();var s=this.I.translator.translateTitle(o.TitleName.Reset);return""!==s&&(n.title=s),t.appendChild(n),this.zn=t},i.prototype.bn=function(t){this.zn.style.display=this.I.isResetButtonShown()?"":"none"},i.prototype.jn=function(i){var t=this.In.Bt("close"),n=this.In.$t(function(t){i.Gn(t)});n.innerHTML=this.I.getCloseHtml();var s=this.I.translator.translateTitle(o.TitleName.Close);return""!==s&&(n.title=s),t.appendChild(n),this._n=t},i.prototype.Dn=function(t){this._n.style.display=this.cn&&this.I.isCloseButtonShown()?"":"none"},i.prototype.Hn=function(t){return this.Bn(t,!1)},i.prototype.Pn=function(t){return this.Bn(t,!0)},i.prototype.Bn=function(i,n){var s=this,t=this.In.Bt("go");this.In.Zt(t,n?"go-next":"go-previous");var h=this.In.$t(function(t){s.xn(i,t,n)});h.innerHTML=n?this.I.getGoForwardHtml():this.I.getGoBackHtml();var r=this.I.translator.translateTitle(n?o.TitleName.GoForward:o.TitleName.GoBack);return""!==r&&(h.title=r),t.appendChild(h),n?this.Zn=h:this.$n=h,t},i.prototype.mn=function(t){this.$n.style.visibility=t.qn()?"visible":"hidden"},i.prototype.kn=function(t){this.Zn.style.visibility=t.Kn()?"visible":"hidden"},i.prototype.Jn=function(h){for(var r=this,t=[],i=0;i<12;i++)t.push({value:i+"",label:this.translateMonth(i)});var n=this.In.ni(t,function(t,i){var n=h.vt(),s=new Date(n.getTime());s.setMonth(parseInt(i,10)),h.dt(t,s)||(r.Qn.value=n.getMonth()+"")}),s=this.In.Bt("month"),u=this.In.qt();return s.appendChild(n),s.appendChild(u),this.Vn=u,this.Qn=n,s},i.prototype.Tn=function(t){if(null!==this.Vn){var i=t.vt().getMonth();if(this.Vn.innerText=this.translateMonth(i),!this.I.isMonthAsDropdown())return this.Qn.style.display="none",void(this.Vn.style.display="");for(var n=0,s=0;s<12;s++){var h=new Date(t.vt().getTime());h.setMonth(s);var r=this.Qn.getElementsByTagName("option")[s],u=t.Xn(h);r.disabled=!u,r.style.display=u?"":"none",n+=u?1:0}this.Qn.value=i+"";var e=!this.I.isDropdownWithOneItemHidden()||1<n;this.Qn.style.display=e?"":"none",this.Vn.style.display=e?"none":""}},i.prototype.On=function(u){var e=this,t=this.In.ni([],function(t,i){var n=u.vt(),s=new Date(n.getTime());s.setFullYear(parseInt(i,10));var h=e.I.hn(),r=e.I.rn();s.getTime()<h.getTime()&&(s=h),s.getTime()>r.getTime()&&(s=r),u.dt(t,s)||(e.ts.value=n.getFullYear()+"")}),i=this.In.Bt("year"),n=this.In.qt();return i.appendChild(t),i.appendChild(n),this.ns=n,this.ts=t,i},i.prototype.Mn=function(t){if(null!==this.ns){var i=t.vt().getFullYear();if(this.ns.innerText=i+"",!this.I.isYearAsDropdown())return this.ts.style.display="none",void(this.ns.style.display="");for(var n=this.I.tn().getFullYear(),s=this.I.in().getFullYear(),h=this.ss(i,n,s),r=this.ts.getElementsByTagName("option"),u=this.hs(r,h,function(t){return parseInt(t,10)}),e=0;e<u.remove.length;e++)this.ts.removeChild(u.remove[e]);for(e=u.prepend.length-1;0<=e;e--)this.ts.insertBefore(this.In.si(u.prepend[e]+"",u.prepend[e]+""),this.ts.firstChild);for(e=0;e<u.append.length;e++)this.ts.appendChild(this.In.si(u.append[e]+"",u.append[e]+""));this.ts.value=i+"";var o=!this.I.isDropdownWithOneItemHidden()||h.from<h.to;this.ts.style.display=o?"":"none",this.ns.style.display=o?"none":""}},i.prototype.Ln=function(r){var u=this,t=this.In.Bt("month-year"),i=this.In.ni([],function(t,i){var n=r.vt(),s=new Date(n.getTime()),h=u.rs(i);s.setFullYear(h.year),s.setMonth(h.month),r.dt(t,s)||(u.us.value=u.es({month:n.getMonth(),year:n.getFullYear()}))}),n=this.In.qt();return this.os=n,this.us=i,t.appendChild(n),t.appendChild(i),t},i.prototype.gn=function(t){var i=this;if(null!==this.os){var n=t.vt(),s={month:n.getMonth(),year:n.getFullYear()},h=this.fs(s);if(this.os.innerText=this.ls(s),!this.I.isYearAsDropdown()||!this.I.isMonthAsDropdown())return this.us.style.display="none",void(this.os.style.display="");for(var r=this.I.tn(),u=this.I.in(),e=12*r.getFullYear()+r.getMonth(),o=12*u.getFullYear()+u.getMonth(),f=this.ss(h,e,o),l=this.us.getElementsByTagName("option"),a=this.hs(l,f,function(t){return i.fs(i.rs(t))}),c=0;c<a.remove.length;c++)this.us.removeChild(a.remove[c]);for(c=a.prepend.length-1;0<=c;c--){var v=this.cs(a.prepend[c]);this.us.insertBefore(this.In.si(this.es(v),this.ls(v)),this.us.firstChild)}for(c=0;c<a.append.length;c++)v=this.cs(a.append[c]),this.us.appendChild(this.In.si(this.es(v),this.ls(v)));this.us.value=this.es(s);var d=!this.I.isDropdownWithOneItemHidden()||f.from<f.to;this.us.style.display=d?"":"none",this.os.style.display=d?"none":""}},i.prototype.ls=function(t){return this.translateMonth(t.month)+" "+t.year},i.prototype.fs=function(t){return 12*t.year+t.month},i.prototype.cs=function(t){return{year:Math.floor(t/12),month:t%12}},i.prototype.es=function(t){return t.year+"-"+t.month},i.prototype.rs=function(t){var i=t.split("-");return{month:parseInt(i[1],10),year:parseInt(i[0],10)}},i.prototype.ss=function(t,i,n){var s=this.I.getDropdownItemsLimit()-1,h=Math.ceil(s/2),r=t-(s-h),u=t+h;return r<i?(n<(u+=i-r)&&(u=n),r=i):n<u&&((r-=u-n)<i&&(r=i),u=n),{from:r,to:u}},i.prototype.hs=function(t,i,n){for(var s=0<t.length?n(t[0].value):null,h=0<t.length?n(t[t.length-1].value):null,r=[],u=[],e=[],o=i.from;o<=i.to;o++)null===s||o<s?r.push(o):h<o&&u.push(o);for(var f=0;f<t.length;f++)((o=n(t[f].value))<i.from||o>i.to)&&e.push(t[f]);return{prepend:r,append:u,remove:e}},i.prototype.Cn=function(t){var i=this.vs(t),n=this.ds(t);return this.In.Kt("calendar",i,n)},i.prototype.vs=function(t){for(var i=t.ws(),n=[],s=0;s<i.length;s++){var h=i[s];n.push(this.ps(t,h))}return this.In.Qt("calendar-header",n)},i.prototype.ps=function(t,i){var n=this.In.Vt("week-day");return i!==o.DayOfWeek.Saturday&&i!==o.DayOfWeek.Sunday||this.In.Zt(n,"week-day--weekend"),n.innerText=this.I.translator.translateDayOfWeek(i),n},i.prototype.ds=function(t){this.ys=[],this.Ds=[],this.bs=[];for(var i=[],n=0;n<6;n++)i.push(this.ms(t));return this.ks=i,this.In.Xt("calendar-body",i)},i.prototype.En=function(t){for(var i=t.Ts(),n=0;n<this.ks.length;n++){var s=this.ks[n],h=i.length>n?i[n]:null;if(s.style.display=null!==h?"":"none",null!==h)for(var r=0;r<this.ys[n].length;r++)this.Ms(t,this.ys[n][r],this.Ds[n][r],this.bs[n][r],h[r])}},i.prototype.ms=function(t){for(var i=[],n=[],s=[],h=0;h<7;h++){var r=this.In.ii(),u=this.gs(t),e=this.Es(t);i.push(r),n.push(u),s.push(e),r.appendChild(u),u.appendChild(e)}return this.ys.push(i),this.Ds.push(n),this.bs.push(s),this.In.ti("week",i)},i.prototype.Ms=function(t,i,n,s,h){if(n.day=h,i.setAttribute("data-date",h.getFormatted()),i.className="",this.In.Zt(i,"cell"),this.I.en(s,h),!h.isVisible)return n.removeAttribute("href"),void(n.style.visibility="hidden");this.In.Zt(i,"day"),h.isToday&&this.In.Zt(i,"day--today"),h.isPast&&this.In.Zt(i,"day--past"),h.isWeekend&&this.In.Zt(i,"day--weekend"),h.isAvailable||this.In.Zt(i,"day--unavailable"),h.isInCurrentMonth||this.In.Zt(i,"day--outside"),h.isHighlighted&&this.In.Zt(i,"day--highlighted"),h.isSelected&&this.In.Zt(i,"day--selected");for(var r=this.I.getCellClasses(h),u=0;u<r.length;u++)i.className+=" "+r[u];n.style.visibility="visible",h.isAvailable?n.href="#":n.removeAttribute("href"),h.isFocused&&n.focus()},i.prototype.gs=function(s){var h=this,r=this.In.$t(function(t){var i=s.at,n=s.ft(t,r.day,!1,!0,!0);h.I.isHiddenOnSelect()&&(n||null!==i&&r.day.isEqualToDate(i))&&s.Gn(t)});return r.onfocus=function(t){s.Is(t||window.event,r.day)},r.onmouseenter=function(t){0<h.I.getBeforeFocusListeners().length||0<h.I.getFocusListeners().length?s.Is(t||window.event,r.day,!1,!1):s.Ns(t||window.event)},r.onmouseleave=function(t){s.Ns(t||window.event)},r},i.prototype.Es=function(t){var i=this.I.un();return this.In.Zt(i,"day-content"),i},i.prototype.xn=function(t,i,n){var s,h,r,u,e=this;(n?t.Kn():t.qn())&&(s=function(){n?t.Rs(i):t.xs(i)},this.I.isMonthChangeAnimated()&&o.X.Gt()?(h=n?"fade-out-left":"fade-out-right",r=n?"fade-in-right":"fade-in-left",u=o.X.V(this.An,o.tt.AnimationEnd,function(t){s(),u(),e.An.className=e.I.Et("body"),e.In.Zt(e.An,"animated"),e.In.Zt(e.An,r),u=o.X.V(e.An,o.tt.AnimationEnd,function(t){u(),e.An.className=e.I.Et("body")})}),this.An.className=this.I.Et("body"),this.In.Zt(this.An,"animated"),this.In.Zt(this.An,h)):s())},i.prototype.translateMonth=function(t){return this.I.isMonthShort()?this.I.translator.translateMonthShort(t):this.I.translator.translateMonth(t)},i);function i(t,i,n,s){this.I=t,this.In=i,this.vn=n,this.cn=s,this.an=null,this.An=null,this.Un=null,this.$n=null,this.Zn=null,this.Wn=null,this.Yn=null,this.zn=null,this._n=null,this.Qn=null,this.Vn=null,this.ts=null,this.ns=null,this.us=null,this.os=null,this.ks=[],this.ys=[],this.Ds=[],this.bs=[]}o.Cs=t}(TheDatepicker=TheDatepicker||{}),function(n){var i,t;(t=i=n.TitleName||(n.TitleName={}))[t.GoBack=0]="GoBack",t[t.GoForward=1]="GoForward",t[t.Close=2]="Close",t[t.Reset=3]="Reset";var s=(h.prototype.setDayOfWeekTranslation=function(t,i){this.As[n.X.Ut("Day of week",t,0,6)]=n.X.Pt("Translation",i)},h.prototype.setDayOfWeekFullTranslation=function(t,i){this.Fs[n.X.Ut("Day of week",t,0,6)]=n.X.Pt("Translation",i)},h.prototype.setMonthTranslation=function(t,i){this.Ss[n.X.Ut("Month",t,0,11)]=n.X.Pt("Translation",i)},h.prototype.setMonthShortTranslation=function(t,i){this.js[n.X.Ut("Month",t,0,11)]=n.X.Pt("Translation",i)},h.prototype.setTitleTranslation=function(t,i){this.Hs[t]=n.X.Pt("Translation",i)},h.prototype.translateDayOfWeek=function(t){return this.As[t]},h.prototype.translateDayOfWeekFull=function(t){return this.Fs[t]},h.prototype.translateMonth=function(t){return this.Ss[t]},h.prototype.translateMonthShort=function(t){return this.js[t]},h.prototype.translateTitle=function(t){var i=this.Hs[t];if("string"!=typeof i)throw new Error("Unknown title "+t);return i},h);function h(){var t;this.Fs=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],this.As=["Su","Mo","Tu","We","Th","Fr","Sa"],this.Ss=["January","February","March","April","May","June","July","August","September","October","November","December"],this.js=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],this.Hs=((t={})[i.GoBack]="Previous month",t[i.GoForward]="Next month",t[i.Close]="Close",t[i.Reset]="Reset",t)}n.Translator=s}(TheDatepicker=TheDatepicker||{}),function(e){var i,t;(t=i=e.Js||(e.Js={}))[t.Left=-1]="Left",t[t.Up=-7]="Up",t[t.Right=1]="Right",t[t.Down=7]="Down";var n=(s.prototype.U=function(){var t;this._()||(t=this.I.correctMonth(this.vt()),this.dt(null,t)||(this.Os.U(this),this.Ls.B()))},s.prototype.St=function(t,i){return this.Ps===i||!!this.Us(t,i)&&(this.Ps=i,this.I.isHiddenOnBlur()&&this.U(),this.Ws(t,i),!0)},s.prototype.st=function(){return this.Ps},s.prototype.Gn=function(t){return this.Ls.close(t)},s.prototype.vt=function(){return null===this.Ys&&(this.Ys=this.I.getInitialMonth()),this.Ys},s.prototype.qn=function(){var t=new Date(this.vt().getTime());return t.setMonth(t.getMonth()-1),this.Xn(t)},s.prototype.Kn=function(){var t=new Date(this.vt().getTime());return t.setMonth(t.getMonth()+1),this.Xn(t)},s.prototype.Xn=function(t){return!!e.X.Ot(t)&&this.I.isMonthInValidity(t)},s.prototype.xs=function(t){var i=new Date(this.vt().getTime());return i.setMonth(i.getMonth()-1),this.dt(t,i)},s.prototype.Rs=function(t){var i=new Date(this.vt().getTime());return i.setMonth(i.getMonth()+1),this.dt(t,i)},s.prototype.dt=function(t,i,n){return void 0===n&&(n=!0),(i=e.X.Jt(new Date(i.getTime()))).setDate(1),!(i.getTime()===this.vt().getTime()||!this.Xn(i)||!this.zs(t,i,this.Ys)||(this.Ys=i,n&&this.Ns(t)||this.U(),this.Gs(t,i,this.Ys),0))},s.prototype.ht=function(t){var i=this.dt(t,this.I.getInitialMonth()),n=this.$(t);return i||n},s.prototype.ft=function(t,i,n,s,h){if(void 0===n&&(n=!0),void 0===s&&(s=!1),void 0===h&&(h=!1),null===i)return this.Dt(t);var r;if(i instanceof e.Day?i=(r=i).getDate():r=this._s(i),!r.isAvailable)return!1;if(r.isEqualToDate(this.at))return!(!h||!this.I.hasToggleSelection())&&this.Dt(t);var u=null!==this.at?this._s(this.at):null;return!!this.Bs(t,r,u)&&(this.at=r.getDate(),s&&this.Is(t,r),n&&this.dt(t,i)||this.U(),this.Zs(t,r,u),!0)},s.prototype.yt=function(t,i){return this.ft(t,this.I.findNearestAvailableDate(i))},s.prototype._=function(){try{return this.ft(null,this.I.findPossibleAvailableDate(this.at),!1)}catch(t){if(!(t instanceof e.AvailableDateNotFoundException))throw t;return this.Dt(null,!0)}},s.prototype.$=function(t){try{return this.ft(t,this.I.getInitialDate(),!1)}catch(t){if(!(t instanceof e.AvailableDateNotFoundException))throw t;return this.Dt(null,!0)}},s.prototype.Is=function(t,i,n,s){if(void 0===n&&(n=!1),void 0===s&&(s=!0),!i.isAvailable)return!1;if(i.isEqualToDay(this.$s))return!1;var h=this.$s;if(!this.qs(t,i,h))return!1;this.$s=i,s&&(this.Ks=!0);var r=i.getDate();return n&&this.dt(t,r,!1)||this.U(),this.Qs(t,i,h),!0},s.prototype.Vs=function(t){for(var i=new Date(this.vt().getTime()),n=this.I.in(),s=this._s(i);!(s.isAvailable||(i.setDate(s.dayNumber+1),1===i.getDate())||i.getTime()>n.getTime());)s=this._s(i);return this.Is(t,s)},s.prototype.Xs=function(t,i,n){var s=i,h=s.getDate(),r=1e3;do{if(h.setDate(s.dayNumber+n),!(s=this._s(h)).isInValidity)break;r--}while(!s.isAvailable&&0<r);return this.Is(t,s,!0)},s.prototype.Dt=function(t,i){if(void 0===i&&(i=!1),!this.I.isAllowedEmpty()&&!i)return!1;if(null===this.at)return!1;var n=this._s(this.at);return!!this.Bs(t,null,n)&&(this.at=null,this.U(),this.Zs(t,null,n),!0)},s.prototype.Ns=function(t){if(null===this.$s)return!1;var i=this.$s;return!!this.qs(t,null,i)&&(this.$s=null,this.U(),this.Qs(t,null,i),!0)},s.prototype.ws=function(){for(var t=[],i=0;i<7;i++)t.push((this.I.getFirstDayOfWeek()+i)%7);return t},s.prototype.Ts=function(){for(var t=[],i=this.vt(),n=new Date(i.getFullYear(),i.getMonth(),1),s=new Date(i.getFullYear(),i.getMonth(),0).getDate(),h=s-(n.getDay()-this.I.getFirstDayOfWeek()+7)%7+1;h<=s;h++)(o=this._s(new Date(i.getFullYear(),i.getMonth()-1,h))).isVisible=this.I.areDaysOutOfMonthVisible(),o.isInCurrentMonth=!1,t.push(o);var r=new Date(i.getFullYear(),i.getMonth()+1,0),u=r.getDate();for(h=1;h<=u;h++)t.push(this._s(new Date(i.getFullYear(),i.getMonth(),h)));var e=6-(r.getDay()-this.I.getFirstDayOfWeek()+7)%7;for(h=1;h<=e;h++)(o=this._s(new Date(i.getFullYear(),i.getMonth()+1,h))).isVisible=this.I.areDaysOutOfMonthVisible(),o.isInCurrentMonth=!1,t.push(o);if(this.I.hasFixedRowsCount())for(var o,f=1+e;t.length<42;f++)(o=this._s(new Date(i.getFullYear(),i.getMonth()+1,f))).isVisible=this.I.areDaysOutOfMonthVisible(),o.isInCurrentMonth=!1,t.push(o);for(var l=[],a=0;a<t.length;a+=7)l.push(t.slice(a,a+7));return l},s.prototype.xt=function(t){e.X.Lt([e.Ht.Left,e.Ht.Up,e.Ht.Right,e.Ht.Down],t.keyCode)&&(e.X.It(t),null!==this.$s?this.Xs(t,this.$s,this.th(t.keyCode)):null!==this.at&&this.at.getFullYear()===this.vt().getFullYear()&&this.at.getMonth()===this.vt().getMonth()?this.Xs(t,this._s(this.at),this.th(t.keyCode)):this.Vs(t))},s.prototype.Bs=function(i,n,s){var h=this;return this.I.ln(e.ui.BeforeSelect,function(t){return t.call(h.Ls,i,n,s)})},s.prototype.Zs=function(i,n,s){var h=this;this.I.ln(e.ui.Select,function(t){return t.call(h.Ls,i,n,s)})},s.prototype.Us=function(i,n){var s=this;return this.I.ln(e.ui.BeforeOpenAndClose,function(t){return t.call(s.Ls,i,n)})},s.prototype.Ws=function(i,n){var s=this;this.I.ln(e.ui.OpenAndClose,function(t){return t.call(s.Ls,i,n)})},s.prototype.zs=function(i,n,s){var h=this;return this.I.ln(e.ui.BeforeMonthChange,function(t){return t.call(h.Ls,i,n,s)})},s.prototype.Gs=function(i,n,s){var h=this;this.I.ln(e.ui.MonthChange,function(t){return t.call(h.Ls,i,n,s)})},s.prototype.qs=function(i,n,s){var h=this;return this.I.ln(e.ui.BeforeFocus,function(t){return t.call(h.Ls,i,n,s)})},s.prototype.Qs=function(i,n,s){var h=this;this.I.ln(e.ui.Focus,function(t){return t.call(h.Ls,i,n,s)})},s.prototype._s=function(t){t=e.X.Jt(new Date(t.getTime()));var i=this.I.getToday(),n=new e.Day(t);return n.isToday=t.getTime()===i.getTime(),n.isPast=t.getTime()<i.getTime(),n.isInValidity=this.I.isDateInValidity(t),n.isAvailable=n.isInValidity&&this.I.isDateAvailable(t),n.isAvailable&&(n.isEqualToDate(this.at)&&(n.isSelected=!0),n.isEqualToDay(this.$s)&&(n.isHighlighted=!0,this.Ks&&(n.isFocused=!0,this.Ks=!1))),this.I.modifyDay(n),n},s.prototype.th=function(t){switch(t){case e.Ht.Left:return i.Left;case e.Ht.Up:return i.Up;case e.Ht.Right:return i.Right;case e.Ht.Down:return i.Down;default:throw new Error("Invalid key code: "+t)}},s);function s(t,i){this.I=t,this.Ls=i,this.at=null,this.Ys=null,this.$s=null,this.Ks=!1,this.Ps=!1,this.Os=new e.Cs(this.I,new e.ri(this.I),i.container,null!==i.input)}e.jt=n}(TheDatepicker=TheDatepicker||{});

//papaparse

/* @license
Papa Parse
v5.3.0
https://github.com/mholt/PapaParse
License: MIT
*/
!function(e,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof module&&"undefined"!=typeof exports?module.exports=t():e.Papa=t()}(this,function s(){"use strict";var f="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==f?f:{};var n=!f.document&&!!f.postMessage,o=n&&/blob:/i.test((f.location||{}).protocol),a={},h=0,b={parse:function(e,t){var i=(t=t||{}).dynamicTyping||!1;U(i)&&(t.dynamicTypingFunction=i,i={});if(t.dynamicTyping=i,t.transform=!!U(t.transform)&&t.transform,t.worker&&b.WORKERS_SUPPORTED){var r=function(){if(!b.WORKERS_SUPPORTED)return!1;var e=(i=f.URL||f.webkitURL||null,r=s.toString(),b.BLOB_URL||(b.BLOB_URL=i.createObjectURL(new Blob(["(",r,")();"],{type:"text/javascript"})))),t=new f.Worker(e);var i,r;return t.onmessage=m,t.id=h++,a[t.id]=t}();return r.userStep=t.step,r.userChunk=t.chunk,r.userComplete=t.complete,r.userError=t.error,t.step=U(t.step),t.chunk=U(t.chunk),t.complete=U(t.complete),t.error=U(t.error),delete t.worker,void r.postMessage({input:e,config:t,workerId:r.id})}var n=null;b.NODE_STREAM_INPUT,"string"==typeof e?n=t.download?new l(t):new p(t):!0===e.readable&&U(e.read)&&U(e.on)?n=new g(t):(f.File&&e instanceof File||e instanceof Object)&&(n=new c(t));return n.stream(e)},unparse:function(e,t){var n=!1,m=!0,_=",",v="\r\n",s='"',a=s+s,i=!1,r=null,o=!1;!function(){if("object"!=typeof t)return;"string"!=typeof t.delimiter||b.BAD_DELIMITERS.filter(function(e){return-1!==t.delimiter.indexOf(e)}).length||(_=t.delimiter);("boolean"==typeof t.quotes||"function"==typeof t.quotes||Array.isArray(t.quotes))&&(n=t.quotes);"boolean"!=typeof t.skipEmptyLines&&"string"!=typeof t.skipEmptyLines||(i=t.skipEmptyLines);"string"==typeof t.newline&&(v=t.newline);"string"==typeof t.quoteChar&&(s=t.quoteChar);"boolean"==typeof t.header&&(m=t.header);if(Array.isArray(t.columns)){if(0===t.columns.length)throw new Error("Option columns is empty");r=t.columns}void 0!==t.escapeChar&&(a=t.escapeChar+s);"boolean"==typeof t.escapeFormulae&&(o=t.escapeFormulae)}();var h=new RegExp(q(s),"g");"string"==typeof e&&(e=JSON.parse(e));if(Array.isArray(e)){if(!e.length||Array.isArray(e[0]))return f(null,e,i);if("object"==typeof e[0])return f(r||u(e[0]),e,i)}else if("object"==typeof e)return"string"==typeof e.data&&(e.data=JSON.parse(e.data)),Array.isArray(e.data)&&(e.fields||(e.fields=e.meta&&e.meta.fields),e.fields||(e.fields=Array.isArray(e.data[0])?e.fields:u(e.data[0])),Array.isArray(e.data[0])||"object"==typeof e.data[0]||(e.data=[e.data])),f(e.fields||[],e.data||[],i);throw new Error("Unable to serialize unrecognized input");function u(e){if("object"!=typeof e)return[];var t=[];for(var i in e)t.push(i);return t}function f(e,t,i){var r="";"string"==typeof e&&(e=JSON.parse(e)),"string"==typeof t&&(t=JSON.parse(t));var n=Array.isArray(e)&&0<e.length,s=!Array.isArray(t[0]);if(n&&m){for(var a=0;a<e.length;a++)0<a&&(r+=_),r+=y(e[a],a);0<t.length&&(r+=v)}for(var o=0;o<t.length;o++){var h=n?e.length:t[o].length,u=!1,f=n?0===Object.keys(t[o]).length:0===t[o].length;if(i&&!n&&(u="greedy"===i?""===t[o].join("").trim():1===t[o].length&&0===t[o][0].length),"greedy"===i&&n){for(var d=[],l=0;l<h;l++){var c=s?e[l]:l;d.push(t[o][c])}u=""===d.join("").trim()}if(!u){for(var p=0;p<h;p++){0<p&&!f&&(r+=_);var g=n&&s?e[p]:p;r+=y(t[o][g],p)}o<t.length-1&&(!i||0<h&&!f)&&(r+=v)}}return r}function y(e,t){if(null==e)return"";if(e.constructor===Date)return JSON.stringify(e).slice(1,25);!0===o&&"string"==typeof e&&null!==e.match(/^[=+\-@].*$/)&&(e="'"+e);var i=e.toString().replace(h,a),r="boolean"==typeof n&&n||"function"==typeof n&&n(e,t)||Array.isArray(n)&&n[t]||function(e,t){for(var i=0;i<t.length;i++)if(-1<e.indexOf(t[i]))return!0;return!1}(i,b.BAD_DELIMITERS)||-1<i.indexOf(_)||" "===i.charAt(0)||" "===i.charAt(i.length-1);return r?s+i+s:i}}};if(b.RECORD_SEP=String.fromCharCode(30),b.UNIT_SEP=String.fromCharCode(31),b.BYTE_ORDER_MARK="\ufeff",b.BAD_DELIMITERS=["\r","\n",'"',b.BYTE_ORDER_MARK],b.WORKERS_SUPPORTED=!n&&!!f.Worker,b.NODE_STREAM_INPUT=1,b.LocalChunkSize=10485760,b.RemoteChunkSize=5242880,b.DefaultDelimiter=",",b.Parser=w,b.ParserHandle=i,b.NetworkStreamer=l,b.FileStreamer=c,b.StringStreamer=p,b.ReadableStreamStreamer=g,f.jQuery){var d=f.jQuery;d.fn.parse=function(o){var i=o.config||{},h=[];return this.each(function(e){if(!("INPUT"===d(this).prop("tagName").toUpperCase()&&"file"===d(this).attr("type").toLowerCase()&&f.FileReader)||!this.files||0===this.files.length)return!0;for(var t=0;t<this.files.length;t++)h.push({file:this.files[t],inputElem:this,instanceConfig:d.extend({},i)})}),e(),this;function e(){if(0!==h.length){var e,t,i,r,n=h[0];if(U(o.before)){var s=o.before(n.file,n.inputElem);if("object"==typeof s){if("abort"===s.action)return e="AbortError",t=n.file,i=n.inputElem,r=s.reason,void(U(o.error)&&o.error({name:e},t,i,r));if("skip"===s.action)return void u();"object"==typeof s.config&&(n.instanceConfig=d.extend(n.instanceConfig,s.config))}else if("skip"===s)return void u()}var a=n.instanceConfig.complete;n.instanceConfig.complete=function(e){U(a)&&a(e,n.file,n.inputElem),u()},b.parse(n.file,n.instanceConfig)}else U(o.complete)&&o.complete()}function u(){h.splice(0,1),e()}}}function u(e){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(e){var t=E(e);t.chunkSize=parseInt(t.chunkSize),e.step||e.chunk||(t.chunkSize=null);this._handle=new i(t),(this._handle.streamer=this)._config=t}.call(this,e),this.parseChunk=function(e,t){if(this.isFirstChunk&&U(this._config.beforeFirstChunk)){var i=this._config.beforeFirstChunk(e);void 0!==i&&(e=i)}this.isFirstChunk=!1,this._halted=!1;var r=this._partialLine+e;this._partialLine="";var n=this._handle.parse(r,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var s=n.meta.cursor;this._finished||(this._partialLine=r.substring(s-this._baseIndex),this._baseIndex=s),n&&n.data&&(this._rowCount+=n.data.length);var a=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(o)f.postMessage({results:n,workerId:b.WORKER_ID,finished:a});else if(U(this._config.chunk)&&!t){if(this._config.chunk(n,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);n=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(n.data),this._completeResults.errors=this._completeResults.errors.concat(n.errors),this._completeResults.meta=n.meta),this._completed||!a||!U(this._config.complete)||n&&n.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),a||n&&n.meta.paused||this._nextChunk(),n}this._halted=!0},this._sendError=function(e){U(this._config.error)?this._config.error(e):o&&this._config.error&&f.postMessage({workerId:b.WORKER_ID,error:e,finished:!1})}}function l(e){var r;(e=e||{}).chunkSize||(e.chunkSize=b.RemoteChunkSize),u.call(this,e),this._nextChunk=n?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(e){this._input=e,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(r=new XMLHttpRequest,this._config.withCredentials&&(r.withCredentials=this._config.withCredentials),n||(r.onload=y(this._chunkLoaded,this),r.onerror=y(this._chunkError,this)),r.open(this._config.downloadRequestBody?"POST":"GET",this._input,!n),this._config.downloadRequestHeaders){var e=this._config.downloadRequestHeaders;for(var t in e)r.setRequestHeader(t,e[t])}if(this._config.chunkSize){var i=this._start+this._config.chunkSize-1;r.setRequestHeader("Range","bytes="+this._start+"-"+i)}try{r.send(this._config.downloadRequestBody)}catch(e){this._chunkError(e.message)}n&&0===r.status&&this._chunkError()}},this._chunkLoaded=function(){4===r.readyState&&(r.status<200||400<=r.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:r.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(e){var t=e.getResponseHeader("Content-Range");if(null===t)return-1;return parseInt(t.substring(t.lastIndexOf("/")+1))}(r),this.parseChunk(r.responseText)))},this._chunkError=function(e){var t=r.statusText||e;this._sendError(new Error(t))}}function c(e){var r,n;(e=e||{}).chunkSize||(e.chunkSize=b.LocalChunkSize),u.call(this,e);var s="undefined"!=typeof FileReader;this.stream=function(e){this._input=e,n=e.slice||e.webkitSlice||e.mozSlice,s?((r=new FileReader).onload=y(this._chunkLoaded,this),r.onerror=y(this._chunkError,this)):r=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var e=this._input;if(this._config.chunkSize){var t=Math.min(this._start+this._config.chunkSize,this._input.size);e=n.call(e,this._start,t)}var i=r.readAsText(e,this._config.encoding);s||this._chunkLoaded({target:{result:i}})},this._chunkLoaded=function(e){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(e.target.result)},this._chunkError=function(){this._sendError(r.error)}}function p(e){var i;u.call(this,e=e||{}),this.stream=function(e){return i=e,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var e,t=this._config.chunkSize;return t?(e=i.substring(0,t),i=i.substring(t)):(e=i,i=""),this._finished=!i,this.parseChunk(e)}}}function g(e){u.call(this,e=e||{});var t=[],i=!0,r=!1;this.pause=function(){u.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){u.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(e){this._input=e,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){r&&1===t.length&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),t.length?this.parseChunk(t.shift()):i=!0},this._streamData=y(function(e){try{t.push("string"==typeof e?e:e.toString(this._config.encoding)),i&&(i=!1,this._checkIsFinished(),this.parseChunk(t.shift()))}catch(e){this._streamError(e)}},this),this._streamError=y(function(e){this._streamCleanUp(),this._sendError(e)},this),this._streamEnd=y(function(){this._streamCleanUp(),r=!0,this._streamData("")},this),this._streamCleanUp=y(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function i(_){var a,o,h,r=Math.pow(2,53),n=-r,s=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)(e[-+]?\d+)?\s*$/,u=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/,t=this,i=0,f=0,d=!1,e=!1,l=[],c={data:[],errors:[],meta:{}};if(U(_.step)){var p=_.step;_.step=function(e){if(c=e,m())g();else{if(g(),0===c.data.length)return;i+=e.data.length,_.preview&&i>_.preview?o.abort():(c.data=c.data[0],p(c,t))}}}function v(e){return"greedy"===_.skipEmptyLines?""===e.join("").trim():1===e.length&&0===e[0].length}function g(){if(c&&h&&(k("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+b.DefaultDelimiter+"'"),h=!1),_.skipEmptyLines)for(var e=0;e<c.data.length;e++)v(c.data[e])&&c.data.splice(e--,1);return m()&&function(){if(!c)return;function e(e,t){U(_.transformHeader)&&(e=_.transformHeader(e,t)),l.push(e)}if(Array.isArray(c.data[0])){for(var t=0;m()&&t<c.data.length;t++)c.data[t].forEach(e);c.data.splice(0,1)}else c.data.forEach(e)}(),function(){if(!c||!_.header&&!_.dynamicTyping&&!_.transform)return c;function e(e,t){var i,r=_.header?{}:[];for(i=0;i<e.length;i++){var n=i,s=e[i];_.header&&(n=i>=l.length?"__parsed_extra":l[i]),_.transform&&(s=_.transform(s,n)),s=y(n,s),"__parsed_extra"===n?(r[n]=r[n]||[],r[n].push(s)):r[n]=s}return _.header&&(i>l.length?k("FieldMismatch","TooManyFields","Too many fields: expected "+l.length+" fields but parsed "+i,f+t):i<l.length&&k("FieldMismatch","TooFewFields","Too few fields: expected "+l.length+" fields but parsed "+i,f+t)),r}var t=1;!c.data.length||Array.isArray(c.data[0])?(c.data=c.data.map(e),t=c.data.length):c.data=e(c.data,0);_.header&&c.meta&&(c.meta.fields=l);return f+=t,c}()}function m(){return _.header&&0===l.length}function y(e,t){return i=e,_.dynamicTypingFunction&&void 0===_.dynamicTyping[i]&&(_.dynamicTyping[i]=_.dynamicTypingFunction(i)),!0===(_.dynamicTyping[i]||_.dynamicTyping)?"true"===t||"TRUE"===t||"false"!==t&&"FALSE"!==t&&(function(e){if(s.test(e)){var t=parseFloat(e);if(n<t&&t<r)return!0}return!1}(t)?parseFloat(t):u.test(t)?new Date(t):""===t?null:t):t;var i}function k(e,t,i,r){var n={type:e,code:t,message:i};void 0!==r&&(n.row=r),c.errors.push(n)}this.parse=function(e,t,i){var r=_.quoteChar||'"';if(_.newline||(_.newline=function(e,t){e=e.substring(0,1048576);var i=new RegExp(q(t)+"([^]*?)"+q(t),"gm"),r=(e=e.replace(i,"")).split("\r"),n=e.split("\n"),s=1<n.length&&n[0].length<r[0].length;if(1===r.length||s)return"\n";for(var a=0,o=0;o<r.length;o++)"\n"===r[o][0]&&a++;return a>=r.length/2?"\r\n":"\r"}(e,r)),h=!1,_.delimiter)U(_.delimiter)&&(_.delimiter=_.delimiter(e),c.meta.delimiter=_.delimiter);else{var n=function(e,t,i,r,n){var s,a,o,h;n=n||[",","\t","|",";",b.RECORD_SEP,b.UNIT_SEP];for(var u=0;u<n.length;u++){var f=n[u],d=0,l=0,c=0;o=void 0;for(var p=new w({comments:r,delimiter:f,newline:t,preview:10}).parse(e),g=0;g<p.data.length;g++)if(i&&v(p.data[g]))c++;else{var m=p.data[g].length;l+=m,void 0!==o?0<m&&(d+=Math.abs(m-o),o=m):o=m}0<p.data.length&&(l/=p.data.length-c),(void 0===a||d<=a)&&(void 0===h||h<l)&&1.99<l&&(a=d,s=f,h=l)}return{successful:!!(_.delimiter=s),bestDelimiter:s}}(e,_.newline,_.skipEmptyLines,_.comments,_.delimitersToGuess);n.successful?_.delimiter=n.bestDelimiter:(h=!0,_.delimiter=b.DefaultDelimiter),c.meta.delimiter=_.delimiter}var s=E(_);return _.preview&&_.header&&s.preview++,a=e,o=new w(s),c=o.parse(a,t,i),g(),d?{meta:{paused:!0}}:c||{meta:{paused:!1}}},this.paused=function(){return d},this.pause=function(){d=!0,o.abort(),a=U(_.chunk)?"":a.substring(o.getCharIndex())},this.resume=function(){t.streamer._halted?(d=!1,t.streamer.parseChunk(a,!0)):setTimeout(t.resume,3)},this.aborted=function(){return e},this.abort=function(){e=!0,o.abort(),c.meta.aborted=!0,U(_.complete)&&_.complete(c),a=""}}function q(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function w(e){var O,D=(e=e||{}).delimiter,I=e.newline,T=e.comments,A=e.step,L=e.preview,F=e.fastMode,z=O=void 0===e.quoteChar?'"':e.quoteChar;if(void 0!==e.escapeChar&&(z=e.escapeChar),("string"!=typeof D||-1<b.BAD_DELIMITERS.indexOf(D))&&(D=","),T===D)throw new Error("Comment character same as delimiter");!0===T?T="#":("string"!=typeof T||-1<b.BAD_DELIMITERS.indexOf(T))&&(T=!1),"\n"!==I&&"\r"!==I&&"\r\n"!==I&&(I="\n");var M=0,j=!1;this.parse=function(a,t,i){if("string"!=typeof a)throw new Error("Input must be a string");var r=a.length,e=D.length,n=I.length,s=T.length,o=U(A),h=[],u=[],f=[],d=M=0;if(!a)return R();if(F||!1!==F&&-1===a.indexOf(O)){for(var l=a.split(I),c=0;c<l.length;c++){if(f=l[c],M+=f.length,c!==l.length-1)M+=I.length;else if(i)return R();if(!T||f.substring(0,s)!==T){if(o){if(h=[],b(f.split(D)),S(),j)return R()}else b(f.split(D));if(L&&L<=c)return h=h.slice(0,L),R(!0)}}return R()}for(var p=a.indexOf(D,M),g=a.indexOf(I,M),m=new RegExp(q(z)+q(O),"g"),_=a.indexOf(O,M);;)if(a[M]!==O)if(T&&0===f.length&&a.substring(M,M+s)===T){if(-1===g)return R();M=g+n,g=a.indexOf(I,M),p=a.indexOf(D,M)}else{if(-1!==p&&(p<g||-1===g)){if(!(p<_)){f.push(a.substring(M,p)),M=p+e,p=a.indexOf(D,M);continue}var v=x(p,_,g);if(v&&void 0!==v.nextDelim){p=v.nextDelim,_=v.quoteSearch,f.push(a.substring(M,p)),M=p+e,p=a.indexOf(D,M);continue}}if(-1===g)break;if(f.push(a.substring(M,g)),C(g+n),o&&(S(),j))return R();if(L&&h.length>=L)return R(!0)}else for(_=M,M++;;){if(-1===(_=a.indexOf(O,_+1)))return i||u.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:h.length,index:M}),E();if(_===r-1)return E(a.substring(M,_).replace(m,O));if(O!==z||a[_+1]!==z){if(O===z||0===_||a[_-1]!==z){-1!==p&&p<_+1&&(p=a.indexOf(D,_+1)),-1!==g&&g<_+1&&(g=a.indexOf(I,_+1));var y=w(-1===g?p:Math.min(p,g));if(a[_+1+y]===D){f.push(a.substring(M,_).replace(m,O)),a[M=_+1+y+e]!==O&&(_=a.indexOf(O,M)),p=a.indexOf(D,M),g=a.indexOf(I,M);break}var k=w(g);if(a.substring(_+1+k,_+1+k+n)===I){if(f.push(a.substring(M,_).replace(m,O)),C(_+1+k+n),p=a.indexOf(D,M),_=a.indexOf(O,M),o&&(S(),j))return R();if(L&&h.length>=L)return R(!0);break}u.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:h.length,index:M}),_++}}else _++}return E();function b(e){h.push(e),d=M}function w(e){var t=0;if(-1!==e){var i=a.substring(_+1,e);i&&""===i.trim()&&(t=i.length)}return t}function E(e){return i||(void 0===e&&(e=a.substring(M)),f.push(e),M=r,b(f),o&&S()),R()}function C(e){M=e,b(f),f=[],g=a.indexOf(I,M)}function R(e){return{data:h,errors:u,meta:{delimiter:D,linebreak:I,aborted:j,truncated:!!e,cursor:d+(t||0)}}}function S(){A(R()),h=[],u=[]}function x(e,t,i){var r={nextDelim:void 0,quoteSearch:void 0},n=a.indexOf(O,t+1);if(t<e&&e<n&&(n<i||-1===i)){var s=a.indexOf(D,n);if(-1===s)return r;n<s&&(n=a.indexOf(O,n+1)),r=x(s,n,i)}else r={nextDelim:e,quoteSearch:t};return r}},this.abort=function(){j=!0},this.getCharIndex=function(){return M}}function m(e){var t=e.data,i=a[t.workerId],r=!1;if(t.error)i.userError(t.error,t.file);else if(t.results&&t.results.data){var n={abort:function(){r=!0,_(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:v,resume:v};if(U(i.userStep)){for(var s=0;s<t.results.data.length&&(i.userStep({data:t.results.data[s],errors:t.results.errors,meta:t.results.meta},n),!r);s++);delete t.results}else U(i.userChunk)&&(i.userChunk(t.results,n,t.file),delete t.results)}t.finished&&!r&&_(t.workerId,t.results)}function _(e,t){var i=a[e];U(i.userComplete)&&i.userComplete(t),i.terminate(),delete a[e]}function v(){throw new Error("Not implemented.")}function E(e){if("object"!=typeof e||null===e)return e;var t=Array.isArray(e)?[]:{};for(var i in e)t[i]=E(e[i]);return t}function y(e,t){return function(){e.apply(t,arguments)}}function U(e){return"function"==typeof e}return o&&(f.onmessage=function(e){var t=e.data;void 0===b.WORKER_ID&&t&&(b.WORKER_ID=t.workerId);if("string"==typeof t.input)f.postMessage({workerId:b.WORKER_ID,results:b.parse(t.input,t.config),finished:!0});else if(f.File&&t.input instanceof File||t.input instanceof Object){var i=b.parse(t.input,t.config);i&&f.postMessage({workerId:b.WORKER_ID,results:i,finished:!0})}}),(l.prototype=Object.create(u.prototype)).constructor=l,(c.prototype=Object.create(u.prototype)).constructor=c,(p.prototype=Object.create(p.prototype)).constructor=p,
(g.prototype=Object.create(u.prototype)).constructor=g,b});

//on load functions

window.onload =  function(){


       
       createTable();
       
       createBlockTable();

       
       //addblocks();
       addLeads();
       addClients();
       addtasks();
       addnames();
       addRKs();
       //getTasks();
 
       gettoday();
       dPicker();
       getotherdata();


       document.getElementById("checkHide").checked=false;
       hideThis();
       

document.getElementById("empTable").addEventListener("change", function(){
    calculateprorate();
    calculateplanting();
    sumtable();
    calcremha();
    settabledata();
 
  });


  document.getElementById("disk_c").value= checkStorage();
       if (confirm("Open Previously Saved Table?")) {
         gettabledata();
       }

    
    };


    window.onbeforeunload = function(){


    };


//parse csv and create table

  var openFile = function(event){

    
    var input = event.target;

    var reader = new FileReader();
    reader.onload = function(){
      var text = reader.result;

//var arrdata= Papa.parse(data).data

var results = Papa.parse(text, {
   header: true,
   dynamicTyping: true,
	delimiter: "",// auto-detect
	newline: "",	// auto-detect
	

});

var blockObj= results.data;

for(x in blockObj){
  //alert(blockObj[x].BlockHa)
  blockObj[x].RemHa= blockObj[x].BlockHa;
   //alert(JSON.stringify(blockObj[x]))
}


localStorage.setItem('blocklist',JSON.stringify(blockObj));
//var storage= JSON.parse(localStorage.getItem('blocklist'));

createBlockTable();

      console.log(reader.result.substring(0, 200));
    };
    reader.readAsText(input.files[0]);
  };

function createBlockTable(){


var blockstorage= JSON.parse(localStorage.getItem('blocklist'));
  var obj=blockstorage;



//let header = Object.keys(obj[0]);

let header=['Block','BlockHa','Price','RemHa'];
let myTable=document.getElementById("BlockTable")
  myTable.deleteTHead();

var thead = myTable.createTHead(0);



   let row = thead.insertRow();
   let th = document.createElement("th");
     th.setAttribute('class','sticky')
   let button = document.createElement("button");
     button.setAttribute('id','DeleteBlocks');
     button.style= "background-color: rgb(255,200,200)" 
     button.setAttribute('onclick','deleteRows(document.getElementById("BlockTable"))');
     button.textContent='Delete'+'\n'+'Selected';
     th.appendChild(button);
     row.appendChild(th);

for(let key of header){
//alert(key)

     th= document.createElement("th");
     th.setAttribute('class','sticky');
     let text = document.createTextNode(key);
     
       let input = document.createElement("input");
       input.id= key;
     

     if(key=='Block'){
       input.setAttribute('placeholder','filter/add '+ key)
       input.setAttribute('onkeyup','blockFilter(event)')
       input.setAttribute('class','full');
     }else{
         input.setAttribute('placeholder','add '+ key);
         input.setAttribute('class','full');
         input.setAttribute('type','number');
     }
     if(key=='BlockHa'){
       input.setAttribute('onkeyup','fillRemHa(event)')
     }
     
     th.appendChild(text);
     th.appendChild(input);
     row.appendChild(th);

   }
   
   /*th = document.createElement('th');
   th.setAttribute('class','sticky');
   text = document.createTextNode('RemHa');
   th.appendChild(text);
   row.appendChild(th);*/

   th = document.createElement('th');
   th.setAttribute('class','sticky');
   text = document.createTextNode('DailyHa');
   th.appendChild(text);
   row.appendChild(th);

   th = document.createElement('th');
   th.setAttribute('class','sticky');
   text = document.createTextNode('DailyHrs');
   th.appendChild(text);
   row.appendChild(th);

   th = document.createElement('th');
   th.setAttribute('class','sticky');
   button = document.createElement('button');
   button.setAttribute('id','AddNewBlock');
   button.setAttribute('onclick','addBlockRow(event)')
   button.style= "background-color: rgb(200,255,200)" 
   button.textContent='Add Block';
   th.appendChild(button);
   row.appendChild(th);

  
   

let tbody = document.createElement('tbody');
//tbody.setAttribute('onmouseout','sumHours()');



    for (var i = 0; i < obj.length; i++) {
    let element = (obj[i]);


    //var tbody = document.getElementById('tbody');

       let row = tbody.insertRow();
       let cell = row.insertCell();

       let check = document.createElement("input");
         check.setAttribute('type','checkbox')
         check.setAttribute('id','CheckBlock'+i);
         check.setAttribute('onclick','highlightRow(event.target)')
         cell.appendChild(check);
         //row.appendChild(td);

       
        
       

  //for (let element of obj) {
    //let row = table.insertRow();
    for (key of header) {
        let cell = row.insertCell();
        let input = document.createElement('input');

        if(key=='Block'){
          input.setAttribute('type','text')
        }else{
          input.setAttribute('type','number');
        }
        
        if(key=='RemHa'){
          input.setAttribute('readonly','true');
          input.style.backgroundColor= "rgb(220,220,220)";
          input.setAttribute('type','number');
        }
        cell.appendChild(input);
        input.setAttribute('class','full');
        input.value=(element[key]);
        
      
     }
        /*cell=row.insertCell();
        input=document.createElement("input");
        input.setAttribute('id','RemHa'+i)
        input.setAttribute('readonly','true');
        input.setAttribute('class','full');
        //input.value= element[BlockHa]
        input.style.backgroundColor= "rgb(220,220,220)";
        
        cell.appendChild(input);*/
   
        cell=row.insertCell();

        input= document.createElement("input");
        input.setAttribute('id','DailyHa'+i);
        input.setAttribute('class','full');
        input.setAttribute('type','number');
        //input.setAttribute('onblur','sumHours()');
        cell.appendChild(input);

        cell = row.insertCell();

        input= document.createElement("input");
        input.setAttribute('id','DailyHrs'+i);
        input.setAttribute('class','full');
        input.setAttribute('type','number');
        input.setAttribute('onkeyup','sumHours()');
        input.setAttribute('onchange','sumHours()');
        
        cell.appendChild(input);

        cell = row.insertCell();

       let lblCheck2= document.createElement("label");
         lblCheck2.textContent='Complete';
         lblCheck2.setAttribute('style','font-size: 0.7em;');

       let check2 = document.createElement("input");
         check2.setAttribute('type','checkbox')
         check2.setAttribute('id','BlockDone'+i);
         check2.setAttribute('onclick','selectDone(event.target)');
        
        cell.appendChild(check2);
        cell.appendChild(lblCheck2);
        
  
    }
    document.getElementById("BlockTable").prepend(tbody);

    const blockTable = document.getElementById('BlockTable');

      blockTable.querySelectorAll('tbody').forEach((tbody, i) => {
        if (i !== 0) {
        blockTable.removeChild(tbody);
      }
});


 
}

//check if hours are block based and sum

function sumHours(){
 
  let BlockTable= document.getElementById("BlockTable")
  let tr= BlockTable.getElementsByTagName("tr");
  let length = BlockTable.rows.length;
  let arrblock=[];
  let arrhr=[];
           
        for (i=0;i<length; i++){
         
          let check= BlockTable.rows[i].getElementsByTagName("input")[0];
          let blk= BlockTable.rows[i].getElementsByTagName("input")[1];
          let hr= BlockTable.rows[i].getElementsByTagName("input")[6];
          

          if (check.checked==true){
            arrblock.push(blk.value);
            arrhr.push(Number(hr.value));

          }
       
        }
        
        let sumhrs=arrhr.reduce(function(a,b){return(a+b)});
          if(Number(sumhrs)>0){
            document.getElementById("Hours").value= sumhrs;
            document.getElementById("Hours").readOnly=true;
          }else{
            document.getElementById("Hours").readOnly=false;
            document.getElementById("Hours").value= "";
          }
        

}
// make sure ha filled out
function checkHa(){

let BlockTable= document.getElementById("BlockTable")
  let tr= BlockTable.getElementsByTagName("tr");
  let length = BlockTable.rows.length;
  let arrblock=[];
  let arrblockha=[];
  let arrprice=[];
  let arrha=[];
  let arrhr=[];

           
  for (i=0;i<length; i++){
         
  let check= BlockTable.rows[i].getElementsByTagName("input")[0];
  let blk= BlockTable.rows[i].getElementsByTagName("input")[1];
  let blkha= BlockTable.rows[i].getElementsByTagName("input")[2];
  let haprice= BlockTable.rows[i].getElementsByTagName("input")[3];
  let remha= BlockTable.rows[i].getElementsByTagName("input")[4];
  let ha= BlockTable.rows[i].getElementsByTagName("input")[5];
  let hr= BlockTable.rows[i].getElementsByTagName("input")[6];
  let piecerate= document.getElementById("PieceRate").checked;
  let task= document.getElementById("Task").value;


     if(check.checked==true){

       if(task.toUpperCase().indexOf("BRUSHING") > -1 && piecerate == true && Number(haprice.value)==0 && Number(blkha.value)>0){
         alert("Please enter a price/ha");
         haprice.focus();
         return false
       }else{

         if(Number(ha.value)>Number(remha.value)){
           alert("You have entered too many ha. There are " + remha.value + " ha remaining.");
           ha.value="";
           ha.focus();
           return false;
         }else{

            arrblock.push(blk.value);
            if(Number(blkha.value)>0){
              arrblockha.push(blkha.value);
            }
            if(Number(haprice.value)>0){
              arrprice.push(Number(haprice.value));
            }

            if(Number(ha.value)>0){
              arrha.push(Number(ha.value));
            }
            if(Number(hr.value)>0){
              arrhr.push(Number(hr.value));
            }
         }
       }
     }
  }

//return (arrha.length,arrblock.length)

      if(arrblock.length==0){
        alert("Please select at least 1 block");
        BlockTable.rows[1].getElementsByTagName("input")[0].focus();
        return false;
      }else{

        if(arrha.length<arrblockha.length){
          alert("Please fill out ha for each block selected");
          BlockTable.rows[1].getElementsByTagName("input")[5].focus();
          return false;
        }
        if(arrhr.length>0 && arrhr.length<arrblock.length){
          
          alert("Please fill out hours for each block selected");
          BlockTable.rows[1].getElementsByTagName("input")[6].focus;
          return false;

        /*}else{ 
          if(arrhr.length>0){
            document.getElementById("Hours").value= arrhr.reduce(function(a,b){return(a+b)});
            document.getElementById("Hours").readonly=true;
          }else{
            document.getElementById("Hours").readonly=false;
            document.getElementById("Hours").value= "";
          }*/
          return true;
        }
      }
      
}

//check piecerate planting

function checkPlanting(){


  let task= document.getElementById("Task").value;
  let piecerate= document.getElementById("PieceRate").checked;
  let divPrice= document.getElementById("div$_Unit");
  let divTrees= document.getElementById("divTrees");
  let divCones= document.getElementById("divCones");
  let trees= divTrees.getElementsByTagName("input");
  let cones= divCones.getElementsByTagName("input");
  let price= divPrice.getElementsByTagName("input");
  let ind= document.getElementById("Individual");


  if(task.toUpperCase().indexOf("PLANTING") > -1 && task.toUpperCase().indexOf("QUALITY") == -1 && task.toUpperCase().indexOf("SUPERVISION") == -1 && ind.checked==false){
    //const isAboveZero = (currentValue) => currentValue > 0;
    const array1 = Array.from(trees);
    const array2 = Array.from(cones);
    if(array1==""){
        alert("Please select an item");
        document.getElementById("RK").focus();
        return false
    }

    for(t=0; t< array1.length; t++){
      if((Number(array1[t].value) + Number(array2[t].value))==0){
      alert("Please enter trees or cones for each item");
      array1[t].focus()
      return false
      
      }
    }


  }

if(task.toUpperCase().indexOf("BROWSE") > -1 && ind.checked==false){
    //const isAboveZero = (currentValue) => currentValue > 0;
    const array2 = Array.from(cones);

    if(array2==""){
      alert("Please select an item");
      document.getElementById("RK").focus();
      return false
    }

    for(c=0; c< array2.length; c++){
      if(Number(array2[c].value)==0){
      alert("Please enter cones for each item");
      array2[c].focus()
      return false
      
      }
    }


  }
  


  
  if((task.toUpperCase().indexOf("PLANTING") > -1 || task.toUpperCase().indexOf("BROWSE") > -1) && task.toUpperCase().indexOf("QUALITY") == -1 && task.toUpperCase().indexOf("SUPERVISION") == -1 && piecerate == true){


    //const isAboveZero = (currentValue) => currentValue > 0;

    const array3 = Array.from(price);
    

    if(array3==""){
      alert("Please select an item");
      document.getElementById("RK").focus();
      return false
    }

    
    for(p=0; p< array3.length; p++){
      if(Number(array3[p].value)==0){
      alert("Please enter a price/unit for each item");
      array3[p].focus()
      return false
      
      }
    }
  }
}



//highlight row
function highlightRow(x){

  var y= x.parentNode.parentNode;

  var input= y.getElementsByTagName('input');

  //let checked= x.checked;


  for (i=0; i< y.getElementsByTagName('input').length; i++){
    
    if(x.checked==true){
      input[i].style.backgroundColor="rgb(255,255,200)";
    }else{
      if(input[i].readOnly==true){
        input[i].style.backgroundColor= "rgb(220,220,220)";
      }else{
        input[i].style.backgroundColor="";
          
      }
    }
  }

  if(x.parentNode.parentNode.parentNode.parentNode.id=="BlockTable"){

  let BlockTable= document.getElementById("BlockTable");
  let rows= BlockTable.rows;
  
  for(j=1; j< BlockTable.rows.length; j++){
   
   
   let row = BlockTable.rows[j];

   let check= BlockTable.rows[j].getElementsByTagName("input")[0];
   let ha= BlockTable.rows[j].getElementsByTagName("input")[5];
   let hr= BlockTable.rows[j].getElementsByTagName("input")[6];
   let comp= BlockTable.rows[j].getElementsByTagName("input")[7];
   
    if (check.checked==false){
      document.getElementById("Hours").value-=Number(hr.value);
      if(document.getElementById("Hours").value==0){
        document.getElementById("Hours").value="";
        document.getElementById("Hours").readOnly=false;
      }
      ha.value="";
      hr.value="";
      comp.checked=false;
    
    }else{
      //row.parentNode.removeChild(row);
      row.parentNode.insertBefore(row,rows[1]);
      check.focus()
      
      //row.style.display="";
    //}else{
      //row.style.display="none";
    }
  }
  }
  /*for(k=1; k< BlockTable.rows.length; k++){
  let check2= BlockTable.rows[k].getElementsByTagName("input")[0];
  let ha= BlockTable.rows[k].getElementsByTagName("input")[5];
  let hr= BlockTable.rows[k].getElementsByTagName("input")[6];
  let comp= BlockTable.rows[k].getElementsByTagName("input")[7];

    if(check2.checked==false){
      document.getElementById("Hours").value-=Number(ha.value);
      ha.value="";
      hr.value="";
      comp.checked==false;
      
      
      
    }
  }*/

}

//check done block

function selectDone(x){

//alert(x.checked)

  const myRem= x.parentNode.parentNode.getElementsByTagName("input")[4].value;
  const myDone= x.parentNode.parentNode.getElementsByTagName("input")[5].value;

  if(x.checked==true){

    x.parentNode.parentNode.getElementsByTagName("input")[5].value=Number(myRem)
    //x.parentNode.parentNode.getElementsByTagName("input")[4].value="";

  }else{
    x.parentNode.parentNode.getElementsByTagName("input")[5].value="";
x.parentNode.parentNode.getElementsByTagName("input")[4].value=myRem
    
  }
  
}

//delete selected rows

function deleteRows(table){



  if (confirm("Confirm Delete?")) {
  
   for(j=1; j<table.rows.length; j++){
   
     let rows= table.rows;
     let row = table.rows[j];

     let check= table.rows[j].getElementsByTagName("input")[0]
     

      if (check.checked==true){

        if (table.id=="empTable"){
          let BlockTable= document.getElementById("BlockTable");
          let block1= table.rows[j].getElementsByTagName("input")[3];
          let daily1= table.rows[j].getElementsByTagName("input")[10];
          for(b=1; b<BlockTable.rows.length; b++){
            let block2= BlockTable.rows[b].getElementsByTagName("input")[1];
            //let rem2= BlockTable.rows[b].getElementsByTagName("input")[4];

            
            if (block2.value==block1.value){

              BlockTable.rows[b].getElementsByTagName("input")[4].value= Number(BlockTable.rows[b].getElementsByTagName("input")[4].value)+ Number(daily1.value);
               
            }
          }
          
          

        }
        row.parentNode.removeChild(row);
        j--
      }
      
    if(document.getElementById("SelectAll").checked==true){
      document.getElementById("SelectAll").checked=false;
    }
      calcremha();
    }
    
    if (table.id=="empTable"){
      if(table.rows.length>1){
        calcremha();
    
        calculateprorate();
        calculateplanting();
        sumtable();
        
      }
    settabledata();
    }

    saveBlockList();

    
  }

}


//block filter

function blockFilter() {



var input1, filter1, table, tr, td1, i, txtValue1, txtValue2;
  

var table = document.getElementById("BlockTable");
var tbody= table.getElementsByTagName("tbody")[0];

  tr = tbody.getElementsByTagName("tr");
  input1 = document.getElementById("Block").value;
  filter1 = input1.toUpperCase();
 
   
  for (i = 0; i < tr.length; i++) {

  td1 = tr[i].getElementsByTagName("input")[1];

    if (td1){
      txtValue1 = td1.value;
      
      if (txtValue1.toUpperCase().indexOf(filter1) > -1 || tr[i].getElementsByTagName("input")[0].checked==true){
        tr[i].style.display = "";
      } else {
        tr[i].style.display = "none";
      }
    }
  }
  //sumtable();
}

function fillRemHa(){

//alert(event.target.parentNode.parentNode.getElementsByTagName("input")[4])
  event.target.parentNode.parentNode.getElementsByTagName("input")[3].value=event.target.parentNode.parentNode.getElementsByTagName("input")[1].value
}

//add block row
function addBlockRow(event){

  let myTable= document.getElementById("BlockTable");

  let tbody = myTable.getElementsByTagName('tbody')[0];
  
  var rows= myTable.rows.length;


       let row = tbody.insertRow(0);
       let cell = row.insertCell();

       let check = document.createElement("input");
         check.setAttribute('type','checkbox')
         check.setAttribute('id','CheckBlock' + rows);
         check.setAttribute('onclick','highlightRow(event.target)')
         cell.appendChild(check);
        
        cell=row.insertCell();
        input=document.createElement("input");
        input.setAttribute('id','Block'+rows)
        input.setAttribute('type','text')
        input.setAttribute('class','full');
        input.value= document.getElementById("Block").value;
        cell.appendChild(input)
   
        cell=row.insertCell();
        input= document.createElement("input");
        input.setAttribute('id','BlockHa'+rows);
        input.setAttribute('type','number')
        input.setAttribute('class','full');
        input.value= document.getElementById("BlockHa").value;
        cell.appendChild(input);

        cell=row.insertCell();
        input= document.createElement("input");
        input.setAttribute('id','Price'+rows);
        input.setAttribute('type','number');
        input.setAttribute('class','full');
        input.value= document.getElementById("Price").value;
        cell.appendChild(input);

        cell=row.insertCell();
        input=document.createElement("input");
        input.setAttribute('id','RemHa'+rows)
        input.setAttribute('readonly','true')
        input.setAttribute('type','number');
        input.setAttribute('class','full');
        input.value= Number(document.getElementById("RemHa").value).toFixed(2);
        cell.appendChild(input)
   
        cell=row.insertCell();
        input= document.createElement("input");
        input.setAttribute('id','DailyHa'+rows);
        input.setAttribute('type','number');
        input.setAttribute('class','full');
        cell.appendChild(input);

        cell = row.insertCell();

        input= document.createElement("input");
        input.setAttribute('id','DailyHrs'+i);
        input.setAttribute('class','full');
        input.setAttribute('type','number');
        input.setAttribute('onkeyup','sumHours()');
        
        cell.appendChild(input);

        cell = row.insertCell();

       let check2 = document.createElement("input");
         check2.setAttribute('type','checkbox')
         check2.setAttribute('id','BlockDone'+rows);
         check2.setAttribute('onclick','selectDone(event.target)');
         cell.appendChild(check2);

document.getElementById("BlockHa").value="";
document.getElementById("RemHa").value="";

  saveBlockList();

}

function saveBlockList(){
  let myTable= document.getElementById("BlockTable")

  function Obj(Block,BlockHa,Price,RemHa){
    this.Block=Block;
    this.BlockHa=BlockHa;
    this.Price=Price;
    this.RemHa=RemHa;
  }
var myObjArr=[];

  for(i=1;i<myTable.rows.length; i++){
    var tr= myTable.rows[i];
    var input= tr.getElementsByTagName("input");
    var obj = new Obj(input[1].value, input[2].value, input[3].value, input[4].value);
    myObjArr.push(obj)
  }
localStorage.setItem('blocklist',JSON.stringify(myObjArr))
}


//make a div dropdown for blocks&rks




function createBlockArray(){
//alert(event.target.id)

  let task= document.getElementById("Task").value

  //alert(document.getElementById("Task").value)

if (task.toUpperCase().indexOf("PLANTING") > -1||task.toUpperCase().indexOf("BROWSE") > -1){

  
  var count= 0;
  
  let div = document.getElementById("div"+event.target.id);


  while (div.firstChild){
    div.removeChild(div.lastChild);
  }
    //div.id= "div"+event.target.id
    

    let BlockRows= document.getElementById("BlockTable").rows
    let RK= document.getElementById("RK")
    
    for(i=0;i<BlockRows.length;i++){

//alert(BlockRows[i].getElementsByTagName("input")[0].checked)

      if(BlockRows[i].getElementsByTagName("input")[0].checked==true){
  
   


        for(j=0;j<RK.length; j++){
          if(RK[j].selected==true){
            let blk= BlockRows[i].getElementsByTagName("input")[1].value;
            let rk= RK[j].value;
            count+=1;
            let input= document.createElement("input");
            input.id= event.target.id + count;
            let label= document.createElement("label");
            label.setAttribute('style','float:left');
            label.textContent= blk+ " " + rk;
            label.setAttribute('style','font-size:0.7em;')
            
            //input.placeholder= blk+ ": " + rk;
            input.type= "number";
            input.setAttribute('onchange','sum()');


if(document.getElementById("PieceRate").checked==true){//piecrate-coop

if(task.toUpperCase().indexOf("BROWSE") > -1){
  if(div.id=="divTrees" || div.id=="divFert"){
    input.setAttribute('style','display:none');
    label.setAttribute('style','display:none');
  }
}

if(document.getElementById("Individual").checked==true && div.id!="div$_Unit"){//piecerate-ind
  input.setAttribute('style','display:none');
  label.setAttribute('style','display:none');
}
}else{//hourly
  if(document.getElementById("Individual").checked==true){//hourly-ind
    input.setAttribute('style','display:none');
    label.setAttribute('style','display:none');
  }else{//hourly-coop
    if(div.id=="div$_Unit"){

      input.setAttribute('style','display:none');
      label.setAttribute('style','display:none');
    }
    if(task.toUpperCase().indexOf("BROWSE") > -1){
  if(div.id=="divTrees" || div.id=="divFert"){
    input.setAttribute('style','display:none');
    label.setAttribute('style','display:none');
  }
}
  }

}
            div.append(label);
            div.appendChild(input);
          }//endif
        }//end j
      }//end if
    }//end i
event.target.parentNode.appendChild(div);
}//end if
}

function makeArrays(){
  document.getElementById("Trees").value="";
  document.getElementById("Fert").value="";
  document.getElementById("Cones").value="";
  document.getElementById("$_Unit").value="";

  while (document.getElementById("divTrees").firstChild){
document.getElementById("divTrees").removeChild(document.getElementById("divTrees").lastChild);
  }
  document.getElementById("Trees").click();

  while (document.getElementById("divFert").firstChild){
document.getElementById("divFert").removeChild(document.getElementById("divFert").lastChild);
  }
  document.getElementById("Fert").click();

  while (document.getElementById("divCones").firstChild){
document.getElementById("divCones").removeChild(document.getElementById("divCones").lastChild);
  }
  document.getElementById("Cones").click();

  while (document.getElementById("div$_Unit").firstChild){
document.getElementById("div$_Unit").removeChild(document.getElementById("div$_Unit").lastChild);
  }
    
    document.getElementById("$_Unit").click();
  
}
//sum tree, fert, cone fields
function sum(){

  let div= event.target.parentNode;


    let arr= Array.from(div.getElementsByTagName("input"))
    
    let s=0;
    arr.forEach(myFunction);

    function myFunction(item) {
      s +=Number(item.value);
     //document.getElementById()
     
    }
    let str= div.id;
    let el=str.replace("div", "");
    if(el!="$_Unit"){
      document.getElementById(el).value=s;
    }
}

function proArray(){
    
    let crewlist=[];
    let mynames= document.getElementById("Name").getElementsByTagName("option");
  Array.from(mynames).forEach(crewList);

   function crewList(item,index) {

     if(item.selected==true){
       crewlist.push(item.value)
     }
   }
  if(crewlist.length>1){
    document.getElementById("CrewList").textContent= "Crew: " + String(crewlist);
  }else{
    document.getElementById("CrewList").textContent= "";
  }

  let myDiv= document.getElementById("divProRate");
  while (myDiv.firstChild){
    myDiv.removeChild(myDiv.lastChild);
  }

let piecerate= document.getElementById("PieceRate").checked;
let task= document.getElementById("Task").value;

  if(task.toUpperCase().indexOf("BRUSHING") > -1 && piecerate == true){



  //let uniqueNames = [...new Set(crewnames)];
  let names= document.getElementById("Name").getElementsByTagName("option");
  Array.from(names).forEach(proArr);

   function proArr(item,index) {


     if(item.selected==true){

       let div= document.createElement('div');
         div.setAttribute('style','float:left');
       let labelName= document.createElement('label');
         labelName.textContent = item.value;
         labelName.setAttribute('style','font-size:0.75em');

       let inputProRate= document.createElement('input');   
         inputProRate.setAttribute('type','Number');
         inputProRate.setAttribute('style','float:left');



     div.appendChild(labelName);
     div.appendChild(inputProRate);
     document.getElementById("divProRate").appendChild(div);
     }
     
     //document.getElementById("divProRate").appendChild(div2);
     }
     //document.getElementById()
     
  }else{

  }
//check storage for prorate
       let div= document.getElementById("divProRate");
       let labels= Array.from(div.getElementsByTagName("label"));

       let inputs= Array.from(div.getElementsByTagName("input"));
    
       let store= JSON.parse(localStorage.getItem("prorate"));

       for (i=0; i< labels.length; i++){
  
         for (key in store){

           if (store[key].name == labels[i].textContent){
            
             inputs[i].value= store[key].prorate;
           }else{
             if(inputs[i].value==""){
               inputs[i].value=1;
             }
           }

          }
        }
  
}



/*
//highlight rows- not being used!!

var MyTable = document.getElementById('empTable');
var rows = MyTable.getElementsByTagName('tr');
for (var i = 0; i < rows.length; i++) {
    rows[i].onmouseover = function() {
        this.style.backgroundColor = '#ff0000';
    }
    rows[i].onmouseout = function() {
        this.style.backgroundColor = '#ffffff';
    }
}
*/

//add lead value to crew list

function addtocrew(){
  document.getElementById("Name").value = document.getElementById("Lead").value;
}

//Date-picker functions
function dPicker(){
        (function () {
            const input = document.getElementById('Start');
            const datepicker = new TheDatepicker.Datepicker(input);
            datepicker.render();
        })();

        (function () {
            const input = document.getElementById('End');
            const datepicker = new TheDatepicker.Datepicker(input);
            datepicker.render();
        })();

        (function () {
            const input = document.getElementById('Date');
            const datepicker = new TheDatepicker.Datepicker(input);
            datepicker.render();
        })();

}

//get pay period start Date

function getstartdate(){

var end= new Date(document.getElementById('End').value);
var dateMillis = end.getTime();
var period= 12*8.64e+7


var newDate = new Date();
newDate.setTime(dateMillis - period);

var date = new Date(newDate);
var dateString = new Date(date.getTime() - (date.getTimezoneOffset() * 60000 ))
                    .toISOString()
                    .split("T")[0];
        

document.getElementById("Start").value= dateString;

  
}

//get pay period end date

function getenddate(){
var start= new Date(document.getElementById('Start').value);
var dateMillis = start.getTime();
var period= 14*8.64e+7


var newDate = new Date();
newDate.setTime(dateMillis + period);

var date = new Date(newDate);
var dateString = new Date(date.getTime() - (date.getTimezoneOffset() * 60000 ))
                    .toISOString()
                    .split("T")[0];
        

document.getElementById("End").value= dateString;

}

//save lead and pay period info

function savelead(){
  localStorage.setItem('myLead', document.getElementById("Lead").value)

  localStorage.setItem('myStart', document.getElementById("Start").value)

  localStorage.setItem('myEnd', document.getElementById("End").value)

}

//clear saved lead info

function clearlead(){
  if (confirm("Confirm Delete?")) {
document.getElementById("Lead").value="";
document.getElementById("Name").value="";
document.getElementById("Start").value="";
document.getElementById("End").value="";
    localStorage.removeItem('myLead')
    localStorage.removeItem('myStart')
    localStorage.removeItem('myEnd')
  }
}

//get todays Date

function gettoday(){

    var today = new Date();
    var dd = today.getDate();

    var mm = today.getMonth()+1; 
    var yyyy = today.getFullYear();
    if(dd<10) 
    {
      dd='0'+dd;
    } 

    if(mm<10) 
    {
      mm='0'+mm;
    } 
    today = yyyy+'-'+mm+'-'+dd;
      document.getElementById("Date").value= today;
  }

//calculate daily km

function calculateKm() {
if (KmS.value > 0 && KmE.value > KmS.value) {KmD.value = (KmE.value - KmS.value)
}
}

//global variables

var blocks=[];
var blockha=[];
var blocks2=[];
var blockha2=[];
var number1=0;
var myblocks=[];
var myblockha=[];
var dailyha=[];
var dailyhrs=[];
var arrrem=[];
var arrprice=[];

//get Ha Array

function getHa() {
var blocks=[];
var blockha=[];
var dailyha=[];
var dailyhrs=[];
var arrrem=[];
var arrprice=[];



  var myTab= document.getElementById("empTable")//
  var tr= myTab.getElementsByTagName("tr");
  var BlockTable= document.getElementById("BlockTable")
  var length = BlockTable.rows.length;
 
           
        for (i=0;i<length; i++){
          var remarr=[];
          var check= BlockTable.rows[i].getElementsByTagName("input")[0];
          var block = BlockTable.rows[i].getElementsByTagName("input")[1];
          var ha= BlockTable.rows[i].getElementsByTagName("input")[2];
          var price= BlockTable.rows[i].getElementsByTagName("input")[3];
          var rem= BlockTable.rows[i].getElementsByTagName("input")[4];
          var daily= BlockTable.rows[i].getElementsByTagName("input")[5];
          var hrs= BlockTable.rows[i].getElementsByTagName("input")[6];
          

          if (check.checked==true){
           blocks.push(block.value);
           dailyha.push(daily.value);
           dailyhrs.push(hrs.value);
           arrrem.push(rem.value);
           arrprice.push(price.value);

           for(j=1; j<myTab.rows.length; j++){

             var td3= tr[j].getElementsByTagName("input")[3];
             var td23= tr[j].getElementsByTagName("input")[23];


             if (td3.value==block.value){
               remarr.push(Number(td23.value));
             }
           } // for j

            if (remarr != ""){
               var remha= Number(remarr.reduce(function(a,b){return a+b})).toFixed(2);
            }else{
              remha=0;
            }

             if (remha >0 && remha !=""){
               blockha.push(Number(remha).toFixed(2));
             }else{
               blockha.push(Number(ha.value));
             }
		     } //if blockquote
	
				
	      } //for i

				number1= blocks.length;
				myblocks=blocks;
				myblockha= blockha;
				
			
				
				
function getSum(total, num) {
  return total + num;
}
//var x= blockha.reduce(getSum,0)

//document.getElementById("Ha").value = x;



}

//calculate remaining ha

function calcremha(){

  var BlockTable= document.getElementById("BlockTable");

  for (i=1;i<BlockTable.rows.length; i++){
    var rem= BlockTable.rows[i].getElementsByTagName("input")[4];
    var daily= BlockTable.rows[i].getElementsByTagName("input")[5];

    BlockTable.rows[i].getElementsByTagName("input")[4].value = Number(Number(rem.value)-Number(daily.value)).toFixed(2);

//clear daily ha and hours
BlockTable.rows[i].getElementsByTagName("input")[5].value = "";
BlockTable.rows[i].getElementsByTagName("input")[6].value = "";


  }

//save blocks back to JSON object in localStorage

saveBlockList()

}

//update remaining ha

function updateRem(){

let table= document.getElementById("BlockTable");
let myBlock= event.target.parentNode.parentNode.getElementsByTagName("input")[3].value;
    let rows = table.rows;
    Array.from(rows).forEach(matchBlock);

    function matchBlock(item, index) {
      if(item.getElementsByTagName("input")[1].value==myBlock){

        let x= item.getElementsByTagName("input")[4].value;

          item.getElementsByTagName("input")[4].value= Number(Number(x)+Number(event.target.value)).toFixed(6);
          event.target.placeholder= item.getElementsByTagName("input")[4].value + " ha remain";
          event.target.value="";
          event.target.focus();
        }
     }

}

function newRem(){

    let myBlock= event.target.parentNode.parentNode.getElementsByTagName("input")[3].value;

    let table= document.getElementById("BlockTable");
    let rows = table.rows;
    Array.from(rows).forEach(matchBlock);

    function matchBlock(item, index) {
      if(item.getElementsByTagName("input")[1].value==myBlock){
        let x= item.getElementsByTagName("input")[4].value;
        let y= event.target.value;
        if(Number(x)>=Number(y)){
          item.getElementsByTagName("input")[4].value= Number(Number(x)- Number(y)).toFixed(2);
        }else{
          alert("Too many Ha! there are " + item.getElementsByTagName("input")[4].value + " ha remaining");
           event.target.value = "";
           event.target.focus();
           
           
        }
        
      }

      
    }
    
    
  
  }

//save task and client info

function savetask(){
  localStorage.setItem("myTask", document.getElementById("Task").value);

  localStorage.setItem("myClient", document.getElementById("Client").value);

  localStorage.setItem("myHourly",document.getElementById("Hourly").checked);
  //localStorage.setItem("myPieceRate",document.getElementById("PieceRate").checked);
  localStorage.setItem("myCoop",document.getElementById("Coop").checked);
  //localStorage.setItem("myInd",document.getElementById("Individual").checked);



}

//clear task and client info

function cleartask(){
  if (confirm("Confirm Delete?")) {
    
    localStorage.removeItem("myTask")
    localStorage.removeItem("myClient")
document.getElementById("Task").value="";
document.getElementById("Client").value="";

document.getElementById("Hourly").click();
document.getElementById("Coop").click();

localStorage.setItem("myHourly","true");
localStorage.setItem("myCoop","true");
    
  }
}

function saveBlock(){

  let myTable=document.getElementById("BlockTable");
  var myBlocks=[];
  for(i=1; i< myTable.rows.length; i++){
    
    let myRow= myTable.rows[i];
    let myCheck= myRow.getElementsByTagName("input")[0];

    if(myCheck.checked==true){
      myBlocks.push(myCheck.id);
    }
    
  }
    localStorage.setItem("myBlock",JSON.stringify(myBlocks));
  
  //localStorage.setItem("myBlock", document.getElementById("BlockTable").innerHTML)
}

function clearBlock(){

  if (confirm("Confirm Delete?")) {
    
    localStorage.removeItem("myBlock")
  }

  let myTable=document.getElementById("BlockTable");
  var myBlocks=[];
  for(z=1; z< myTable.rows.length; z++){
    
    let myRow= myTable.rows[z];
    let myCheck= myRow.getElementsByTagName("input")[0];

    if(myCheck.checked==true){
      myCheck.checked=false;
      let inputs= myCheck.parentNode.parentNode.getElementsByTagName("input");

      for(y=1; y< inputs.length; y++){
        if(inputs[y].readOnly==true){
          inputs[y].style.backgroundColor= "rgb(220,220,220)";
        }else{
          inputs[y].style.backgroundColor="";
        }
      }
          
      //}
      
    }
  }


}

function saveCrew(){
  let crewlist=[];
    let mynames= document.getElementById("Name").getElementsByTagName("option");
  Array.from(mynames).forEach(crewList);

   function crewList(item,index) {

     if(item.selected==true){
       crewlist.push(item.value)
     }
   }
  localStorage.setItem("myCrew",JSON.stringify(crewlist));
}

function clearCrew(){
  if (confirm("Confirm Delete?")) {
    
    localStorage.removeItem("myCrew")
document.getElementById("Name").value= document.getElementById("Lead").value

    
  }
}

//create table headers

function createTable() {
    
  var arrHead = new Array();

    arrHead = ['', 'Date', 'Client','Block', 'BlockHa','Task', 'Name','Hours','OT1','OT2','Ha','ProRate','AdjHa','HaRate','Species','Trees','Fert','Cones','$/Hr','$/Unit','CrewLead','Trucks','DailyKm','RemHa','Comments']; // table headers.

var tb= document.createElement('tbody');

    // first create a TABLE structure by adding few headers.


        var empTable = document.createElement('table');
        empTable.setAttribute('id', 'empTable');  // table id.

       var header = empTable.createTHead();
      //empTable.appendChild(header);

        var tr= header.insertRow(-1);
        
        

        for (var h = 0; h < arrHead.length; h++) {
            var th = document.createElement('th');
            //var ths = document.createElement('th'); 
            


            
            th.innerHTML = arrHead[h]+"<br>";
            tr.appendChild(th);
            

if (h == 0) {   // if its the first column of the table.
                // add a button control.
                var button = document.createElement('input');
                var check = document.createElement('input');

                // set the attributes.
                button.setAttribute('type', 'button');
                button.setAttribute('id', 'DeleteSel');
                button.setAttribute('value', 'Delete');
                button.style.backgroundColor = "red";
                button.style.height = "30px";
                button.setAttribute("class","inputbutton");
                button.style.float= 'center';
                button.setAttribute('onclick', 'deleteRows(document.getElementById("empTable"))')

                check.setAttribute('id', 'SelectAll');
                check.setAttribute('type', 'checkbox');
                check.setAttribute('onclick', 'selectAll()');
                //check.style='float:center';


                // add button's "onclick" event.
                //button.setAttribute('onclick', 'sumtable();');
                //xbutton.onclick= "sumtable()";
//make a function for summarizing table
     
                th.setAttribute('class','sticky2');
                th.appendChild(button);
                th.appendChild(check);
               
            }else{
            

var input = document.createElement("input");
                if (h == 2||h==3||h==5||h==6||h==13||h==14||h==19||h==20||h==24){
                  input.setAttribute('type','text');
                }else{
                   input.setAttribute('type','number');
                   //input.setAttribute('step','0.01');
                }
                
                input.name = "sum" + h;
                input.id = "sum" + h;
                input.setAttribute('class','full')
                input.value= "";
                input.readOnly= true;
                input.style.backgroundColor= "rgb(220,220,220)";

                if(h==6){
                  th.setAttribute('class','sticky');
                }else{
                  th.setAttribute('class','sticky2');
                }
              
					
					th.appendChild(input);
            
            
            //ths.innerHTML= arrHead[h];
            //ts.appendChild(ths);
          }
            
        }



        empTable.appendChild(tb);

        var div = document.getElementById('cont');
        div.appendChild(empTable);    // add table to a container.
 
/*if (confirm("Open Previously Saved Table?")) {
         gettabledata();
       }*/
  }

// function to add new row.


function addRow() {

//check for blank inputs

let l= document.getElementById("Lead");
  if(l.value==""){
  alert("Please select a crew Lead");
  l.focus();
  return
  }else{
    let s= document.getElementById("Start");
    let e= document.getElementById("End");
      if(s.value=="" || e.value==""){
        alert("Please select pay period dates");
        s.focus()
        return
      }else{

        let d= document.getElementById("Date");

        if(d.value==""){
          alert("Please enter a date");//blank date
          d.focus();
          return
  
        }else{

          let checkha=checkHa()
          
          if(checkha==false){
            return
          }else{
            let t= document.getElementById("Task");
            if(t.value==""){
              alert("Please select a task");
              t.focus();
              return
            }else{
              let n= document.getElementById("Name");
              if(n.value==""){
                alert("Please select at least 1 crew member");
                n.focus();
                return
              }else{
                let h= document.getElementById("Hours");
                if(Number(h.value)==0){
                  alert("Please enter hours");
                  return
                }else{
                  let checkplanting=checkPlanting();
                  if(checkplanting==false){
                    return
                  }
                }
              }
            }
          }
        }
      }
    
  
}
   

//end check for blank inputs

    getHa();


   //create arrays

  var numberrows=0;

            // Number of inputs to create
            var length = document.getElementById("BlockTable").rows.length;
            var length1 = document.getElementById("Name").length;
            var length2 = document.getElementById("RK").length;
            var number=0;
            var number2=0;
            var number3=0;
            var crewnames=[];
            
            var rks = [];
            var rks2=[];
            var blocks2=[];
            var blocks3=[];
            var dailyha2=[];
            var dailyha3=[];
            var dailyhrs2=[];
            var dailyhrs3=[];



            var arrprice2=[];
            var arrprice3=[];
            var arrrem2=[];
            var arrrem3=[];
            var arrrem4=[];
            var blockha2=[];
            var blockha3=[];

            var arrayBlockTrees=[];
            var arrayBlockFert=[];
            var arrayBlockCones=[];
            var arrayBlockPrice=[];

            var arrayBlockTrees2=[];
            var arrayBlockFert2=[];
            var arrayBlockCones2=[];
            var arrayBlockPrice2=[];

            var arrayBlockTrees3=[];
            var arrayBlockFert3=[];
            var arrayBlockCones3=[];
            var arrayBlockPrice3=[];


            let myDiv= document.getElementById("divProRate")

            function ObjPro(name,prorate){
              this.name= name
              this.prorate=prorate;
            }

            var arrProRate=[];

            let arrLabel= Array.from(myDiv.getElementsByTagName("label"));
            let arrInput= Array.from(myDiv.getElementsByTagName("input"));

            arrLabel.forEach(proObj)
    
            function proObj(item,index){
              let obj = new ObjPro(arrLabel[index].textContent, arrInput[index].value);

               arrProRate.push(obj)

            }
            
				localStorage.setItem("prorate",JSON.stringify(arrProRate))
				
				for (l=0; l< length2; l++){
				  var rk= document.getElementById("RK").options[l];
				    if (rk.selected){
				      rks2.push(rk.value)
				
                        //if(length2>0){


				
				     
				    }
				}
				
				var count= rks2.length;
				
          
  for (j=0;j<number1; j++){//loop through blocks from getHa


        for (k=0;k<length; k++){//loop through blocks and add to array per person

        var BlockTable= document.getElementById("BlockTable");

        var blockrow= BlockTable.rows[k];

        var check= blockrow.getElementsByTagName("input")[0];

        var block= blockrow.getElementsByTagName("input")[1];
        var ha= blockrow.getElementsByTagName("input")[2];
        var price= blockrow.getElementsByTagName("input")[3];
        var rem= blockrow.getElementsByTagName("input")[4];
        var daily= blockrow.getElementsByTagName("input")[5];
        var hrs= blockrow.getElementsByTagName("input")[6];
        

          if (check.checked==true){
                blocks2.push(block.value);
                blockha2.push(Number(ha.value));
                arrprice2.push(Number(price.value).toFixed(2));
                arrrem2.push(Number(rem.value));
                dailyha2.push(Number(daily.value));
                dailyhrs2.push(Number(hrs.value));
           
			  }//end if
			}//end for 
        
				
		for (i=0;i<length1; i++){
            var name= document.getElementById("Name").options[i];
        
            if (name.selected){



            var blk= blocks2[j];
				var blkha= blockha2[j];
				var blkpr= arrprice2[j];
				var blkrem= arrrem2[j];
				var blkdaily= dailyha2[j];
				var blkdailyhrs= dailyhrs2[j];
				var blkTrees= arrayBlockTrees[j];
				var blkFert= arrayBlockFert[j];
				var blkCones= arrayBlockCones[j];
				var blkPrice= arrayBlockPrice[j];

              if (count==0){
                number++;
                crewnames.push(name.value);
                blocks3.push(blk);
                blockha3.push(blkha);
                arrprice3.push(blkpr);
                arrrem3.push(blkrem);
                dailyha3.push(blkdaily);
                dailyhrs3.push(blkdailyhrs);
              


               }
				   for (l=0; l< rks2.length; l++){
				  
				
				      rks.push(rks2[l])
				
				      number++;
                  crewnames.push(name.value);
                  blocks3.push(blk);
                  blockha3.push(blkha);
                  arrprice3.push(blkpr);
                  arrrem3.push(blkrem);
                  dailyha3.push(blkdaily);
                  dailyhrs3.push(blkdailyhrs);
             
			
            }//end if name.selected

           
				}
				}
				
				
				
		  
     }

        numberrows=number;

arrrem3.forEach(addArrays)
  function addArrays(value, i, array){
    arrrem4.push(arrrem3[i]-dailyha3[i])
  }
        

if(count>0){

  let div1= document.getElementById("divTrees");
  let div2= document.getElementById("divFert");
  let div3= document.getElementById("divCones");
  let div4= document.getElementById("div$_Unit");

  let labels1= div1.getElementsByTagName("label");
  let labels2= div2.getElementsByTagName("label");
  let labels3= div3.getElementsByTagName("label");
  let labels4= div4.getElementsByTagName("label");

  let inputs1= div1.getElementsByTagName("input");
  let inputs2= div2.getElementsByTagName("input");
  let inputs3= div3.getElementsByTagName("input");
  let inputs4= div4.getElementsByTagName("input");


  for(x=0; x<blocks3.length; x++){
    
    for(y=0; y<inputs1.length; y++){
      if(String(labels1[y].textContent) == String(blocks3[x] + " " +rks[x])){
        
          arrayBlockTrees.push(Number(inputs1[y].value));
          arrayBlockFert.push(Number(inputs2[y].value));
          arrayBlockCones.push(Number(inputs3[y].value));
          arrayBlockPrice.push(Number(inputs4[y].value));
        
      }
    
    }


  

  }
}




  //end arrays

//create table rows
var tbodyRef = document.getElementById('empTable').getElementsByTagName('tbody')[0];

        for (i=0; i<number; i++){
        var empTab = document.getElementById('empTable');
        
        var rowCnt = tbodyRef.rows.length;    // get the number of rows.
          

        var tr = tbodyRef.insertRow(0); // table row.
        //tr = empTab.insertRow(rowCnt);

        var arrHead= Array.from(document.getElementById("empTable").rows[0].getElementsByTagName("input"));

arrHead.shift()//take off extra input in first column of header

//crazy
        for (var c = 0; c < arrHead.length; c++) {


            var td = document.createElement('td'); 
              
//TABLE DEFINITION.
            td = tr.insertCell(c);
                 
       

            if (c == 0) {   // if its the first column of the table.
                // add a button control.
                //var button = document.createElement('input');
                var check1= document.createElement('input');


                check1.setAttribute('id', 'Check'+i);
                check1.setAttribute('type', 'checkbox');
                //check1.setAttribute('style','align-center');
                check1.setAttribute('height','40px');
                check1.setAttribute('width','40px');
                check1.setAttribute('onclick','highlightRow(event.target)')

                
               
                td.appendChild(check1);


               
            }

            

            if (c == 1) {

            
                var input0 = document.createElement("input");
                input0.setAttribute('type','text');
                input0.name = "date" + i;
                input0.id = "date" + i;
                input0.setAttribute('class','full');
                input0.value= document.getElementById("Date").value;

					  
					td.appendChild(input0);
                
					
				}
				if (c == 2) {
				
var input1 = document.createElement("input");
                input1.setAttribute('type','text');
                input1.name = "client" + i;
                input1.id = "client" + i;
                input1.setAttribute('class','full');
                input1.setAttribute('list','clientlist');
                input1.value= document.getElementById("Client").value;

var list1 = document.createElement("datalist");
                list1.id="clientlist";
 
					  
					td.appendChild(input1);
					td.appendChild(list1);
					
					for (x= 0; x< document.getElementById("Client").length; x++){
                 var el= document.getElementById("Client").options[x];
                 var opt= document.createElement("option");
                 opt.value=el.value;

                 list1.appendChild(opt);
               }
              
                
				}
				if (c == 3) {
				
var input2= document.createElement("input");
                input2.setAttribute('type','text');
                input2.name = "block" + i;
                input2.id = "block" + i;
                input2.value= blocks3[i]
                input2.setAttribute('class','full');
                input2.setAttribute('list','blocklist');
                input2.setAttribute('onblur','getblocklist(this)');
                //td.setAttribute('class','sticky');

var list2 = document.createElement("datalist");
                list2.id="blocklist";
					  
					td.appendChild(input2);
					td.appendChild(list2);
					
					for (x= 0; x< length; x++){
					   var blockrow= BlockTable.rows[x]
                 var el= blockrow.getElementsByTagName("input")[1];
                 var opt= document.createElement("option");
                 opt.value=el.value;
                

                 list2.appendChild(opt);
               }
                
				}
				if (c == 4) {
				
var input3 = document.createElement("input");
                input3.setAttribute('type','number');
                //input3.setAttribute('step','0.01');
                input3.name = "blockha" + i;
                input3.id = "blockha" + i;
                input3.value= blockha3[i]
                input3.setAttribute('class','full');
                
					  
					td.appendChild(input3);
					
					

            }
            if (c == 5) {
           
var input4 = document.createElement("input");
                input4.setAttribute('type','text');
                input4.name = "task" + i;
                input4.id = "task" + i;
					  input4.value = document.getElementById("Task").value;
					  input4.setAttribute('class','full');
                 input4.setAttribute('list','tasklist');

                var list4 = document.createElement("datalist");
                list4.id="tasklist";

                td.appendChild(input4);
                td.appendChild(list4);

					
					for (x= 0; x< document.getElementById("Task").length; x++){
                 var el= document.getElementById("Task").options[x];
                 var opt= document.createElement("option");
                 opt.value=el.value;
                 list4.appendChild(opt);
               }
               
            }
            if (c == 6) {
             
var input5 = document.createElement("input");
                input5.setAttribute('type','text');
                input5.name = "name" + i;
                input5.id = "name" + i;
					  input5.value = crewnames[i]
					 input5.setAttribute('class','full');
                 input5.setAttribute('list','crewlist');
					  
					  var list5 = document.createElement("datalist");
                list5.id="crewlist";
                
                
					  td.setAttribute('class','sticky');
                td.appendChild(input5);
                td.appendChild(list5);
               
                for (x= 0; x< document.getElementById("Name").length; x++){
                 var el= document.getElementById("Name").options[x];
                 var opt= document.createElement("option");
                 opt.value=el.value;
                 list5.appendChild(opt);
                }
                

             }
             if (c == 7) {

var input6 = document.createElement("input");
                input6.setAttribute('type','number');
                //input6.setAttribute('step','0.25');
                input6.name = "hours" + i;
                input6.id = "hours" + i;
                input6.setAttribute('class','full');

            let docHrs= document.getElementById("Hours");
           
            if(rks.length>0){

let uniqueRKs = [...new Set(rks)];
        
              
                if(docHrs.readOnly==true){
                  input6.value = Number(dailyhrs3[i]/(uniqueRKs.length)).toFixed(2);
                }else{
                  input6.value = Number(docHrs.value/(uniqueRKs.length*number1)).toFixed(2);
					  }
				}else{
				  if(docHrs.readOnly==true){
					 input6.value = Number(dailyhrs3[i]).toFixed(2);
				  }else{
					 input6.value= Number(docHrs.value/(number1)).toFixed(2);
				  }
				}
					

					td.appendChild(input6);
					
					}
					if (c == 8) {
					
var input7 = document.createElement("input");
                input7.setAttribute('type','number');
                input7.name = "ot1" + i;
                input7.id = "ot1" + i;
                //input7.setAttribute('step','0.25');
					  input7.value = document.getElementById("OT1").value;
					  input7.setAttribute('class','full');
					
					td.appendChild(input7);
					}
					if (c == 9) {
					
var input8 = document.createElement("input");
                input8.setAttribute('type','number');
                input8.name = "ot2" + i;
                input8.id = "ot2" + i;
                //input8.setAttribute('step','0.25');
					  input8.value = document.getElementById("OT2").value;
					  input8.setAttribute('class','full');
					
					td.appendChild(input8);
					
					}
					if (c == 10) {
					
var input9 = document.createElement("input");
                input9.setAttribute('type','number');
                //input9.setAttribute('step','0.001');
                input9.name = "ha" + i;
                input9.id = "ha" + i;
					  input9.setAttribute('class','full');
					  input9.setAttribute('onclick','updateRem()')
					  input9.setAttribute('onchange','newRem(event.target.value)')
				
				     input9.value= Number(dailyha3[i]/(numberrows/number1)).toFixed(6);
					  
					
					td.appendChild(input9);
					}
					if (c == 11) {

					
var input10 = document.createElement("input");
                input10.setAttribute('type','number');
                input10.name = "prorate" + i;
                //input10.setAttribute('step','0.05');
                input10.id = "prorate" + i;
					  input10.setAttribute('class','full');
					
					arrProRate.forEach(getProRate)
					  function getProRate(item,index){
					
					    if(String(input5.value)==String(arrProRate[index].name)){
					      input10.value = Number(arrProRate[index].prorate);
					
					    }
					    
					  }
			
					td.appendChild(input10);
					
					}
					if (c == 12) {

var input11 = document.createElement("input");
                input11.setAttribute('type','number');
                //input11.step= "0.001";
                input11.name = "adjha" + i;
                input11.id = "adjha" + i;
					  //input11.value = Number(input10.value * input9.value).toFixed(6);
					  input11.readOnly= true;
					  input11.setAttribute('class','full');
					
					td.appendChild(input11);
					}
					if (c == 13) {
					
var input12 = document.createElement("input");
                input12.setAttribute('type','number');
                //input12.step= "0.01";
                input12.name = "harate" + i;
                input12.id = "harate" + i;
                input12.setAttribute('class','full');
               
					
					if(input5.value== document.getElementById("Lead").value) {
					  input12.value = Number(arrprice3[i]*1.1).toFixed(2);
//Number(document.getElementById("HaRate").value)*1.1
					}else{
					  input12.value = Number(arrprice3[i]).toFixed(2);
//document.getElementById("HaRate").value;
					}
					
					td.appendChild(input12);
					
					}
					if (c == 14) {
					
var input13 = document.createElement("input");
                input13.setAttribute('type','text');
                input13.name = "species" + i;
                input13.id = "species" + i;
                input13.setAttribute('class','full');
                input13.setAttribute('list','rklist');
					 if(rks[i]!=undefined){
					input13.value = rks[i]; 
					 }
					
					var list13 = document.createElement("datalist");
               list13.id="rklist";
					
					td.appendChild(input13);
					td.appendChild(list13);
					
					for (x= 0; x< document.getElementById("RK").length; x++){
                 var el= document.getElementById("RK").options[x];
                 var opt= document.createElement("option");
                 opt.value=el.value;

                 list13.appendChild(opt);
               }
					
					
					}
					if (c == 15) {
					
var input14 = document.createElement("input");
                input14.setAttribute('type','number');
                input14.name = "trees" + i;
                input14.id = "trees" + i;
                input14.setAttribute('class','full');
					  
	 if(document.getElementById("Coop").checked == true){
	            
					let uniqueNames = [...new Set(crewnames)];
					input14.value = Number(arrayBlockTrees[i]/uniqueNames.length).toFixed(4);
				
			
					}else{
					input14.value="";
					input14.style.border="2px solid rgb(255,0,0)";
					}
					
					input14.placeholder= input5.value;
					
				
					td.appendChild(input14);
					}
					if (c == 16) {
					
var input15 = document.createElement("input");
                input15.setAttribute('type','number');
                input15.name = "fert" + i;
                input15.id = "fert" + i;
					  input15.setAttribute('class','full');
					
			if(document.getElementById("Coop").checked == true){
					let uniqueNames = [...new Set(crewnames)];
					input15.value = Number(arrayBlockFert[i]/uniqueNames.length).toFixed(4);
					}else{
					input15.style.border="2px solid rgb(255,0,0)";
					}
					input15.placeholder= input5.value;
					td.appendChild(input15);
					
					}
					if (c == 17) {
					
var input16 = document.createElement("input");
                input16.setAttribute('type','number');
                input16.name = "cones" + i;
                input16.id = "cones" + i;
					  input16.setAttribute('class','full');
					
	  if(document.getElementById("Coop").checked == true){
					let uniqueNames = [...new Set(crewnames)];
					input16.value = Number(arrayBlockCones[i]/uniqueNames.length).toFixed(4);
		}else{
		input16.style.border="2px solid rgb(255,0,0)";
		}
					input16.placeholder= input5.value;
					td.appendChild(input16);
					}
					if (c == 18) {
					
var input17 = document.createElement("input");
                input17.setAttribute('type','number');
                //input17.setAttribute('step','0.01');
                input17.name = "$_hr" + i;
                input17.id = "$_hr" + i;
					  input17.value = "";
					  input17.readOnly= true;
					  input17.setAttribute('class','full');
					
					td.appendChild(input17);
					}
					if (c == 19) {
				
					
var input18 = document.createElement("input");
                input18.setAttribute('type','number');
                //input18.setAttribute('step','0.005');
                input18.name = "$_unit" + i;
                input18.id = "$_unit" + i;
                input18.setAttribute('onchange','calculateplanting()');


let task= document.getElementById("Task").value;
if(document.getElementById("PieceRate").checked == true && (task.toUpperCase().indexOf("BROWSE") > -1 || task.toUpperCase().indexOf("PLANTING") > -1)){
  
					input18.value = arrayBlockPrice[i];
					input18.style.border="2px solid rgb(255,0,0)";
}
					  input18.setAttribute('class','full');
					
					td.appendChild(input18);
					}
					if (c == 20) {
					
var input19 = document.createElement("input");
                input19.setAttribute('type','text');
                input19.name = "lead" + i;
                input19.id = "lead" + i;
					  input19.value = document.getElementById("Lead").value;
					  input19.setAttribute('class','full');
					  input19.setAttribute('list','leadlist');
					
					var list19 = document.createElement("datalist");
               list19.id="leadlist";
					
					td.appendChild(input19);
					td.appendChild(list19);
					
					for (x= 0; x< document.getElementById("Lead").length; x++){
                 var el= document.getElementById("Lead").options[x];
                 var opt= document.createElement("option");
                 opt.value=el.value;

                 list19.appendChild(opt);
               }
					
					
					}
					if (c == 21) {
					
					
var input20 = document.createElement("input");
                input20.setAttribute('type','number');
                input20.name = "trucks" + i;
                input20.id = "trucks" + i;
                input20.setAttribute('class','full');
					  
					if(i== 0) {
					input20.value = document.getElementById("Trucks").value;
					}
					td.appendChild(input20);
					}
					if (c == 22) {
					
var input21 = document.createElement("input");
                input21.setAttribute('type','number');
                //input21.setAttribute('step','0.1');
                input21.name = "kmd" + i;
                input21.id = "kmd" + i;
                input21.setAttribute('class','full');
					  
					if(i== 0) {
					input21.value = document.getElementById("KmD").value;
					}
					td.appendChild(input21);
					}
					if (c == 23) {
				
var input22 = document.createElement("input");
                input22.setAttribute('type','number');
                //input22.setAttribute('step','0.01');
                input22.name = "remha" + i;
                input22.id = "remha" + i;
					  input22.setAttribute('class','full');
					  input22.setAttribute('readonly','true');
				
			
					  input22.value = arrrem4[i];
					
//(Number(input3.value)-Number(input9.value)*(numberrows/cnt2))/(numberrows/cnt2);
					
					td.appendChild(input22);
					
					}
					if (c == 24) {
				
var input23 = document.createElement("input");
                input23.setAttribute('type','text');
                input23.name = "comments" + i;
                input23.id = "comments" + i;
                input23.setAttribute('class','full');
					  
					if (i==0){
					input23.value = document.getElementById("Comments").value;
					}
					td.appendChild(input23);
					


                
            }//end forc
        }//end fori


      }

//set focus for individual planting
      let task= document.getElementById("Task").value;

      if(document.getElementById("Individual").checked==true && (task.toUpperCase().indexOf("BROWSE") > -1 || task.toUpperCase().indexOf("PLANTING") > -1)){
        tbodyRef.rows[0].getElementsByTagName("input")[15].focus();
      }

//clear planting matrix

document.getElementById('RK').value="";

var div= document.getElementById("divTrees");
while (div.firstChild){
div.removeChild(div.lastChild);
  }
var div= document.getElementById("divFert");
while (div.firstChild){
div.removeChild(div.lastChild);
  }
var div= document.getElementById("divCones");
while (div.firstChild){
div.removeChild(div.lastChild);
  }
var div= document.getElementById("div$_Unit");
while (div.firstChild){
div.removeChild(div.lastChild);
  }
document.getElementById("Trees").value="";
document.getElementById("Fert").value="";
document.getElementById("Cones").value="";
document.getElementById("$_Unit").value="";

      
      removeduplicates();
      calcremha();

document.getElementById("myInput1").value=document.getElementById("Date").value;

      multiFilter();

      calculateprorate();
      calculateplanting();

      colourtable();
      sumtable();
     
      document.getElementById("Hours").value="";
      document.getElementById("OT1").value="";
      document.getElementById("OT2").value="";
      document.getElementById("Comments").value="";
      
}//end addrows



//multi filter on main table

function multiFilter() {

var input1, input2, input3, input4, input5, filter1, filter2, filter3, filter4, filter5, table, tr, td1, td2, td3, td4, td5, i, txtValue1, txtValue2, txtValue3, txtValue4, txtValue5;
  
table = document.getElementById("empTable");
  tr = table.getElementsByTagName("tr");
  input1 = document.getElementById("myInput1");
  filter1 = input1.value.toUpperCase();
  input2 = document.getElementById("myInput2");
  filter2 = input2.value.toUpperCase();
  input3 = document.getElementById("myInput3");
  filter3 = input3.value.toUpperCase();
  input4 = document.getElementById("myInput4");
  filter4 = input4.value.toUpperCase();
  input5 = document.getElementById("myInput5");
  filter5 = input5.value.toUpperCase();
  
   
  for (i = 1; i < tr.length; i++) {

    
  td1 = tr[i].getElementsByTagName("input")[1];
  td2 = tr[i].getElementsByTagName("input")[2];
  td3  = tr[i].getElementsByTagName("input")[3];
  td4  = tr[i].getElementsByTagName("input")[5];
  td5  = tr[i].getElementsByTagName("input")[6];


    if (td1,td2,td3,td4,td5){
      txtValue1 = td1.value;
      txtValue2 = td2.value;
      txtValue3 = td3.value;
      txtValue4 = td4.value;
      txtValue5 = td5.value;


      if (txtValue1.toUpperCase().indexOf(filter1) > -1 && txtValue2.toUpperCase().indexOf(filter2) > -1 && txtValue3.toUpperCase().indexOf(filter3) > -1 && txtValue4.toUpperCase().indexOf(filter4) > -1 && txtValue5.toUpperCase().indexOf(filter5) > -1){
        tr[i].style.display = "";
      } else {
        tr[i].style.display = "none";
      }
    }
  }
  sumtable();
}

//calculate pro-rate

function calculateprorate(){

let myTab= document.getElementById("empTable");

var rows= myTab.rows.length
var tr = myTab.getElementsByTagName("tr");
var blkarray=[];
  var blkfilterarray=[];

//get block array from table

for(let k=1;k<myTab.rows.length;k++){
  
  let block =tr[k].getElementsByTagName("input")[3];//blk
  blkarray.push(block.value);
}

  blkfilterarray= [...new Set(blkarray)]
 
// calculate prorate by block
for (j=0; j<blkfilterarray.length; j++) {

  var datearray=[];
  var clientarray=[];
  var blockarray=[];
  
 
  var taskarray=[];
  var namearray=[];
  
  var haarray=[];
  var proratearray=[];
  var adjhaarray=[];
  var td1,td2,td3,td4,td5,td6,td7,td8;
  
  let blk= blkfilterarray[j];



// loop through each row of the table.
        for (i = 1; i < myTab.rows.length; i++){


          if (tr[i].style.display !== "none" && blk ==tr[i].getElementsByTagName("input")[3].value){


            // loop through each cell in each column.
                
					td1=tr[i].getElementsByTagName("input")[1];//date
					td2=tr[i].getElementsByTagName("input")[2];//clnt
					td3=tr[i].getElementsByTagName("input")[3];//blk
					td4=tr[i].getElementsByTagName("input")[5];//task
					td5=tr[i].getElementsByTagName("input")[6];//name
					td6=tr[i].getElementsByTagName("input")[10]; //ha
					td7=tr[i].getElementsByTagName("input")[11]; //pro
					td8=tr[i].getElementsByTagName("input")[12]; //adj
					
					haarray.push(Number(td6.value));
					proratearray.push(Number(td7.value));
					
			  }
			  
			}//end for i
			
			var l = haarray.length
      if(haarray !=""){
			  var sumha= haarray.reduce(function(a,b){return a + b});
      }else{
			  var sumha = 0
      }
			var sumpro = 0;
         for(var p=0; p<l; p++) {
           sumpro += haarray[p]*proratearray[p];
         }
			
			
			let x=0;
			
			if(sumpro>0){
			   x= (Number(sumha)-Number(sumpro))/l;
			}else{
			   x=0;
			}
			
// loop back through each row of the table.
  for (i = 1; i < myTab.rows.length; i++){

    if (tr[i].style.display !== "none" && blk ==tr[i].getElementsByTagName("input")[3].value){
      // loop through each cell in each column.
              
      var a= Number(tr[i].getElementsByTagName("input")[10].value); //ha
      var b= Number(tr[i].getElementsByTagName("input")[11].value); //pro


	   
	tr[i].getElementsByTagName("input")[12].value=((a*b)+x).toFixed(6);
	
     }//end if
	  
   }//end for i

}//end for j
  sumtable();
}

//calculate hourly planting

function calculateplanting(){


var myTab= document.getElementById("empTable")
var rows= myTab.rows.length
var tr = myTab.getElementsByTagName("tr");
  var datearray=[];
  var namearray=[];
  var datenamearray=[];
  var treearray=[];
  var treesumarray=[];
  var mytreearray=[];
  
  var td1,td6,td15;

// loop through each row of the table make name array
for (i = 1; i < myTab.rows.length; i++){
var treearray=[];
tr[i].getElementsByTagName("input")[18].value = "";

    var datename = tr[i].getElementsByTagName("input")[1].value + tr[i].getElementsByTagName("input")[6].value;
  for (j = 1; j < myTab.rows.length; j++){
    var datename2 = tr[j].getElementsByTagName("input")[1].value + tr[j].getElementsByTagName("input")[6].value;

let myPrice= tr[j].getElementsByTagName("input")[19].value;
let mTask= tr[j].getElementsByTagName("input")[5].value;

    if (datename == datename2 && (myPrice=="" || myPrice==0)&&   (mTask.toUpperCase().indexOf("PLANTING") > -1)){
      treearray.push(Number(tr[j].getElementsByTagName("input")[15].value));
    }

  }
  if(treearray!=""){
    var sumtrees= treearray.reduce(function(a,b){return a+b});
  
    let myPrice= tr[i].getElementsByTagName("input")[19].value;
    
    if (sumtrees >= 1200 && (myPrice=="" || myPrice==0)){
      tr[i].getElementsByTagName("input")[18].value = 6;
    }else{
      if (sumtrees >= 1000 && (myPrice=="" || myPrice==0)){
        tr[i].getElementsByTagName("input")[18].value = 4;
      }else{
        if(sumtrees >= 800 && (myPrice=="" || myPrice==0)){
          tr[i].getElementsByTagName("input")[18].value = 2;
        }else{
          tr[i].getElementsByTagName("input")[18].value = 0;
        }
      }
    }
    }
  
	 
           


}

sumtable();
}

//select all table rows

function selectAll(){

  let table= document.getElementById("empTable");

  var rows = table.rows;
  Array.from(rows).forEach(checkAll);

  function checkAll(item, index) {
    if(item.style.display==""){
      item.getElementsByTagName("input")[0].checked=event.target.checked;
    }

    
  }
  
  
}

//summarize table

function sumtable(){


  var myTab= document.getElementById("empTable");
  var tr = myTab.getElementsByTagName("tr");
  var datearray=[];
  var clientarray=[];
  var blockarray=[];
  var blockhaarray=[];
  var taskarray=[];
  var namearray=[];
  var hoursarray=[];
  var ot1array=[];
  var ot2array=[];
  var haarray=[];
  var proratearray=[];
  var adjhaarray=[];
  var haratearray=[];
  var speciesarray=[];
  var treesarray=[];
  var fertarray=[];
  var conesarray=[];
  var hrarray=[];
  var unitarray=[];
  var leadarray=[];
  var trucksarray=[];
  var kmarray=[];
  var remarray=[];


  var td1,td2,td3,td4,td5,td6,td7,td8,td9,td10,td11,td12,td13,td14,td15,td16,td17,td18,td19,td20,td21,td22,td23,td24;
  

  // loop through each row of the table.
        for (i = 1; i < myTab.rows.length; i++){

          if (tr[i].style.display !== "none"){
            // loop through each cell in each column.
            
            //datearray
               
					 td1=tr[i].getElementsByTagName("input")[1];
					
					 var str1= String(datearray);
					 var str2= String(td1.value);

					if (str1.toUpperCase().indexOf(str2.toUpperCase())== -1){
					 
					datearray.push(td1.value);
					}
					
				
				//client array
					 td2=tr[i].getElementsByTagName("input")[2];
					 var str1= String(clientarray);
					 var str2= String(td2.value);
					
					if (str1.toUpperCase().indexOf(str2.toUpperCase()) == -1){
					
					 clientarray.push(td2.value);
					
              }

               //blockarray
                
					 td3=tr[i].getElementsByTagName("input")[3];
					 td4=tr[i].getElementsByTagName("input")[4];
					 var str1= String(blockarray);
					 var str2= String(td3.value);
	

					if (str1.toUpperCase().indexOf(str2.toUpperCase())== -1){
					 
					blockarray.push(td3.value);
					blockhaarray.push(Number(td4.value));
					}
					
					//task array
					 td5=tr[i].getElementsByTagName("input")[5];
					 var str1= String(taskarray);
					 var str2= String(td5.value);
					
					if (str1.toUpperCase().indexOf(str2.toUpperCase()) == -1){
					
					 taskarray.push(td5.value);
					
              }

					//name array
					 td6 =tr[i].getElementsByTagName("input")[6];
					 var str1= String(namearray);
					 var str2= String(td6.value);
					
					
					if (str1.toUpperCase().indexOf(str2.toUpperCase()) == -1){
					
					 namearray.push(td6.value);
					
              }

					//hours array
					 td7=tr[i].getElementsByTagName("input")[7];
					
					 hoursarray.push(Number(td7.value));
					
					
					//ot1 array
					 td8=tr[i].getElementsByTagName("input")[8];
					
					 ot1array.push(Number(td8.value));
					

					//ot2 array
					 td9=tr[i].getElementsByTagName("input")[9];
					
					 ot2array.push(Number(td9.value));


					//ha array
					 td10=tr[i].getElementsByTagName("input")[10];
					
					 haarray.push(Number(td10.value));
					

					//prorate array
					 td11=tr[i].getElementsByTagName("input")[11];
					
					 proratearray.push(Number(td11.value));
					

					//adjha array
					 td12=tr[i].getElementsByTagName("input")[12];
					
					 adjhaarray.push(Number(td12.value));
					

              	//harate array
					 td13=tr[i].getElementsByTagName("input")[13];
					
					 haratearray.push(Number(td13.value));

					//species array
					 td14=tr[i].getElementsByTagName("input")[14];
					 var str1= String(speciesarray);
					 var str2= String(td14.value);
					
					if (str1.toUpperCase().indexOf(str2.toUpperCase()) == -1){
					 speciesarray.push(td14.value);
					}
					
					 //trees array
					 td15=tr[i].getElementsByTagName("input")[15];
					
					 treesarray.push(Number(td15.value));
					
					
					 //fert array
					 td16=tr[i].getElementsByTagName("input")[16];
					
					 fertarray.push(Number(td16.value));
					
					
					 //cones array
					 td17=tr[i].getElementsByTagName("input")[17];
					
					 conesarray.push(Number(td17.value));
					

					 //hr array
					 td18=tr[i].getElementsByTagName("input")[18];
					
					 hrarray.push(Number(td18.value));
					

					 //unit array
					 td19=tr[i].getElementsByTagName("input")[19];
					
					 unitarray.push(Number(td19.value));
					

					//lead array
					 td20=tr[i].getElementsByTagName("input")[20];
					 var str1= String(leadarray);
					 var str2= String(td20.value);
		
	
				
					if (str1.toUpperCase().indexOf(str2.toUpperCase()) == -1){
					
					 leadarray.push(td20.value);
					
              }

					 //trucks array
					 td21=tr[i].getElementsByTagName("input")[21];
					
					 trucksarray.push(Number(td21.value));


					 //km array
					 td22=tr[i].getElementsByTagName("input")[22];
					
					 kmarray.push(Number(td22.value));
    

                // rem array
					 td23=tr[i].getElementsByTagName("input")[23];
					
					 remarray.push(Number(td23.value));

					
            }
           

         }

var formatter = new Intl.NumberFormat('en-US', {
  style: 'currency',
  currency: 'CAD',
  // These options are needed to round to whole numbers if that's what you want.
  //minimumFractionDigits: 0, // (this suffices for whole numbers, but will print 2500.10 as $2,500.1)
  //maximumFractionDigits: 0, // (causes 2500.99 to be printed as $2,501)
});

document.getElementById("sum1").value = datearray.length;
document.getElementById("sum2").value = clientarray.length;
document.getElementById("sum3").value = blockarray.length;
document.getElementById("sum4").value = Number(blockhaarray.reduce(function(a,b){return a + b})).toFixed(2);
document.getElementById("sum5").value = taskarray.length;
document.getElementById("sum6").value = namearray.length;
document.getElementById("sum7").value = Number(hoursarray.reduce(function(a,b){return a + b})).toFixed(2);
document.getElementById("sum8").value = Number(ot1array.reduce(function(a,b){return a + b})).toFixed(2);
document.getElementById("sum9").value = Number(ot2array.reduce(function(a,b){return a + b})).toFixed(2);

if(haarray.length>0){
  document.getElementById("sum10").value = Number(haarray.reduce(function(a,b){return a + b})).toFixed(4);
}

document.getElementById("sum11").value = (proratearray.reduce(function(a,b){return a + b})/proratearray.length).toFixed(4);

document.getElementById("sum12").value =(adjhaarray.reduce(function(a,b){return a + b})).toFixed(4);

var sumprod = 0;
var l= haratearray.length;
         for(var i=0; i<l; i++) {
           sumprod += haratearray[i]*adjhaarray[i];
         }

document.getElementById("sum13").value = formatter.format(Number(sumprod)); //Number(sumprod)toFixed(2);

//(haratearray.reduce(function(r,a,i){return r+a*adjhaarray[i]})/adjhaarray.reduce(function(a,b){return a + b})).toFixed(4);

document.getElementById("sum14").value = speciesarray.length;

document.getElementById("sum15").value = Number(treesarray.reduce(function(a,b){return a + b})).toFixed();

document.getElementById("sum16").value = Number(fertarray.reduce(function(a,b){return a + b})).toFixed();

document.getElementById("sum17").value = Number(conesarray.reduce(function(a,b){return a + b})).toFixed();

//alert(hrarray)
//alert(treesarray)

var sumprod = 0;
var l= hrarray.length;
         for(var i=0; i<l; i++) {
           sumprod += hrarray[i]*treesarray[i];
         }

document.getElementById("sum18").value = formatter.format(sumprod/treesarray.reduce(function(a,b){return a + b}));


if (treesarray.reduce(function(a,b){return a + b})>0){

var sumprod = 0;
var l= hrarray.length;
         for(var i=0; i<l; i++) {
           sumprod += unitarray[i]*treesarray[i];
         }


document.getElementById("sum19").value = formatter.format(sumprod);

}else{

  if (conesarray.reduce(function(a,b){return a + b})>0){

  var sumprod = 0;
  var l= hrarray.length;
         for(var i=0; i<l; i++) {
           sumprod += unitarray[i]*conesarray[i];
         }

  document.getElementById("sum19").value = formatter.format(sumprod);


  //}else{
  //document.getElementById("sum19").value =0;
  }
}

document.getElementById("sum20").value = leadarray.length;
document.getElementById("sum21").value = trucksarray.reduce(function(a,b){return a + b});
document.getElementById("sum22").value = kmarray.reduce(function(a,b){return a + b});
document.getElementById("sum23").value = Number(remarray.reduce(function(a,b){return a + b})/remarray.length).toFixed(2);

colourtable();
settabledata();
//(arr1.reduce(function(r,a,i){return r+a*arr2[i]},0));

}

//calculate table rem ha- might not be used!

function calculatetablerem(){

    var myTab= document.getElementById("empTable");
    var tr = myTab.getElementsByTagName("tr");
    var td3,td3a,td4,td10,td23;


    for (i=1; i<myTab.rows.length; i++){
      
    var arrsum=[];

      td3= tr[i].getElementsByTagName("input")[3];

      td4= tr[i].getElementsByTagName("input")[4];
      
      td10= tr[i].getElementsByTagName("input")[10];

      td23= tr[i].getElementsByTagName("input")[23];
      
      //if(td23.value>0){
          //tr[i+1].getElementsByTagName("input")[10].value= //td23.value;
          //var remainder= Number(td10.value)-Number(td23.value);
          //tr[i+2].getElementsByTagName("input")[10].value = //Number(tr[i+2].getElementsByTagName("input")[10].value)+ //Number(remainder);
          
        //}
 

      for (j=1; j<myTab.rows.length; j++){
   
        td3a= tr[j].getElementsByTagName("input")[3];
        

//alert(tr[j].getElementsByTagName("input")[10].value)
            
//alert(td23.value)

        
        
        td10= tr[j].getElementsByTagName("input")[10];
        

        if (td3a.value==td3.value){
          
            arrsum.push(Number(td10.value));
          
        }
        
  
      }

        tr[i].getElementsByTagName("input")[23].value = td4.value- arrsum.reduce(function(a,b) {return a+b});

    }
  
  }

//get block list

function getblocklist(obj){
  var myTab= document.getElementById("empTable");
  var myrow= obj.parentNode.parentNode.rowIndex;
  var mycell= myTab.rows[myrow].cells[4]
  var myinput= mycell.firstChild


  var myblocks= document.getElementById("Block");
  for(i=0; i< myblocks.length; i++){

    var opt= document.getElementById("Block").options[i];
      if(opt.text==obj.value){
        myinput.value= opt.value;
        
       
      }
    
  }


}

//remove duplicate rows

      function removeduplicates(){



        var myTab= document.getElementById("empTable")
        var myrows= myTab.rows.length
        var tr = myTab.getElementsByTagName("tr");
        var i,c,j,d;
        var str1="";
        var str2="";

        for(i = 1; i < myrows; i++){

          str1="";
          for(c=1; c <myTab.rows[0].cells.length; c++){
            var td= tr[i].getElementsByTagName("input")[c];

            if(isNaN(td.value)==false){
              var myVal= Number(td.value);
            }else{
              var myVal= td.value;
            }
            
            
			   str1 = str1+String(myVal).trim();
          }

          for(j = i+1; j< myrows; j++){
          str2="";
            for(d=1; d <myTab.rows[0].cells.length; d++){
              var td2=tr[j].getElementsByTagName("input")[d];
              
              if(isNaN(td2.value)==false){
                var myVal2= Number(td2.value);
              }else{
                var myVal2= td2.value;
              }

			     str2= str2 + String(myVal2).trim();
            }


            if(str2==str1){

              
              myTab.deleteRow(j);
              myrows=myrows-1;
             
             
              
             
              
             
            }
         
          
          }
        
        }
      settabledata();
      }



//colour table by block and date
      
function colourtable(){

  var myTab= document.getElementById("empTable")
  var myrows= myTab.rows.length
  var tr = myTab.getElementsByTagName("tr");
  var i,c,j,d;
  var str1="";
  var str2="";

  for (c=0; c< myTab.rows[1].cells.length; c++){

      tr[1].getElementsByTagName("td")[c].style.backgroundColor="lightblue";
    }

  for(i = 1; i < myTab.rows.length-1; i++){


      str1="";
          
      str1= tr[i].getElementsByTagName("input")[1].value + tr[i].getElementsByTagName("input")[3].value;
          

   
      str2="";
      str2= tr[i+1].getElementsByTagName("input")[1].value + tr[i+1].getElementsByTagName("input")[3].value;

      if(str2==str1){
      
        
        if (tr[i].getElementsByTagName("td")[0].style.backgroundColor=="lightblue"){
          
          for (c=0; c< myTab.rows[1].cells.length; c++){
            tr[i+1].getElementsByTagName("td")[c].style.backgroundColor="lightblue";
          }

        }else{
          
          for (c=0; c< myTab.rows[1].cells.length; c++){
            tr[i+1].getElementsByTagName("td")[c].style.backgroundColor="rgb(150,200,120)";
          }

        }
      }else{
         if (tr[i].getElementsByTagName("td")[0].style.backgroundColor=="lightblue"){
          
           for (c=0; c< myTab.rows[1].cells.length; c++){
             tr[i+1].getElementsByTagName("td")[c].style.backgroundColor="rgb(150,200,120)";
           }

        }else{
          for (c=0; c< myTab.rows[1].cells.length; c++){
            tr[i+1].getElementsByTagName("td")[c].style.backgroundColor="lightblue";
          }
        }
      
      }

   }
   settabledata();

  
}

    // function to extract and submit table data. maybe not used

    /*var objarray=[];
    var tablearray =[];
    function submit() {
        var myTab = document.getElementById('empTable');
        var arrValues = new Array();
        

        // loop through each row of the table.
        for (row = 1; row < myTab.rows.length - 1; row++) {
            // loop through each cell in a row.
            for (c = 1; c < myTab.rows[row].cells.length; c++) {
                
                var element = myTab.rows.item(row).cells[c];
                
					 var tr = myTab.getElementsByTagName("tr");
                
					 var td= tr[row].getElementsByTagName("input")[c];

					 objarray.push(td);
					 tablearray.push(td.value);
					
					
					
					

<!--
                if (element.childNodes[0].getAttribute('type') == 'input') {
                    //arrValues.push(","+ element.childNodes[0].value + ",");

                }
-->
            }

        }
        
        // finally, show the result in the console.
        
    }*/

//global

//save main table as object

function settabledata(){

  let myTable= document.getElementById("empTable")

  function Day(Date, Client, Block, BlockHa, Task, Name, Hours, OT1, OT2, Ha, ProRate, AdjHa, HaRate, Species, Trees, Fert, Cones, $_Hr, $_Unit, CrewLead, Trucks, DailyKm, RemHa, Comments) {
  this.Date=Date;
  this.Client=Client;
  this.Block=Block;
  this.BlockHa=BlockHa;
  this.Task=Task;
  this.Name=Name;
  this.Hours=Hours;
  this.OT1=OT1;
  this.OT2=OT2;
  this.Ha=Ha;
  this.ProRate=ProRate;
  this.AdjHa=AdjHa;
  this.HaRate=HaRate;
  this.Species=Species;
  this.Trees=Trees;
  this.Fert=Fert;
  this.Cones=Cones;
  this.$_Hr=$_Hr;
  this.$_Unit=$_Unit;
  this.CrewLead=CrewLead;
  this.Trucks=Trucks;
  this.DailyKm=DailyKm;
  this.RemHa=RemHa;
  this.Comments=Comments;
}

var arrDays=[];

  for(i=1;i<myTable.rows.length; i++){
    var tr= myTable.rows[i];
    var input= tr.getElementsByTagName("input");
    var day = new Day(input[1].value, input[2].value, input[3].value, input[4].value, input[5].value, input[6].value, input[7].value, input[8].value, input[9].value, input[10].value, input[11].value, input[12].value, input[13].value, input[14].value, input[15].value, input[16].value, input[17].value, input[18].value, input[19].value, input[20].value, input[21].value, input[22].value, input[23].value, input[24].value);
    arrDays.push(day)
  }

//var t= document.getElementById("empTable").innerHTML

   if(myTable.rows.length>1){
      var d= JSON.stringify(arrDays);
    }else{
      var d="";
    }

//localStorage.setItem("table",t);


localStorage.setItem('datalist',d);

}



//save data to storage

/*function settabledata(){

var objarray=[];
var tablearray=[];


var myTab = document.getElementById('empTable');
        var arrValues = new Array();
        


        // loop through each row of the table.
        for (row = 1; row < myTab.rows.length; row++) {
         
            // loop through each cell in a row.
            for (c = 1; c < myTab.rows[row].cells.length; c++) {
                
                var element = myTab.rows.item(row).cells[c];
                
					 var tr = myTab.getElementsByTagName("tr");
                
					 var td= tr[row].getElementsByTagName("input")[c];
					  
					 objarray.push(td);
					 tablearray.push(td.value);

        }
 
  }


var t= document.getElementById("empTable").innerHTML

   if(myTab.rows.length>1){
      var d= tablearray;
    }else{
      var d="";
    }


localStorage.setItem("table",t);
 localStorage.setItem("data",d);
}*/

//Get Lead Client Task

function getotherdata(){

document.getElementById("Lead").value=localStorage.getItem("myLead");

document.getElementById("Name").value=localStorage.getItem("myLead");


if(localStorage.getItem("myCrew")!= null){
let myCrewList=JSON.parse(localStorage.getItem("myCrew"));

  for(i=0; i< document.getElementById("Name").length; i++){

    let o = document.getElementById("Name").options[i];
    if ( myCrewList.indexOf( o.value ) != -1 ){
      o.selected = true;
    }
  }
}

document.getElementById("Start").value=localStorage.getItem("myStart");
document.getElementById("End").value=localStorage.getItem("myEnd");
document.getElementById("Task").value=localStorage.getItem("myTask");
document.getElementById("Client").value=localStorage.getItem("myClient");

  if(localStorage.getItem("myHourly")!= null){
    if(localStorage.getItem("myHourly")=="false"){

      document.getElementById("PieceRate").checked= true;
    }else{
      document.getElementById("Hourly").checked= true;
    }
    proArray();
  }

  if(localStorage.getItem("myCoop")!= null){
    if(localStorage.getItem("myCoop")=="false"){
      document.getElementById("Individual").checked= true;
    }else{
      document.getElementById("Coop").checked= true;
    }
  }

  if(localStorage.getItem("myBlock")!=null){

    let myTable=document.getElementById("BlockTable");
    for(i=1; i< myTable.rows.length; i++){
      let myRow= myTable.rows[i];
      let myCheck= myRow.getElementsByTagName("input")[0];
      let myBlockStore= JSON.parse(localStorage.getItem("myBlock"));

      if(myBlockStore.indexOf(myCheck.id) !=-1){
        myCheck.checked= true;
//alert(myCheck.parentNode.parentNode.getElementsByTagName('input').length)
      let inputs= myCheck.parentNode.parentNode.getElementsByTagName('input');

        for (x=1; x< inputs.length; x++){
          
          inputs[x].style.backgroundColor="rgb(255,255,200)";
        }
        
      }
    }
    
  }

}

//get table data from storage

/*function gettabledata(){


var rt= localStorage.getItem("table");

var rd= localStorage.getItem("data");
var table= document.getElementById("empTable");

if ((rd != null || rd != undefined) && (rt != null || rt != undefined)){
table.innerHTML = rt;



var myTab = document.getElementById('empTable');


        var arr = rd.split(",");
        var l=0;
        

        // loop through each row of the table.
        for (row = 1; row < myTab.rows.length; row++) {
            // loop through each cell in a row.
            for (c = 1; c < myTab.rows[row].cells.length; c++) {
                
                var element = myTab.rows.item(row).cells[c];
                
					 var tr = myTab.getElementsByTagName("tr");
                
					 var td= tr[row].getElementsByTagName("input")[c];
                td.value=arr[l];
                l++;
					 
					}
			}

  }
  sumtable();
}*/

//get data from JSON

function gettabledata(){

//var rt= localStorage.getItem("table");
if(localStorage.getItem("datalist")==""){
  var rd = null
}else{  
  var rd= JSON.parse(localStorage.getItem("datalist"));
}
var table= document.getElementById("empTable");


if (rd != null || rd != undefined){
//table.innerHTML = rt;

//let dataObject= Array.from(rd)[0]


var objArray= Array.from(rd)


createRows(objArray)
					 

//var myTab = document.getElementById('empTable');

//var mydata= Object.keys(rd)


        //var arr = (mydata)
        //var l=0;
        

        // loop through each row of the table.
        /*for (row = 1; row < myTab.rows.length; row++) {
            // loop through each cell in a row.
            for (c = 1; c < myTab.rows[row].cells.length; c++) {
                
                var element = myTab.rows.item(row).cells[c];
                
					 var tr = myTab.getElementsByTagName("tr");
                
					 var td= tr[row].getElementsByTagName("input")[c];
					
					  let myValue= (Object.values(objArray[row-1])[c-1])

					
                td.value= String(myValue) //arr[l];
                //l++;
					 
					}
			}*/

  }
  removeduplicates();
  sumtable();
  colourtable();
}

function createRows(objArray){


let BlockTable= document.getElementById("BlockTable");

var objlength=(objArray.length)

//create table rows

var tbodyRef = document.getElementById('empTable').getElementsByTagName('tbody')[0];

        for (i=0; i<objlength; i++){
        var empTab = document.getElementById('empTable');
        
        var rowCnt = tbodyRef.rows.length;    // get the number of rows.
          

        var tr = tbodyRef.insertRow(0); // table row.
        //tr = empTab.insertRow(rowCnt);

        var arrHead= Array.from(document.getElementById("empTable").rows[0].getElementsByTagName("input"));

arrHead.shift()//take off extra input in first column of header

//crazy
        for (var c = 0; c < arrHead.length; c++) {


            var td = document.createElement('td'); 
              
//TABLE DEFINITION.
            td = tr.insertCell(c);
                 
       

            if (c == 0) {   // if its the first column of the table.
                // add a button control.
                //var button = document.createElement('input');
                var check1= document.createElement('input');


                check1.setAttribute('id', 'Check'+i);
                check1.setAttribute('type', 'checkbox');
                //check1.setAttribute('style','align-center');
                check1.setAttribute('height','40px');
                check1.setAttribute('width','40px');
                check1.setAttribute('onclick','highlightRow(event.target)')

                
               
                td.appendChild(check1);


               
            }

            

            if (c == 1) {

            
                var input0 = document.createElement("input");
                input0.setAttribute('type','text');
                input0.name = "date" + i;
                input0.id = "date" + i;
                input0.setAttribute('class','full');
                input0.value= Object.values(objArray[i])[c-1];

					  
					td.appendChild(input0);
                
					
				}
				if (c == 2) {
				
var input1 = document.createElement("input");
                input1.setAttribute('type','text');
                input1.name = "client" + i;
                input1.id = "client" + i;
                input1.setAttribute('class','full');
                input1.setAttribute('list','clientlist');
                input1.value= Object.values(objArray[i])[c-1];


var list1 = document.createElement("datalist");
                list1.id="clientlist";
 
					  
					td.appendChild(input1);
					td.appendChild(list1);
					
					for (x= 0; x< document.getElementById("Client").length; x++){
                 var el= document.getElementById("Client").options[x];
                 var opt= document.createElement("option");
                 opt.value=el.value;

                 list1.appendChild(opt);
               }
              
                
				}
				if (c == 3) {
				
var input2= document.createElement("input");
                input2.setAttribute('type','text');
                input2.name = "block" + i;
                input2.id = "block" + i;
                input2.value=  Object.values(objArray[i])[c-1];
                input2.setAttribute('class','full');
                input2.setAttribute('list','blocklist');
                input2.setAttribute('onblur','getblocklist(this)');
                //td.setAttribute('class','sticky');

var list2 = document.createElement("datalist");
                list2.id="blocklist";
					  
					td.appendChild(input2);
					td.appendChild(list2);
					
					
					
					for (x= 0; x< length; x++){
					   var blockrow= BlockTable.rows[x]
                 var el= blockrow.getElementsByTagName("input")[1];
                 var opt= document.createElement("option");
                 opt.value=el.value;
                

                 list2.appendChild(opt);
               }
                
				}
				if (c == 4) {
				
var input3 = document.createElement("input");
                input3.setAttribute('type','number');
                //input3.setAttribute('step','0.01');
                input3.name = "blockha" + i;
                input3.id = "blockha" + i;
                input3.value=  Object.values(objArray[i])[c-1];
                input3.setAttribute('class','full');
                
					  
					td.appendChild(input3);
					
					

            }
            if (c == 5) {
           
var input4 = document.createElement("input");
                input4.setAttribute('type','text');
                input4.name = "task" + i;
                input4.id = "task" + i;
					  input4.value =  Object.values(objArray[i])[c-1];
					  input4.setAttribute('class','full');
                 input4.setAttribute('list','tasklist');

                var list4 = document.createElement("datalist");
                list4.id="tasklist";

                td.appendChild(input4);
                td.appendChild(list4);

					
					for (x= 0; x< document.getElementById("Task").length; x++){
                 var el= document.getElementById("Task").options[x];
                 var opt= document.createElement("option");
                 opt.value=el.value;
                 list4.appendChild(opt);
               }
               
            }
            if (c == 6) {
             
var input5 = document.createElement("input");
                input5.setAttribute('type','text');
                input5.name = "name" + i;
                input5.id = "name" + i;
					  input5.value =  Object.values(objArray[i])[c-1];
					 input5.setAttribute('class','full');
                 input5.setAttribute('list','crewlist');
					  
					  var list5 = document.createElement("datalist");
                list5.id="crewlist";
                
                
					  td.setAttribute('class','sticky');
                td.appendChild(input5);
                td.appendChild(list5);
               
                for (x= 0; x< document.getElementById("Name").length; x++){
                 var el= document.getElementById("Name").options[x];
                 var opt= document.createElement("option");
                 opt.value=el.value;
                 list5.appendChild(opt);
                }
                

             }
             if (c == 7) {

var input6 = document.createElement("input");
                input6.setAttribute('type','number');
                //input6.setAttribute('step','0.25');
                input6.name = "hours" + i;
                input6.id = "hours" + i;
                input6.setAttribute('class','full');
                input6.value=  Object.values(objArray[i])[c-1];
					

					td.appendChild(input6);
					
					}
					if (c == 8) {
					
var input7 = document.createElement("input");
                input7.setAttribute('type','number');
                input7.name = "ot1" + i;
                input7.id = "ot1" + i;
                //input7.setAttribute('step','0.25');
					  input7.value = Object.values(objArray[i])[c-1];
					  input7.setAttribute('class','full');
					
					td.appendChild(input7);
					}
					if (c == 9) {
					
var input8 = document.createElement("input");
                input8.setAttribute('type','number');
                input8.name = "ot2" + i;
                input8.id = "ot2" + i;
                //input8.setAttribute('step','0.25');
					  input8.value = Object.values(objArray[i])[c-1];
					  input8.setAttribute('class','full');
					
					td.appendChild(input8);
					
					}
					if (c == 10) {
					
var input9 = document.createElement("input");
                input9.setAttribute('type','number');
                //input9.setAttribute('step','0.001');
                input9.name = "ha" + i;
                input9.id = "ha" + i;
					  input9.setAttribute('class','full');
					  input9.setAttribute('onclick','updateRem()')
					  input9.setAttribute('onchange','newRem(event.target.value)')
				
				     input9.value= Number(Object.values(objArray[i])[c-1]).toFixed(6);
					  
					
					td.appendChild(input9);
					}
					if (c == 11) {

					
var input10 = document.createElement("input");
                input10.setAttribute('type','number');
                input10.name = "prorate" + i;
                //input10.setAttribute('step','0.05');
                input10.id = "prorate" + i;
					  input10.setAttribute('class','full');
					  input10.value= Object.values(objArray[i])[c-1];
			
					td.appendChild(input10);
					
					}
					if (c == 12) {

var input11 = document.createElement("input");
                input11.setAttribute('type','number');
                //input11.step= "0.001";
                input11.name = "adjha" + i;
                input11.id = "adjha" + i;
					  input11.value = Number(Object.values(objArray[i])[c-1]).toFixed(6);
					  input11.readOnly= true;
					  input11.setAttribute('class','full');
					
					td.appendChild(input11);
					}
					if (c == 13) {
					
var input12 = document.createElement("input");
                input12.setAttribute('type','number');
                //input12.step= "0.01";
                input12.name = "harate" + i;
                input12.id = "harate" + i;
                input12.setAttribute('class','full');
                input12.value= Number(Object.values(objArray[i])[c-1]).toFixed(2);
               
					
					td.appendChild(input12);
					
					}
					if (c == 14) {
					
var input13 = document.createElement("input");
                input13.setAttribute('type','text');
                input13.name = "species" + i;
                input13.id = "species" + i;
                input13.setAttribute('class','full');
                input13.setAttribute('list','rklist');
                input13.value= Object.values(objArray[i])[c-1];
					 
					
					var list13 = document.createElement("datalist");
               list13.id="rklist";
					
					td.appendChild(input13);
					td.appendChild(list13);
					
					for (x= 0; x< document.getElementById("RK").length; x++){
                 var el= document.getElementById("RK").options[x];
                 var opt= document.createElement("option");
                 opt.value=el.value;

                 list13.appendChild(opt);
               }
					
					
					}
					if (c == 15) {
					
var input14 = document.createElement("input");
                input14.setAttribute('type','number');
                input14.name = "trees" + i;
                input14.id = "trees" + i;
                input14.setAttribute('class','full');
                input14.value= Object.values(objArray[i])[c-1];
					  input14.placeholder=input5.value
				
					td.appendChild(input14);
					}
					if (c == 16) {
					
var input15 = document.createElement("input");
                input15.setAttribute('type','number');
                input15.name = "fert" + i;
                input15.id = "fert" + i;
					  input15.setAttribute('class','full');
					  input15.value= Object.values(objArray[i])[c-1];
					
			
					input15.placeholder= input5.value;
					td.appendChild(input15);
					
					}
					if (c == 17) {
					
var input16 = document.createElement("input");
                input16.setAttribute('type','number');
                input16.name = "cones" + i;
                input16.id = "cones" + i;
					  input16.setAttribute('class','full');
					  input16.value= Object.values(objArray[i])[c-1];
					
	  
					input16.placeholder= input5.value;
					td.appendChild(input16);
					}
					if (c == 18) {
					
var input17 = document.createElement("input");
                input17.setAttribute('type','number');
                //input17.setAttribute('step','0.01');
                input17.name = "$_hr" + i;
                input17.id = "$_hr" + i;
					  input17.value = Object.values(objArray[i])[c-1];
					  input17.readOnly= true;
					  input17.setAttribute('class','full');
					
					td.appendChild(input17);
					}
					if (c == 19) {
				
					
var input18 = document.createElement("input");
                input18.setAttribute('type','number');
                //input18.setAttribute('step','0.005');
                input18.name = "$_unit" + i;
                input18.id = "$_unit" + i;
                input18.setAttribute('onchange','calculateplanting()');
  
					input18.value = Object.values(objArray[i])[c-1];
					//input18.style.border="2px solid rgb(255,0,0)";

					  input18.setAttribute('class','full');
					
					td.appendChild(input18);
					}
					if (c == 20) {
					
var input19 = document.createElement("input");
                input19.setAttribute('type','text');
                input19.name = "lead" + i;
                input19.id = "lead" + i;
					  input19.value = Object.values(objArray[i])[c-1];
					  input19.setAttribute('class','full');
					  input19.setAttribute('list','leadlist');
					
					var list19 = document.createElement("datalist");
               list19.id="leadlist";
					
					td.appendChild(input19);
					td.appendChild(list19);
					
					for (x= 0; x< document.getElementById("Lead").length; x++){
                 var el= document.getElementById("Lead").options[x];
                 var opt= document.createElement("option");
                 opt.value=el.value;

                 list19.appendChild(opt);
               }
					
					
					}
					if (c == 21) {
					
					
var input20 = document.createElement("input");
                input20.setAttribute('type','number');
                input20.name = "trucks" + i;
                input20.id = "trucks" + i;
                input20.setAttribute('class','full');
                input20.value= Object.values(objArray[i])[c-1];
					  
					
					td.appendChild(input20);
					}
					if (c == 22) {
					
var input21 = document.createElement("input");
                input21.setAttribute('type','number');
                //input21.setAttribute('step','0.1');
                input21.name = "kmd" + i;
                input21.id = "kmd" + i;
                input21.setAttribute('class','full');
                input21.value= Object.values(objArray[i])[c-1];
					  
					
					td.appendChild(input21);
					}
					if (c == 23) {
				
var input22 = document.createElement("input");
                input22.setAttribute('type','number');
                //input22.setAttribute('step','0.01');
                input22.name = "remha" + i;
                input22.id = "remha" + i;
					  input22.setAttribute('class','full');
					  input22.setAttribute('readonly','true');
			
					  input22.value = Object.values(objArray[i])[c-1];
					
					td.appendChild(input22);
					
					}
					if (c == 24) {
				
var input23 = document.createElement("input");
                input23.setAttribute('type','text');
                input23.name = "comments" + i;
                input23.id = "comments" + i;
                input23.setAttribute('class','full');
					  
					if (i==0){
					input23.value = Object.values(objArray[i])[c-1];
					}
					td.appendChild(input23);
					


                
            }//end forc
        }//end fori
  }

}




//clear table data from storage

function cleartabledata(){
  if (confirm("Confirm Delete?")) {
    localStorage.removeItem('datalist')
    localStorage.removeItem('table')
  }
}

//download data to browser


function downloaddata(){

let Lead= document.getElementById("Lead");
let Start= document.getElementById("Start");
let End= document.getElementById("End");

if(Lead.value==""||Start.value==""||End.value==""){
  alert("Please fill out information for the pay period")
}else{

var filename= String(Lead.value + "_" + Start.value+ "-" + End.value + ".csv")

/*var inputs = document.getElementById('cont').getElementsByTagName('input');

var data = '';

var myTab = document.getElementById('empTable');
        var arrValues = new Array();
        


        // loop through each row of the table.
        for (row = 0; row < myTab.rows.length; row++) {
            // loop through each cell in a row.
             var rowdata='';
             
             var sep = '';

            for (c = 1; c < myTab.rows[row].cells.length; c++) {
                
                var element = myTab.rows.item(row).cells[c];
                
					 var tr = myTab.getElementsByTagName("tr");
					
					if (row==0){
					
					  var td= element.innerHTML
					  var x= td.indexOf("<");
					  var y= td.slice(0,x);
					
					
					
					  rowdata += sep + y;
					  sep = ',';
					
					}else{
                
					 var td= tr[row].getElementsByTagName("input")[c];
					 
					
					
					rowdata += sep + td.value
					sep = ',';
            
               }
        }
       
        if (rowdata != ''){
        data += rowdata + '\r\n'
        }
    }
data1= String(data)*/


// (document.querySelector("html").innerHTML) 
//let blob = new Blob([data1], {type: 'text/html'});



  let myTable= document.getElementById("empTable")

  function Day(Date, Client, Block, BlockHa, Task, Name, Hours, OT1, OT2, Ha, ProRate, AdjHa, HaRate, Species, Trees, Fert, Cones, $_Hr, $_Unit, CrewLead, Trucks, DailyKm, RemHa, Comments) {
  this.Date=Date;
  this.Client=Client;
  this.Block=Block;
  this.BlockHa=BlockHa;
  this.Task=Task;
  this.Name=Name;
  this.Hours=Hours;
  this.OT1=OT1;
  this.OT2=OT2;
  this.Ha=Ha;
  this.ProRate=ProRate;
  this.AdjHa=AdjHa;
  this.HaRate=HaRate;
  this.Species=Species;
  this.Trees=Trees;
  this.Fert=Fert;
  this.Cones=Cones;
  this.$_Hr=$_Hr;
  this.$_Unit=$_Unit;
  this.CrewLead=CrewLead;
  this.Trucks=Trucks;
  this.DailyKm=DailyKm;
  this.RemHa=RemHa;
  this.Comments=Comments;
}

var arrDays=[];

  for(i=1;i<myTable.rows.length; i++){

    
    var tr= myTable.rows[i];
    var input= tr.getElementsByTagName("input");

    let end= new Date(End.value).getTime();
    let start= new Date(Start.value).getTime();
    let mydate= new Date(input[1].value).getTime();

    if(mydate >= start && end >= mydate){

    var day = new Day(input[1].value, input[2].value, input[3].value, input[4].value, input[5].value, input[6].value, input[7].value, input[8].value, input[9].value, input[10].value, input[11].value, input[12].value, input[13].value, input[14].value, input[15].value, input[16].value, input[17].value, input[18].value, input[19].value, input[20].value, input[21].value, input[22].value, input[23].value, input[24].value);
    arrDays.push(day)
    //}else{
      
      //return alert("Table data is outside pay period range. No data submitted!")
    }
    
  }

    if(arrDays.length==0){
    
       alert("Table data is outside pay period range. No data submitted!");
       return;
     }else{
  

    let data1= Papa.unparse(arrDays)


    const blob = new Blob([data1], {type: 'text/csv;base64'});


    link.href =  URL.createObjectURL(blob)

//data:application/csv;charset=utf-8

//link.href= "data:application/octet-stream," + data1
    link.setAttribute('download', filename);
    
    URL.revokeObjectURL(blob);
    

         
     }
 

    
    
}
}

/*

/////////////
Papa.parse(fileInput.files[0], {
	complete: function(results) {
		console.log(results);
	}
});
*/
////////////////////

//parse csv and create task list

  function openTaskFile(event) {

    var input = event.target;

    var reader = new FileReader();
    reader.onload = function(){
      var text = reader.result;

//var arrdata= Papa.parse(data).data

var results = Papa.parse(text, {
   header: true,
   dynamicTyping: true,
	delimiter: "",// auto-detect
	newline: "",	// auto-detect
	

});

let taskObj= results.data;

let Jtask= JSON.stringify(taskObj)

 

localStorage.setItem('taskstore',Jtask);
    
     document.getElementById("Tsearch").value="";
     addtasks();

      console.log(reader.result.substring(0, 200));
    };
    reader.readAsText(input.files[0]);
    
  };

//parse csv and create name list

  function openNameFile(event) {

    var input = event.target;

    var reader = new FileReader();
    reader.onload = function(){
      var text = reader.result;

//var arrdata= Papa.parse(data).data

var results = Papa.parse(text, {
   header: true,
   dynamicTyping: true,
	delimiter: "",// auto-detect
	newline: "",	// auto-detect
	

});

let nameObj= results.data;

let Jname= JSON.stringify(nameObj)

 

localStorage.setItem('namestore',Jname);
    
     document.getElementById("Nsearch").value="";
     addnames();

      console.log(reader.result.substring(0, 200));
    };
    reader.readAsText(input.files[0]);
    
  };

//parse csv and create lead list

  function openLeadFile(event) {

    var input = event.target;

    var reader = new FileReader();
    reader.onload = function(){
      var text = reader.result;

//var arrdata= Papa.parse(data).data

var results = Papa.parse(text, {
   header: true,
   dynamicTyping: true,
	delimiter: "",// auto-detect
	newline: "",	// auto-detect
	

});

let leadObj= results.data;

let Jlead= JSON.stringify(leadObj)

localStorage.setItem('leadstore',Jlead);
    
     //document.getElementById("Nsearch").value="";
     addLeads();

      console.log(reader.result.substring(0, 200));
    };
    reader.readAsText(input.files[0]);
    
  };

//parse csv and create client list

  function openClientFile(event) {

    var input = event.target;

    var reader = new FileReader();
    reader.onload = function(){
      var text = reader.result;

//var arrdata= Papa.parse(data).data

var results = Papa.parse(text, {
   header: true,
   dynamicTyping: true,
	delimiter: "",// auto-detect
	newline: "",	// auto-detect
	

});

let clientObj= results.data;

let Jclient= JSON.stringify(clientObj)

localStorage.setItem('clientstore',Jclient);
    
     document.getElementById("Csearch").value="";
     addClients();

      console.log(reader.result.substring(0, 200));
    };
    reader.readAsText(input.files[0]);
    
  };

//parse csv and create rk list

  function openRKFile(event) {

    var input = event.target;

    var reader = new FileReader();
    reader.onload = function(){
      var text = reader.result;

//var arrdata= Papa.parse(data).data

var results = Papa.parse(text, {
   header: true,
   dynamicTyping: true,
	delimiter: "",// auto-detect
	newline: "",	// auto-detect
	

});

let rkObj= results.data;

let Jrk= JSON.stringify(rkObj)

localStorage.setItem('rkstore',Jrk);
    
     document.getElementById("RKsearch").value="";
     addRKs();

      console.log(reader.result.substring(0, 200));
    };
    reader.readAsText(input.files[0]);
    
  };

function hideThis(){
  let div = document.getElementById("divFiles");
  
    if (document.getElementById("checkHide").checked==false){
      div.style.display="none";
    }else{
      div.style.display="";
    }
   
  /*let c = div.getElementsByTagName("div")
  

  for (i=0; i<c.length; i++){

    if(c[i].style.display=="none"){
      c[i].style.display="";
    }else{
      c[i].style.display="none";
    }
  }*/
}

function addClients(){

var teststring="";

var select= document.getElementById("Client")
var l= select.length
  for (j=l; j>=0; j--){
    if (j<l){
      if(select.options[j].selected == false){
        select.remove(j);
      }else{
        teststring += select.options[j].text;
      }
    }
  }

  if(localStorage.getItem("clientstore") != null){
    var values = JSON.parse(localStorage.getItem("clientstore"));


//var el = document.createElement("option")

//el.text = "";

//el.value = "";

//document.getElementById("Name").add(el);

    for (i = 0; i < values.length; i++) {
      if(values[i].Client != null){
        var str = String(values[i].Client).trim();
        var opt = String(values[i].Client).trim();
        var el = document.createElement("option")
        el.text = opt;
        el.value = opt;

       }

      var filter= document.getElementById("Csearch").value;


      if (filter !== ""){

        if (opt.toLowerCase().startsWith(filter.toLowerCase())){
          if (teststring.toUpperCase().indexOf(opt.toUpperCase()) == -1){
            document.getElementById("Client").add(el);
          }
        }
      }else{
        if (teststring.toUpperCase().indexOf(opt.toUpperCase()) == -1){
          document.getElementById("Client").add(el);
        }
      }

    }

    var sel= document.getElementById("Client")

    var cnt = 0;
    for (var i = 0; i < sel.options.length; i++) {
      if (sel.options[i].selected) {
        cnt++;
      }
    }


    if(document.getElementById("Client").length - cnt ==0){
      var x= prompt("Client not found, please enter");
  //var y= prompt("Please enter block ha");
  
      var opt = x;
  //var ha = y;
      var el = document.createElement("option")
      el.text = opt;
      el.value = opt;

      document.getElementById("Client").add(el);

//create new task object and save to storage
      let newObj={Client:x}
      values.push(newObj)


      localStorage.setItem('clientstore',JSON.stringify(values))

    }
  }

}

function addRKs(){

var teststring="";

var select= document.getElementById("RK")
var l= select.length
  for (j=l; j>=0; j--){
    if (j<l){
      if(select.options[j].selected == false){
        select.remove(j);
      }else{
        teststring += select.options[j].text;
      }
    }
  }

  if(localStorage.getItem("rkstore") != null){
    var values = JSON.parse(localStorage.getItem("rkstore"));


//var el = document.createElement("option")

//el.text = "";

//el.value = "";

//document.getElementById("Name").add(el);

    for (i = 0; i < values.length; i++) {
      if(values[i].RK != null){
        var str = String(values[i].RK).trim();
        var opt = String(values[i].RK).trim();
        var el = document.createElement("option")
        el.text = opt;
        el.value = opt;

       }

    var filter= document.getElementById("RKsearch").value;


      if (filter !== ""){

        if (opt.toLowerCase().startsWith(filter.toLowerCase())){
          if (teststring.toUpperCase().indexOf(opt.toUpperCase()) == -1){
            document.getElementById("RK").add(el);
          }
        }
      }else{
        if (teststring.toUpperCase().indexOf(opt.toUpperCase()) == -1){
          document.getElementById("RK").add(el);
        }
      }

    }

    var sel= document.getElementById("RK")

    var cnt = 0;
    for (var i = 0; i < sel.options.length; i++) {
      if (sel.options[i].selected) {
        cnt++;
      }
    }


    if(document.getElementById("RK").length - cnt ==0){
      var x= prompt("RK not found, please enter");
  //var y= prompt("Please enter block ha");
  
      var opt = x;
  //var ha = y;
      var el = document.createElement("option")
      el.text = opt;
      el.value = opt;

      document.getElementById("RK").add(el);

//create new task object and save to storage
      let newObj={RK:x}
      values.push(newObj)


      localStorage.setItem('rkstore',JSON.stringify(values))

    }
  }

}

//add leads

function addLeads(){
if(localStorage.getItem("leadstore") != null){
  var values = JSON.parse(localStorage.getItem("leadstore"))//.     Array.from(JSON.parse(localStorage.getItem("leadstore")));
  let objKey= Object.keys(JSON.parse(localStorage.getItem("leadstore"))[0])


//alert(Object.keys(leadObj[0]))


//var el = document.createElement("option")

//el.text = "";

//el.value = "";

//document.getElementById("Name").add(el);

  for (i = 0; i < values.length; i++) {
    if(values[i].Name != null){
      var str = String(values[i].Name).trim();
      var opt = String(values[i].Name).trim();
      var el = document.createElement("option")
      el.text = opt;
      el.value = opt;

     }


document.getElementById("Lead").add(el);
    }
  }
}


//add employees

function addnames(){

var teststring="";

var select= document.getElementById("Name")
var l= select.length
  for (j=l; j>=0; j--){
    if (j<l){
      if(select.options[j].selected == false){
        select.remove(j);
      }else{
        teststring += select.options[j].text;
      }
    }
  }

if(localStorage.getItem("namestore") !=null){
  var values = JSON.parse(localStorage.getItem("namestore"));


//var el = document.createElement("option")

//el.text = "";

//el.value = "";

//document.getElementById("Name").add(el);

  for (i = 0; i < values.length; i++) {
    if(values[i].Name != null){
      var str = String(values[i].Name).trim();
      var opt = String(values[i].Name).trim();
      var el = document.createElement("option")
      el.text = opt;
      el.value = opt;

     }

  var filter= document.getElementById("Nsearch").value;


    if (filter !== ""){

      if (opt.toLowerCase().startsWith(filter.toLowerCase())){
        if (teststring.toUpperCase().indexOf(opt.toUpperCase()) == -1){
          document.getElementById("Name").add(el);
        }
      }
    }else{
      if (teststring.toUpperCase().indexOf(opt.toUpperCase()) == -1){
        document.getElementById("Name").add(el);
      }
    }

  }

  var sel= document.getElementById("Name")

  var cnt = 0;
  for (var i = 0; i < sel.options.length; i++) {
    if (sel.options[i].selected) {
        cnt++;
    }
  }


    if(document.getElementById("Name").length - cnt ==0){
      var x= prompt("Name not found, please enter name");
  //var y= prompt("Please enter block ha");
  
      var opt = x;
  //var ha = y;
      var el = document.createElement("option")
      el.text = opt;
      el.value = opt;

      document.getElementById("Name").add(el);

//create new task object and save to storage
      let newObj={Name:x}
      values.push(newObj)


      localStorage.setItem('namestore',JSON.stringify(values))

    }
  }

}

function addtasks(){

//document.getElementById("Block").length = 0;
var teststring="";

var select= document.getElementById("Task")
var l= select.length
  for (j=l; j>=0; j--){
    if (j<l){
      if(select.options[j].selected == false){
        select.remove(j);
      }else{
        teststring += select.options[j].text;
      }
    }
  }

  if(localStorage.getItem("taskstore") !=null){

    var values = Array.from(JSON.parse(localStorage.getItem("taskstore")));


//var el = document.createElement("option")

//el.text = "";

//el.value = "";

//document.getElementById("Task").add(el);

    for (i = 0; i < values.length; i++) {
      if(values[i].Task != null){
        var str = String(values[i].Task).trim();
        var opt = String(values[i].Task).trim();
        var el = document.createElement("option")
        el.text = opt;
        el.value = opt;

       }


    var filter= document.getElementById("Tsearch").value;


      if (filter !== ""){

        if (opt.toLowerCase().startsWith(filter.toLowerCase())){
          if (teststring.toUpperCase().indexOf(opt.toUpperCase()) == -1){
        document.getElementById("Task").add(el);
          }
        }
      }else{
        if (teststring.toUpperCase().indexOf(opt.toUpperCase()) == -1){
      document.getElementById("Task").add(el);
        }
      }

    }

    var sel= document.getElementById("Task")

    var cnt = 0;
    for (var i = 0; i < sel.options.length; i++) {
        if (sel.options[i].selected) {
          cnt++;
        }
    }


      if(document.getElementById("Task").length-cnt ==0){
      var x= prompt("Task not found, please enter");
  
      var opt = x;
      var el = document.createElement("option")
      el.text = opt;
      el.value = opt;

      document.getElementById("Task").add(el);

//create new task object and save to storage
      let newObj={Task:x}
      values.push(newObj)
      localStorage.setItem('taskstore',JSON.stringify(values))
 
      }
    }
}

//show remaining local storage
function checkStorage(){

  var _lsTotal = 0,
    _xLen, _x;
for (_x in localStorage) {
    if (!localStorage.hasOwnProperty(_x)) {
        continue;
    }
    _xLen = ((localStorage[_x].length + _x.length) * 2);
    _lsTotal += _xLen;
    console.log(_x.substr(0, 50) + " = " + (_xLen / 1024).toFixed(2) + " KB")
};
//alert("Total = " + (_lsTotal / 1024).toFixed(2) + " KB");

/*let z= document.getElementById("disk_c");
z.setAttribute("min", "0");
z.setAttribute("max","(1024*1024*5)");
z.setAttribute("value", _lsTotal);*/

//x.value= _lsTotal;


return (Number(_lsTotal)/Number(5242880))

//alert(1024*1024*5)

alert("Total = " + (_lsTotal / 1024).toFixed(2) + " KB")
alert(document.getElementById("disk_c").value)
}



function remStorage(){

alert(unescape(encodeURIComponent(JSON.stringify(localStorage))).length)

alert((1024 * 1024 * 5 - unescape(encodeURIComponent(JSON.stringify(localStorage))).length)/(1024*1024*5))

}

function localStorageSpace(){
        var allStrings = '';
        for(var key in window.localStorage){
            if(window.localStorage.hasOwnProperty(key)){
                allStrings += window.localStorage[key];
            }
        }
        return allStrings ? 3 + ((allStrings.length*16)/(8*1024)) + ' KB' : 'Empty (0 KB)';
    
    //alert((allStrings.length*16)/(8*1024) + ' KB : Empty (0 KB)');
    //alert(allStrings.length);

  };



</script>


</html>
